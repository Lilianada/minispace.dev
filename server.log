
> minispace.dev@0.1.0 dev
> next dev --turbopack

   ▲ Next.js 15.3.2 (Turbopack)
   - Local:        http://localhost:3000
   - Network:      http://192.168.1.3:3000
   - Environments: .env.local, .env

 ✓ Starting...
 ✓ Compiled middleware in 212ms
 ✓ Ready in 1529ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/posts
    - Hostname: demouser.localhost:3000
    - Pathname: /posts
    - Headers: {
  "connection": "keep-alive",
  "host": "demouser.localhost:3000",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "demouser",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/posts",
    "normalizedPath": "/posts",
    "pathSegments": [
      "posts"
    ],
    "pageType": "posts"
  },
  "hostInfo": {
    "hostname": "demouser.localhost:3000",
    "domainParts": [
      "demouser",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: demouser.localhost:3000/posts
[Middleware] Is subdomain check: demouser.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Subdomain request detected:
      - Username: demouser
      - Original pathname: /posts
      - Is root path: false
[SUBDOMAIN-DEBUG] Rewriting URL:
      - From: http://localhost:3000/posts
      - To pathname: /demouser/posts
      - Full new URL: http://localhost:3000/demouser/posts
 ○ Compiling /[username]/posts ...
 ✓ Compiled /[username]/posts in 3.4s
[Firebase Admin] Starting initialization...
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
[Firebase Admin] Starting initialization...
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: demouser
    - Host: demouser.localhost:3000
    - Is subdomain detected: true
    - Original pathname: /posts
[SUBDOMAIN-DEBUG] Path processing:
        - Clean path: posts
        - Path without username: posts
        - Username check: demouser
        - Starts with username?: false
[SUBDOMAIN-DEBUG] Page detection:
          - Path segments: [posts]
          - Selected page: posts
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: demouser
    - Current page: posts
    - Is subdomain: true
[Posts Page] Request details:
    - Username: demouser
    - Host: demouser.localhost:3000
    - Is subdomain (detected): true
    - Path: /posts
    - NODE_ENV: development
  
[Firebase Admin] isAdminAvailable() called:
    - adminInitialized: development
    - adminAuth available: false
    - adminDb available: false
    - real admin available: false
    - NODE_ENV: development
    - Project ID: mini-app-00
  
Error: Route "/[username]/posts" used `headers().get('host')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at isAdminAvailable (src/lib/firebase/admin.ts:139:25)
    at UserPostsPage (src/app/[username]/posts/page.tsx:32:40)
  137 |       const { headers } = require('next/headers');
  138 |       const headersList = headers();
> 139 |       host = headersList.get('host') || '';
      |                         ^
  140 |     } else {
  141 |       host = window.location.host;
  142 |     }
[Firebase Admin] Detected subdomain request on host: demouser.localhost:3000
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[Firebase Admin] Admin not available but in development mode - allowing demo content
[Posts Page] Admin availability check result: true
[Posts Page] Firebase Admin DB not available but in development mode.
        - Username: demouser
        - Host: demouser.localhost:3000
        - Is subdomain: true
        - NODE_ENV: development
      
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: posts
[THEME-DEBUG] Navigation context:
        - Username: demouser
        - Current page: posts
        - Is subdomain: true
      
[THEME-DEBUG] Site context:
        - Title: demouser's Blog
        - Username: demouser
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/dev-mode
  7. /post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-render)
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: posts
        - Username: demouser
        - Is subdomain: true
        - Current page: posts
        - Template context keys: site, posts, navigationContext, content, navigation, userCSS, currentYear
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: demouser
    - Is subdomain: true
    - HTML length: 3432
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>demouser&#39;s Blo...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /
    /posts
    /about
    /post/dev-mode
    /post/firebase-admin-nextjs
[SUBDOMAIN-DEBUG] Subdomain mode - transforming username-prefixed links to relative links
    - Username pattern: /href="\/demouser(\/[^"]*|\/?)?"/g
[SUBDOMAIN-DEBUG] Links after subdomain transformation:
      []
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/dev-mode
  7. /post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3574 bytes
 GET /posts 200 in 5061ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/demouser/posts
    - Hostname: localhost:3000
    - Pathname: /demouser/posts
    - Headers: {
  "connection": "keep-alive",
  "host": "localhost:3000",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "demouser",
  "isSubdomain": false,
  "pathInfo": {
    "originalPath": "/demouser/posts",
    "normalizedPath": "/demouser/posts",
    "pathSegments": [
      "demouser",
      "posts"
    ],
    "pageType": "posts"
  },
  "hostInfo": {
    "hostname": "localhost:3000",
    "domainParts": [
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: localhost:3000/demouser/posts
Main localhost domain detected, no rewrite needed
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: demouser
    - Host: localhost:3000
    - Is subdomain detected: false
    - Original pathname: /posts
[SUBDOMAIN-DEBUG] Path processing:
        - Clean path: posts
        - Path without username: posts
        - Username check: demouser
        - Starts with username?: false
[SUBDOMAIN-DEBUG] Page detection:
          - Path segments: [posts]
          - Selected page: posts
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: demouser
    - Current page: posts
    - Is subdomain: false
[Posts Page] Request details:
    - Username: demouser
    - Host: localhost:3000
    - Is subdomain (detected): false
    - Path: /posts
    - NODE_ENV: development
  
[Firebase Admin] isAdminAvailable() called:
    - adminInitialized: development
    - adminAuth available: false
    - adminDb available: false
    - real admin available: false
    - NODE_ENV: development
    - Project ID: mini-app-00
  
Error: Route "/[username]/posts" used `headers().get('host')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at isAdminAvailable (src/lib/firebase/admin.ts:139:25)
    at UserPostsPage (src/app/[username]/posts/page.tsx:32:40)
  137 |       const { headers } = require('next/headers');
  138 |       const headersList = headers();
> 139 |       host = headersList.get('host') || '';
      |                         ^
  140 |     } else {
  141 |       host = window.location.host;
  142 |     }
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[Firebase Admin] Admin not available but in development mode - allowing demo content
[Posts Page] Admin availability check result: true
[Posts Page] Firebase Admin DB not available but in development mode.
        - Username: demouser
        - Host: localhost:3000
        - Is subdomain: false
        - NODE_ENV: development
      
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: posts
[THEME-DEBUG] Navigation context:
        - Username: demouser
        - Current page: posts
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: demouser's Blog
        - Username: demouser
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /demouser/
  4. /demouser/posts
  5. /demouser/about
  6. /demouser/post/dev-mode
  7. /demouser/post/firebase-admin-nextjs
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: posts
        - Username: demouser
        - Is subdomain: false
        - Current page: posts
        - Template context keys: site, posts, navigationContext, content, navigation, userCSS, currentYear
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: demouser
    - Is subdomain: false
    - HTML length: 3477
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>demouser&#39;s Blo...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /demouser/
    /demouser/posts
    /demouser/about
    /demouser/post/dev-mode
    /demouser/post/firebase-admin-nextjs
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/demouser/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/demouser/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/demouser/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/demouser/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/demouser/post/dev-mode"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/demouser/post/firebase-admin-nextjs"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/demouser/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /demouser/themes/altay/theme.css
  3. /demouser/
  4. /demouser/posts
  5. /demouser/about
  6. /demouser/post/dev-mode
  7. /demouser/post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3629 bytes
 GET /demouser/posts 200 in 52ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/posts
    - Hostname: test.localhost:3000
    - Pathname: /posts
    - Headers: {
  "connection": "keep-alive",
  "host": "test.localhost:3000",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-forwarded-host": "test.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "test",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/posts",
    "normalizedPath": "/posts",
    "pathSegments": [
      "posts"
    ],
    "pageType": "posts"
  },
  "hostInfo": {
    "hostname": "test.localhost:3000",
    "domainParts": [
      "test",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: test.localhost:3000/posts
[Middleware] Is subdomain check: test.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Subdomain request detected:
      - Username: test
      - Original pathname: /posts
      - Is root path: false
[SUBDOMAIN-DEBUG] Rewriting URL:
      - From: http://localhost:3000/posts
      - To pathname: /test/posts
      - Full new URL: http://localhost:3000/test/posts
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: test
    - Host: test.localhost:3000
    - Is subdomain detected: true
    - Original pathname: /posts
[SUBDOMAIN-DEBUG] Path processing:
        - Clean path: posts
        - Path without username: posts
        - Username check: test
        - Starts with username?: false
[SUBDOMAIN-DEBUG] Page detection:
          - Path segments: [posts]
          - Selected page: posts
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: test
    - Current page: posts
    - Is subdomain: true
[Posts Page] Request details:
    - Username: test
    - Host: test.localhost:3000
    - Is subdomain (detected): true
    - Path: /posts
    - NODE_ENV: development
  
[Firebase Admin] isAdminAvailable() called:
    - adminInitialized: development
    - adminAuth available: false
    - adminDb available: false
    - real admin available: false
    - NODE_ENV: development
    - Project ID: mini-app-00
  
Error: Route "/[username]/posts" used `headers().get('host')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at isAdminAvailable (src/lib/firebase/admin.ts:139:25)
    at UserPostsPage (src/app/[username]/posts/page.tsx:32:40)
  137 |       const { headers } = require('next/headers');
  138 |       const headersList = headers();
> 139 |       host = headersList.get('host') || '';
      |                         ^
  140 |     } else {
  141 |       host = window.location.host;
  142 |     }
[Firebase Admin] Detected subdomain request on host: test.localhost:3000
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[Firebase Admin] Admin not available but in development mode - allowing demo content
[Posts Page] Admin availability check result: true
[Posts Page] Firebase Admin DB not available but in development mode.
        - Username: test
        - Host: test.localhost:3000
        - Is subdomain: true
        - NODE_ENV: development
      
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: posts
[THEME-DEBUG] Navigation context:
        - Username: test
        - Current page: posts
        - Is subdomain: true
      
[THEME-DEBUG] Site context:
        - Title: test's Blog
        - Username: test
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/dev-mode
  7. /post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-render)
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: posts
        - Username: test
        - Is subdomain: true
        - Current page: posts
        - Template context keys: site, posts, navigationContext, content, navigation, userCSS, currentYear
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: test
    - Is subdomain: true
    - HTML length: 3416
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>test&#39;s Blog</t...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /
    /posts
    /about
    /post/dev-mode
    /post/firebase-admin-nextjs
[SUBDOMAIN-DEBUG] Subdomain mode - transforming username-prefixed links to relative links
    - Username pattern: /href="\/test(\/[^"]*|\/?)?"/g
[SUBDOMAIN-DEBUG] Links after subdomain transformation:
      []
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/dev-mode
  7. /post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3554 bytes
 GET /posts 200 in 40ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/test/posts
    - Hostname: localhost:3000
    - Pathname: /test/posts
    - Headers: {
  "connection": "keep-alive",
  "host": "localhost:3000",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "test",
  "isSubdomain": false,
  "pathInfo": {
    "originalPath": "/test/posts",
    "normalizedPath": "/test/posts",
    "pathSegments": [
      "test",
      "posts"
    ],
    "pageType": "posts"
  },
  "hostInfo": {
    "hostname": "localhost:3000",
    "domainParts": [
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: localhost:3000/test/posts
Main localhost domain detected, no rewrite needed
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: test
    - Host: localhost:3000
    - Is subdomain detected: false
    - Original pathname: /posts
[SUBDOMAIN-DEBUG] Path processing:
        - Clean path: posts
        - Path without username: posts
        - Username check: test
        - Starts with username?: false
[SUBDOMAIN-DEBUG] Page detection:
          - Path segments: [posts]
          - Selected page: posts
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: test
    - Current page: posts
    - Is subdomain: false
[Posts Page] Request details:
    - Username: test
    - Host: localhost:3000
    - Is subdomain (detected): false
    - Path: /posts
    - NODE_ENV: development
  
[Firebase Admin] isAdminAvailable() called:
    - adminInitialized: development
    - adminAuth available: false
    - adminDb available: false
    - real admin available: false
    - NODE_ENV: development
    - Project ID: mini-app-00
  
Error: Route "/[username]/posts" used `headers().get('host')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at isAdminAvailable (src/lib/firebase/admin.ts:139:25)
    at UserPostsPage (src/app/[username]/posts/page.tsx:32:40)
  137 |       const { headers } = require('next/headers');
  138 |       const headersList = headers();
> 139 |       host = headersList.get('host') || '';
      |                         ^
  140 |     } else {
  141 |       host = window.location.host;
  142 |     }
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[Firebase Admin] Admin not available but in development mode - allowing demo content
[Posts Page] Admin availability check result: true
[Posts Page] Firebase Admin DB not available but in development mode.
        - Username: test
        - Host: localhost:3000
        - Is subdomain: false
        - NODE_ENV: development
      
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: posts
[THEME-DEBUG] Navigation context:
        - Username: test
        - Current page: posts
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: test's Blog
        - Username: test
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /test/
  4. /test/posts
  5. /test/about
  6. /test/post/dev-mode
  7. /test/post/firebase-admin-nextjs
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: posts
        - Username: test
        - Is subdomain: false
        - Current page: posts
        - Template context keys: site, posts, navigationContext, content, navigation, userCSS, currentYear
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: test
    - Is subdomain: false
    - HTML length: 3441
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>test&#39;s Blog</t...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /test/
    /test/posts
    /test/about
    /test/post/dev-mode
    /test/post/firebase-admin-nextjs
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/test/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/test/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/test/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/test/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/test/post/dev-mode"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/test/post/firebase-admin-nextjs"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/test/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /test/themes/altay/theme.css
  3. /test/
  4. /test/posts
  5. /test/about
  6. /test/post/dev-mode
  7. /test/post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3585 bytes
 GET /test/posts 200 in 52ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/posts
    - Hostname: admin.localhost:3000
    - Pathname: /posts
    - Headers: {
  "connection": "keep-alive",
  "host": "admin.localhost:3000",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-forwarded-host": "admin.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "admin",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/posts",
    "normalizedPath": "/posts",
    "pathSegments": [
      "posts"
    ],
    "pageType": "posts"
  },
  "hostInfo": {
    "hostname": "admin.localhost:3000",
    "domainParts": [
      "admin",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: admin.localhost:3000/posts
[Middleware] Is subdomain check: admin.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Skipping special subdomain: admin
 ○ Compiling /[username] ...
[Firebase Admin] Starting initialization...
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
 ✓ Compiled /[username] in 1715ms
[Firebase Admin] Starting initialization...
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: posts
    - Host header: admin.localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: not set
    - X-Minispace-Original-Host: not set
    - X-Minispace-Username: not set
    - All headers: {
  "host": "admin.localhost:3000",
  "connection": "keep-alive",
  "x-forwarded-host": "admin.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::ffff:127.0.0.1"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: posts
    - Host: admin.localhost:3000
    - Is subdomain detected: false
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: posts
    - Current page: home
    - Is subdomain: false
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: posts
    - Is subdomain: false
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for posts
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: posts
        - Current page: home
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: Posts
        - Username: posts
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /posts/
  4. /posts/posts
  5. /posts/about
  6. /posts/post/welcome
  7. /posts/post/getting-started
  8. /posts/posts
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: posts
        - Is subdomain: false
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: posts
    - Is subdomain: false
    - HTML length: 3900
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Posts</title>
    ...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /posts/
    /posts/posts
    /posts/about
    /posts/post/welcome
    /posts/post/getting-started
    /posts/posts
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/posts/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/posts/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/posts/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/posts/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/posts/post/welcome"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/posts/post/getting-started"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/posts/posts"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/posts/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /posts/themes/altay/theme.css
  3. /posts/
  4. /posts/posts
  5. /posts/about
  6. /posts/post/welcome
  7. /posts/post/getting-started
  8. /posts/posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4045 bytes
 GET /posts 200 in 2261ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/admin/posts
    - Hostname: localhost:3000
    - Pathname: /admin/posts
    - Headers: {
  "connection": "keep-alive",
  "host": "localhost:3000",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "admin",
  "isSubdomain": false,
  "pathInfo": {
    "originalPath": "/admin/posts",
    "normalizedPath": "/admin/posts",
    "pathSegments": [
      "admin",
      "posts"
    ],
    "pageType": "posts"
  },
  "hostInfo": {
    "hostname": "localhost:3000",
    "domainParts": [
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: localhost:3000/admin/posts
Main localhost domain detected, no rewrite needed
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: admin
    - Host: localhost:3000
    - Is subdomain detected: false
    - Original pathname: /posts
[SUBDOMAIN-DEBUG] Path processing:
        - Clean path: posts
        - Path without username: posts
        - Username check: admin
        - Starts with username?: false
[SUBDOMAIN-DEBUG] Page detection:
          - Path segments: [posts]
          - Selected page: posts
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: admin
    - Current page: posts
    - Is subdomain: false
[Posts Page] Request details:
    - Username: admin
    - Host: localhost:3000
    - Is subdomain (detected): false
    - Path: /posts
    - NODE_ENV: development
  
[Firebase Admin] isAdminAvailable() called:
    - adminInitialized: development
    - adminAuth available: false
    - adminDb available: false
    - real admin available: false
    - NODE_ENV: development
    - Project ID: mini-app-00
  
Error: Route "/[username]/posts" used `headers().get('host')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at isAdminAvailable (src/lib/firebase/admin.ts:139:25)
    at UserPostsPage (src/app/[username]/posts/page.tsx:32:40)
  137 |       const { headers } = require('next/headers');
  138 |       const headersList = headers();
> 139 |       host = headersList.get('host') || '';
      |                         ^
  140 |     } else {
  141 |       host = window.location.host;
  142 |     }
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[Firebase Admin] Admin not available but in development mode - allowing demo content
[Posts Page] Admin availability check result: true
[Posts Page] Firebase Admin DB not available but in development mode.
        - Username: admin
        - Host: localhost:3000
        - Is subdomain: false
        - NODE_ENV: development
      
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: posts
[THEME-DEBUG] Navigation context:
        - Username: admin
        - Current page: posts
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: admin's Blog
        - Username: admin
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /admin/
  4. /admin/posts
  5. /admin/about
  6. /admin/post/dev-mode
  7. /admin/post/firebase-admin-nextjs
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: posts
        - Username: admin
        - Is subdomain: false
        - Current page: posts
        - Template context keys: site, posts, navigationContext, content, navigation, userCSS, currentYear
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: admin
    - Is subdomain: false
    - HTML length: 3450
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>admin&#39;s Blog</...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /admin/
    /admin/posts
    /admin/about
    /admin/post/dev-mode
    /admin/post/firebase-admin-nextjs
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/admin/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/admin/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/admin/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/admin/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/admin/post/dev-mode"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/admin/post/firebase-admin-nextjs"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/admin/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /admin/themes/altay/theme.css
  3. /admin/
  4. /admin/posts
  5. /admin/about
  6. /admin/post/dev-mode
  7. /admin/post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3596 bytes
 GET /admin/posts 200 in 41ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/posts
    - Hostname: dev.localhost:3000
    - Pathname: /posts
    - Headers: {
  "connection": "keep-alive",
  "host": "dev.localhost:3000",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-forwarded-host": "dev.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "dev",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/posts",
    "normalizedPath": "/posts",
    "pathSegments": [
      "posts"
    ],
    "pageType": "posts"
  },
  "hostInfo": {
    "hostname": "dev.localhost:3000",
    "domainParts": [
      "dev",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: dev.localhost:3000/posts
[Middleware] Is subdomain check: dev.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Subdomain request detected:
      - Username: dev
      - Original pathname: /posts
      - Is root path: false
[SUBDOMAIN-DEBUG] Rewriting URL:
      - From: http://localhost:3000/posts
      - To pathname: /dev/posts
      - Full new URL: http://localhost:3000/dev/posts
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: dev
    - Host: dev.localhost:3000
    - Is subdomain detected: true
    - Original pathname: /posts
[SUBDOMAIN-DEBUG] Path processing:
        - Clean path: posts
        - Path without username: posts
        - Username check: dev
        - Starts with username?: false
[SUBDOMAIN-DEBUG] Page detection:
          - Path segments: [posts]
          - Selected page: posts
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: dev
    - Current page: posts
    - Is subdomain: true
[Posts Page] Request details:
    - Username: dev
    - Host: dev.localhost:3000
    - Is subdomain (detected): true
    - Path: /posts
    - NODE_ENV: development
  
[Firebase Admin] isAdminAvailable() called:
    - adminInitialized: development
    - adminAuth available: false
    - adminDb available: false
    - real admin available: false
    - NODE_ENV: development
    - Project ID: mini-app-00
  
Error: Route "/[username]/posts" used `headers().get('host')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at isAdminAvailable (src/lib/firebase/admin.ts:139:25)
    at UserPostsPage (src/app/[username]/posts/page.tsx:32:40)
  137 |       const { headers } = require('next/headers');
  138 |       const headersList = headers();
> 139 |       host = headersList.get('host') || '';
      |                         ^
  140 |     } else {
  141 |       host = window.location.host;
  142 |     }
[Firebase Admin] Detected subdomain request on host: dev.localhost:3000
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[Firebase Admin] Admin not available but in development mode - allowing demo content
[Posts Page] Admin availability check result: true
[Posts Page] Firebase Admin DB not available but in development mode.
        - Username: dev
        - Host: dev.localhost:3000
        - Is subdomain: true
        - NODE_ENV: development
      
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: posts
[THEME-DEBUG] Navigation context:
        - Username: dev
        - Current page: posts
        - Is subdomain: true
      
[THEME-DEBUG] Site context:
        - Title: dev's Blog
        - Username: dev
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/dev-mode
  7. /post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-render)
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: posts
        - Username: dev
        - Is subdomain: true
        - Current page: posts
        - Template context keys: site, posts, navigationContext, content, navigation, userCSS, currentYear
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: dev
    - Is subdomain: true
    - HTML length: 3412
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>dev&#39;s Blog</ti...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /
    /posts
    /about
    /post/dev-mode
    /post/firebase-admin-nextjs
[SUBDOMAIN-DEBUG] Subdomain mode - transforming username-prefixed links to relative links
    - Username pattern: /href="\/dev(\/[^"]*|\/?)?"/g
[SUBDOMAIN-DEBUG] Links after subdomain transformation:
      []
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/dev-mode
  7. /post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3549 bytes
 GET /posts 200 in 66ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/dev/posts
    - Hostname: localhost:3000
    - Pathname: /dev/posts
    - Headers: {
  "connection": "keep-alive",
  "host": "localhost:3000",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "dev",
  "isSubdomain": false,
  "pathInfo": {
    "originalPath": "/dev/posts",
    "normalizedPath": "/dev/posts",
    "pathSegments": [
      "dev",
      "posts"
    ],
    "pageType": "posts"
  },
  "hostInfo": {
    "hostname": "localhost:3000",
    "domainParts": [
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: localhost:3000/dev/posts
Main localhost domain detected, no rewrite needed
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: dev
    - Host: localhost:3000
    - Is subdomain detected: false
    - Original pathname: /posts
[SUBDOMAIN-DEBUG] Path processing:
        - Clean path: posts
        - Path without username: posts
        - Username check: dev
        - Starts with username?: false
[SUBDOMAIN-DEBUG] Page detection:
          - Path segments: [posts]
          - Selected page: posts
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: dev
    - Current page: posts
    - Is subdomain: false
[Posts Page] Request details:
    - Username: dev
    - Host: localhost:3000
    - Is subdomain (detected): false
    - Path: /posts
    - NODE_ENV: development
  
[Firebase Admin] isAdminAvailable() called:
    - adminInitialized: development
    - adminAuth available: false
    - adminDb available: false
    - real admin available: false
    - NODE_ENV: development
    - Project ID: mini-app-00
  
Error: Route "/[username]/posts" used `headers().get('host')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at isAdminAvailable (src/lib/firebase/admin.ts:139:25)
    at UserPostsPage (src/app/[username]/posts/page.tsx:32:40)
  137 |       const { headers } = require('next/headers');
  138 |       const headersList = headers();
> 139 |       host = headersList.get('host') || '';
      |                         ^
  140 |     } else {
  141 |       host = window.location.host;
  142 |     }
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[Firebase Admin] Admin not available but in development mode - allowing demo content
[Posts Page] Admin availability check result: true
[Posts Page] Firebase Admin DB not available but in development mode.
        - Username: dev
        - Host: localhost:3000
        - Is subdomain: false
        - NODE_ENV: development
      
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: posts
[THEME-DEBUG] Navigation context:
        - Username: dev
        - Current page: posts
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: dev's Blog
        - Username: dev
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /dev/
  4. /dev/posts
  5. /dev/about
  6. /dev/post/dev-mode
  7. /dev/post/firebase-admin-nextjs
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: posts
        - Username: dev
        - Is subdomain: false
        - Current page: posts
        - Template context keys: site, posts, navigationContext, content, navigation, userCSS, currentYear
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: dev
    - Is subdomain: false
    - HTML length: 3432
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>dev&#39;s Blog</ti...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /dev/
    /dev/posts
    /dev/about
    /dev/post/dev-mode
    /dev/post/firebase-admin-nextjs
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/dev/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/dev/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/dev/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/dev/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/dev/post/dev-mode"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/dev/post/firebase-admin-nextjs"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/dev/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /dev/themes/altay/theme.css
  3. /dev/
  4. /dev/posts
  5. /dev/about
  6. /dev/post/dev-mode
  7. /dev/post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3574 bytes
 GET /dev/posts 200 in 51ms
[Firebase Admin] Starting initialization...
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/posts
    - Hostname: demouser.localhost:3000
    - Pathname: /posts
    - Headers: {
  "connection": "keep-alive",
  "host": "demouser.localhost:3000",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "demouser",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/posts",
    "normalizedPath": "/posts",
    "pathSegments": [
      "posts"
    ],
    "pageType": "posts"
  },
  "hostInfo": {
    "hostname": "demouser.localhost:3000",
    "domainParts": [
      "demouser",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: demouser.localhost:3000/posts
[Middleware] Is subdomain check: demouser.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Subdomain request detected:
      - Username: demouser
      - Original pathname: /posts
      - Is root path: false
[SUBDOMAIN-DEBUG] Rewriting URL:
      - From: http://localhost:3000/posts
      - To pathname: /demouser/posts
      - Full new URL: http://localhost:3000/demouser/posts
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: demouser
    - Host: demouser.localhost:3000
    - Is subdomain detected: true
    - Original pathname: /posts
[SUBDOMAIN-DEBUG] Path processing:
        - Clean path: posts
        - Path without username: posts
        - Username check: demouser
        - Starts with username?: false
[SUBDOMAIN-DEBUG] Page detection:
          - Path segments: [posts]
          - Selected page: posts
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: demouser
    - Current page: posts
    - Is subdomain: true
[Posts Page] Request details:
    - Username: demouser
    - Host: demouser.localhost:3000
    - Is subdomain (detected): true
    - Path: /posts
    - NODE_ENV: development
  
[Firebase Admin] isAdminAvailable() called:
    - adminInitialized: development
    - adminAuth available: false
    - adminDb available: false
    - real admin available: false
    - NODE_ENV: development
    - Project ID: mini-app-00
  
Error: Route "/[username]/posts" used `headers().get('host')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at isAdminAvailable (src/lib/firebase/admin.ts:139:25)
    at UserPostsPage (src/app/[username]/posts/page.tsx:32:40)
  137 |       const { headers } = require('next/headers');
  138 |       const headersList = headers();
> 139 |       host = headersList.get('host') || '';
      |                         ^
  140 |     } else {
  141 |       host = window.location.host;
  142 |     }
[Firebase Admin] Detected subdomain request on host: demouser.localhost:3000
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[Firebase Admin] Admin not available but in development mode - allowing demo content
[Posts Page] Admin availability check result: true
[Posts Page] Firebase Admin DB not available but in development mode.
        - Username: demouser
        - Host: demouser.localhost:3000
        - Is subdomain: true
        - NODE_ENV: development
      
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: posts
[THEME-DEBUG] Navigation context:
        - Username: demouser
        - Current page: posts
        - Is subdomain: true
      
[THEME-DEBUG] Site context:
        - Title: demouser's Blog
        - Username: demouser
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/dev-mode
  7. /post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-render)
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: posts
        - Username: demouser
        - Is subdomain: true
        - Current page: posts
        - Template context keys: site, posts, navigationContext, content, navigation, userCSS, currentYear
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: demouser
    - Is subdomain: true
    - HTML length: 3432
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>demouser&#39;s Blo...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /
    /posts
    /about
    /post/dev-mode
    /post/firebase-admin-nextjs
[SUBDOMAIN-DEBUG] Subdomain mode - transforming username-prefixed links to relative links
    - Username pattern: /href="\/demouser(\/[^"]*|\/?)?"/g
[SUBDOMAIN-DEBUG] Links after subdomain transformation:
      []
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/dev-mode
  7. /post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3574 bytes
 GET /posts 200 in 112ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/demouser/posts
    - Hostname: localhost:3000
    - Pathname: /demouser/posts
    - Headers: {
  "connection": "keep-alive",
  "host": "localhost:3000",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "demouser",
  "isSubdomain": false,
  "pathInfo": {
    "originalPath": "/demouser/posts",
    "normalizedPath": "/demouser/posts",
    "pathSegments": [
      "demouser",
      "posts"
    ],
    "pageType": "posts"
  },
  "hostInfo": {
    "hostname": "localhost:3000",
    "domainParts": [
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: localhost:3000/demouser/posts
Main localhost domain detected, no rewrite needed
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: demouser
    - Host: localhost:3000
    - Is subdomain detected: false
    - Original pathname: /posts
[SUBDOMAIN-DEBUG] Path processing:
        - Clean path: posts
        - Path without username: posts
        - Username check: demouser
        - Starts with username?: false
[SUBDOMAIN-DEBUG] Page detection:
          - Path segments: [posts]
          - Selected page: posts
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: demouser
    - Current page: posts
    - Is subdomain: false
[Posts Page] Request details:
    - Username: demouser
    - Host: localhost:3000
    - Is subdomain (detected): false
    - Path: /posts
    - NODE_ENV: development
  
[Firebase Admin] isAdminAvailable() called:
    - adminInitialized: development
    - adminAuth available: false
    - adminDb available: false
    - real admin available: false
    - NODE_ENV: development
    - Project ID: mini-app-00
  
Error: Route "/[username]/posts" used `headers().get('host')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at isAdminAvailable (src/lib/firebase/admin.ts:139:25)
    at UserPostsPage (src/app/[username]/posts/page.tsx:32:40)
  137 |       const { headers } = require('next/headers');
  138 |       const headersList = headers();
> 139 |       host = headersList.get('host') || '';
      |                         ^
  140 |     } else {
  141 |       host = window.location.host;
  142 |     }
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[Firebase Admin] Admin not available but in development mode - allowing demo content
[Posts Page] Admin availability check result: true
[Posts Page] Firebase Admin DB not available but in development mode.
        - Username: demouser
        - Host: localhost:3000
        - Is subdomain: false
        - NODE_ENV: development
      
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: posts
[THEME-DEBUG] Navigation context:
        - Username: demouser
        - Current page: posts
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: demouser's Blog
        - Username: demouser
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /demouser/
  4. /demouser/posts
  5. /demouser/about
  6. /demouser/post/dev-mode
  7. /demouser/post/firebase-admin-nextjs
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: posts
        - Username: demouser
        - Is subdomain: false
        - Current page: posts
        - Template context keys: site, posts, navigationContext, content, navigation, userCSS, currentYear
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: demouser
    - Is subdomain: false
    - HTML length: 3477
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>demouser&#39;s Blo...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /demouser/
    /demouser/posts
    /demouser/about
    /demouser/post/dev-mode
    /demouser/post/firebase-admin-nextjs
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/demouser/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/demouser/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/demouser/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/demouser/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/demouser/post/dev-mode"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/demouser/post/firebase-admin-nextjs"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/demouser/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /demouser/themes/altay/theme.css
  3. /demouser/
  4. /demouser/posts
  5. /demouser/about
  6. /demouser/post/dev-mode
  7. /demouser/post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3629 bytes
 GET /demouser/posts 200 in 62ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/posts
    - Hostname: test.localhost:3000
    - Pathname: /posts
    - Headers: {
  "connection": "keep-alive",
  "host": "test.localhost:3000",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-forwarded-host": "test.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "test",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/posts",
    "normalizedPath": "/posts",
    "pathSegments": [
      "posts"
    ],
    "pageType": "posts"
  },
  "hostInfo": {
    "hostname": "test.localhost:3000",
    "domainParts": [
      "test",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: test.localhost:3000/posts
[Middleware] Is subdomain check: test.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Subdomain request detected:
      - Username: test
      - Original pathname: /posts
      - Is root path: false
[SUBDOMAIN-DEBUG] Rewriting URL:
      - From: http://localhost:3000/posts
      - To pathname: /test/posts
      - Full new URL: http://localhost:3000/test/posts
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: test
    - Host: test.localhost:3000
    - Is subdomain detected: true
    - Original pathname: /posts
[SUBDOMAIN-DEBUG] Path processing:
        - Clean path: posts
        - Path without username: posts
        - Username check: test
        - Starts with username?: false
[SUBDOMAIN-DEBUG] Page detection:
          - Path segments: [posts]
          - Selected page: posts
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: test
    - Current page: posts
    - Is subdomain: true
[Posts Page] Request details:
    - Username: test
    - Host: test.localhost:3000
    - Is subdomain (detected): true
    - Path: /posts
    - NODE_ENV: development
  
[Firebase Admin] isAdminAvailable() called:
    - adminInitialized: development
    - adminAuth available: false
    - adminDb available: false
    - real admin available: false
    - NODE_ENV: development
    - Project ID: mini-app-00
  
Error: Route "/[username]/posts" used `headers().get('host')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at isAdminAvailable (src/lib/firebase/admin.ts:139:25)
    at UserPostsPage (src/app/[username]/posts/page.tsx:32:40)
  137 |       const { headers } = require('next/headers');
  138 |       const headersList = headers();
> 139 |       host = headersList.get('host') || '';
      |                         ^
  140 |     } else {
  141 |       host = window.location.host;
  142 |     }
[Firebase Admin] Detected subdomain request on host: test.localhost:3000
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[Firebase Admin] Admin not available but in development mode - allowing demo content
[Posts Page] Admin availability check result: true
[Posts Page] Firebase Admin DB not available but in development mode.
        - Username: test
        - Host: test.localhost:3000
        - Is subdomain: true
        - NODE_ENV: development
      
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: posts
[THEME-DEBUG] Navigation context:
        - Username: test
        - Current page: posts
        - Is subdomain: true
      
[THEME-DEBUG] Site context:
        - Title: test's Blog
        - Username: test
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/dev-mode
  7. /post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-render)
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: posts
        - Username: test
        - Is subdomain: true
        - Current page: posts
        - Template context keys: site, posts, navigationContext, content, navigation, userCSS, currentYear
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: test
    - Is subdomain: true
    - HTML length: 3416
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>test&#39;s Blog</t...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /
    /posts
    /about
    /post/dev-mode
    /post/firebase-admin-nextjs
[SUBDOMAIN-DEBUG] Subdomain mode - transforming username-prefixed links to relative links
    - Username pattern: /href="\/test(\/[^"]*|\/?)?"/g
[SUBDOMAIN-DEBUG] Links after subdomain transformation:
      []
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/dev-mode
  7. /post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3554 bytes
 GET /posts 200 in 41ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/test/posts
    - Hostname: localhost:3000
    - Pathname: /test/posts
    - Headers: {
  "connection": "keep-alive",
  "host": "localhost:3000",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "test",
  "isSubdomain": false,
  "pathInfo": {
    "originalPath": "/test/posts",
    "normalizedPath": "/test/posts",
    "pathSegments": [
      "test",
      "posts"
    ],
    "pageType": "posts"
  },
  "hostInfo": {
    "hostname": "localhost:3000",
    "domainParts": [
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: localhost:3000/test/posts
Main localhost domain detected, no rewrite needed
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: test
    - Host: localhost:3000
    - Is subdomain detected: false
    - Original pathname: /posts
[SUBDOMAIN-DEBUG] Path processing:
        - Clean path: posts
        - Path without username: posts
        - Username check: test
        - Starts with username?: false
[SUBDOMAIN-DEBUG] Page detection:
          - Path segments: [posts]
          - Selected page: posts
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: test
    - Current page: posts
    - Is subdomain: false
[Posts Page] Request details:
    - Username: test
    - Host: localhost:3000
    - Is subdomain (detected): false
    - Path: /posts
    - NODE_ENV: development
  
[Firebase Admin] isAdminAvailable() called:
    - adminInitialized: development
    - adminAuth available: false
    - adminDb available: false
    - real admin available: false
    - NODE_ENV: development
    - Project ID: mini-app-00
  
Error: Route "/[username]/posts" used `headers().get('host')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at isAdminAvailable (src/lib/firebase/admin.ts:139:25)
    at UserPostsPage (src/app/[username]/posts/page.tsx:32:40)
  137 |       const { headers } = require('next/headers');
  138 |       const headersList = headers();
> 139 |       host = headersList.get('host') || '';
      |                         ^
  140 |     } else {
  141 |       host = window.location.host;
  142 |     }
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[Firebase Admin] Admin not available but in development mode - allowing demo content
[Posts Page] Admin availability check result: true
[Posts Page] Firebase Admin DB not available but in development mode.
        - Username: test
        - Host: localhost:3000
        - Is subdomain: false
        - NODE_ENV: development
      
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: posts
[THEME-DEBUG] Navigation context:
        - Username: test
        - Current page: posts
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: test's Blog
        - Username: test
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /test/
  4. /test/posts
  5. /test/about
  6. /test/post/dev-mode
  7. /test/post/firebase-admin-nextjs
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: posts
        - Username: test
        - Is subdomain: false
        - Current page: posts
        - Template context keys: site, posts, navigationContext, content, navigation, userCSS, currentYear
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: test
    - Is subdomain: false
    - HTML length: 3441
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>test&#39;s Blog</t...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /test/
    /test/posts
    /test/about
    /test/post/dev-mode
    /test/post/firebase-admin-nextjs
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/test/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/test/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/test/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/test/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/test/post/dev-mode"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/test/post/firebase-admin-nextjs"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/test/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /test/themes/altay/theme.css
  3. /test/
  4. /test/posts
  5. /test/about
  6. /test/post/dev-mode
  7. /test/post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3585 bytes
 GET /test/posts 200 in 53ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/posts
    - Hostname: admin.localhost:3000
    - Pathname: /posts
    - Headers: {
  "connection": "keep-alive",
  "host": "admin.localhost:3000",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-forwarded-host": "admin.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "admin",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/posts",
    "normalizedPath": "/posts",
    "pathSegments": [
      "posts"
    ],
    "pageType": "posts"
  },
  "hostInfo": {
    "hostname": "admin.localhost:3000",
    "domainParts": [
      "admin",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: admin.localhost:3000/posts
[Middleware] Is subdomain check: admin.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Skipping special subdomain: admin
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: posts
    - Host header: admin.localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: not set
    - X-Minispace-Original-Host: not set
    - X-Minispace-Username: not set
    - All headers: {
  "host": "admin.localhost:3000",
  "connection": "keep-alive",
  "x-forwarded-host": "admin.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::ffff:127.0.0.1"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: posts
    - Host: admin.localhost:3000
    - Is subdomain detected: false
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: posts
    - Current page: home
    - Is subdomain: false
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: posts
    - Is subdomain: false
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for posts
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: posts
        - Current page: home
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: Posts
        - Username: posts
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /posts/
  4. /posts/posts
  5. /posts/about
  6. /posts/post/welcome
  7. /posts/post/getting-started
  8. /posts/posts
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: posts
        - Is subdomain: false
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: posts
    - Is subdomain: false
    - HTML length: 3900
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Posts</title>
    ...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /posts/
    /posts/posts
    /posts/about
    /posts/post/welcome
    /posts/post/getting-started
    /posts/posts
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/posts/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/posts/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/posts/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/posts/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/posts/post/welcome"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/posts/post/getting-started"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/posts/posts"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/posts/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /posts/themes/altay/theme.css
  3. /posts/
  4. /posts/posts
  5. /posts/about
  6. /posts/post/welcome
  7. /posts/post/getting-started
  8. /posts/posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4045 bytes
 GET /posts 200 in 44ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/admin/posts
    - Hostname: localhost:3000
    - Pathname: /admin/posts
    - Headers: {
  "connection": "keep-alive",
  "host": "localhost:3000",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "admin",
  "isSubdomain": false,
  "pathInfo": {
    "originalPath": "/admin/posts",
    "normalizedPath": "/admin/posts",
    "pathSegments": [
      "admin",
      "posts"
    ],
    "pageType": "posts"
  },
  "hostInfo": {
    "hostname": "localhost:3000",
    "domainParts": [
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: localhost:3000/admin/posts
Main localhost domain detected, no rewrite needed
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: admin
    - Host: localhost:3000
    - Is subdomain detected: false
    - Original pathname: /posts
[SUBDOMAIN-DEBUG] Path processing:
        - Clean path: posts
        - Path without username: posts
        - Username check: admin
        - Starts with username?: false
[SUBDOMAIN-DEBUG] Page detection:
          - Path segments: [posts]
          - Selected page: posts
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: admin
    - Current page: posts
    - Is subdomain: false
[Posts Page] Request details:
    - Username: admin
    - Host: localhost:3000
    - Is subdomain (detected): false
    - Path: /posts
    - NODE_ENV: development
  
[Firebase Admin] isAdminAvailable() called:
    - adminInitialized: development
    - adminAuth available: false
    - adminDb available: false
    - real admin available: false
    - NODE_ENV: development
    - Project ID: mini-app-00
  
Error: Route "/[username]/posts" used `headers().get('host')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at isAdminAvailable (src/lib/firebase/admin.ts:139:25)
    at UserPostsPage (src/app/[username]/posts/page.tsx:32:40)
  137 |       const { headers } = require('next/headers');
  138 |       const headersList = headers();
> 139 |       host = headersList.get('host') || '';
      |                         ^
  140 |     } else {
  141 |       host = window.location.host;
  142 |     }
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[Firebase Admin] Admin not available but in development mode - allowing demo content
[Posts Page] Admin availability check result: true
[Posts Page] Firebase Admin DB not available but in development mode.
        - Username: admin
        - Host: localhost:3000
        - Is subdomain: false
        - NODE_ENV: development
      
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: posts
[THEME-DEBUG] Navigation context:
        - Username: admin
        - Current page: posts
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: admin's Blog
        - Username: admin
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /admin/
  4. /admin/posts
  5. /admin/about
  6. /admin/post/dev-mode
  7. /admin/post/firebase-admin-nextjs
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: posts
        - Username: admin
        - Is subdomain: false
        - Current page: posts
        - Template context keys: site, posts, navigationContext, content, navigation, userCSS, currentYear
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: admin
    - Is subdomain: false
    - HTML length: 3450
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>admin&#39;s Blog</...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /admin/
    /admin/posts
    /admin/about
    /admin/post/dev-mode
    /admin/post/firebase-admin-nextjs
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/admin/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/admin/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/admin/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/admin/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/admin/post/dev-mode"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/admin/post/firebase-admin-nextjs"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/admin/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /admin/themes/altay/theme.css
  3. /admin/
  4. /admin/posts
  5. /admin/about
  6. /admin/post/dev-mode
  7. /admin/post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3596 bytes
 GET /admin/posts 200 in 80ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/posts
    - Hostname: dev.localhost:3000
    - Pathname: /posts
    - Headers: {
  "connection": "keep-alive",
  "host": "dev.localhost:3000",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-forwarded-host": "dev.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "dev",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/posts",
    "normalizedPath": "/posts",
    "pathSegments": [
      "posts"
    ],
    "pageType": "posts"
  },
  "hostInfo": {
    "hostname": "dev.localhost:3000",
    "domainParts": [
      "dev",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: dev.localhost:3000/posts
[Middleware] Is subdomain check: dev.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Subdomain request detected:
      - Username: dev
      - Original pathname: /posts
      - Is root path: false
[SUBDOMAIN-DEBUG] Rewriting URL:
      - From: http://localhost:3000/posts
      - To pathname: /dev/posts
      - Full new URL: http://localhost:3000/dev/posts
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: dev
    - Host: dev.localhost:3000
    - Is subdomain detected: true
    - Original pathname: /posts
[SUBDOMAIN-DEBUG] Path processing:
        - Clean path: posts
        - Path without username: posts
        - Username check: dev
        - Starts with username?: false
[SUBDOMAIN-DEBUG] Page detection:
          - Path segments: [posts]
          - Selected page: posts
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: dev
    - Current page: posts
    - Is subdomain: true
[Posts Page] Request details:
    - Username: dev
    - Host: dev.localhost:3000
    - Is subdomain (detected): true
    - Path: /posts
    - NODE_ENV: development
  
[Firebase Admin] isAdminAvailable() called:
    - adminInitialized: development
    - adminAuth available: false
    - adminDb available: false
    - real admin available: false
    - NODE_ENV: development
    - Project ID: mini-app-00
  
Error: Route "/[username]/posts" used `headers().get('host')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at isAdminAvailable (src/lib/firebase/admin.ts:139:25)
    at UserPostsPage (src/app/[username]/posts/page.tsx:32:40)
  137 |       const { headers } = require('next/headers');
  138 |       const headersList = headers();
> 139 |       host = headersList.get('host') || '';
      |                         ^
  140 |     } else {
  141 |       host = window.location.host;
  142 |     }
[Firebase Admin] Detected subdomain request on host: dev.localhost:3000
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[Firebase Admin] Admin not available but in development mode - allowing demo content
[Posts Page] Admin availability check result: true
[Posts Page] Firebase Admin DB not available but in development mode.
        - Username: dev
        - Host: dev.localhost:3000
        - Is subdomain: true
        - NODE_ENV: development
      
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: posts
[THEME-DEBUG] Navigation context:
        - Username: dev
        - Current page: posts
        - Is subdomain: true
      
[THEME-DEBUG] Site context:
        - Title: dev's Blog
        - Username: dev
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/dev-mode
  7. /post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-render)
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: posts
        - Username: dev
        - Is subdomain: true
        - Current page: posts
        - Template context keys: site, posts, navigationContext, content, navigation, userCSS, currentYear
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: dev
    - Is subdomain: true
    - HTML length: 3412
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>dev&#39;s Blog</ti...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /
    /posts
    /about
    /post/dev-mode
    /post/firebase-admin-nextjs
[SUBDOMAIN-DEBUG] Subdomain mode - transforming username-prefixed links to relative links
    - Username pattern: /href="\/dev(\/[^"]*|\/?)?"/g
[SUBDOMAIN-DEBUG] Links after subdomain transformation:
      []
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/dev-mode
  7. /post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3549 bytes
 GET /posts 200 in 44ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/dev/posts
    - Hostname: localhost:3000
    - Pathname: /dev/posts
    - Headers: {
  "connection": "keep-alive",
  "host": "localhost:3000",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "dev",
  "isSubdomain": false,
  "pathInfo": {
    "originalPath": "/dev/posts",
    "normalizedPath": "/dev/posts",
    "pathSegments": [
      "dev",
      "posts"
    ],
    "pageType": "posts"
  },
  "hostInfo": {
    "hostname": "localhost:3000",
    "domainParts": [
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: localhost:3000/dev/posts
Main localhost domain detected, no rewrite needed
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: dev
    - Host: localhost:3000
    - Is subdomain detected: false
    - Original pathname: /posts
[SUBDOMAIN-DEBUG] Path processing:
        - Clean path: posts
        - Path without username: posts
        - Username check: dev
        - Starts with username?: false
[SUBDOMAIN-DEBUG] Page detection:
          - Path segments: [posts]
          - Selected page: posts
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: dev
    - Current page: posts
    - Is subdomain: false
[Posts Page] Request details:
    - Username: dev
    - Host: localhost:3000
    - Is subdomain (detected): false
    - Path: /posts
    - NODE_ENV: development
  
[Firebase Admin] isAdminAvailable() called:
    - adminInitialized: development
    - adminAuth available: false
    - adminDb available: false
    - real admin available: false
    - NODE_ENV: development
    - Project ID: mini-app-00
  
Error: Route "/[username]/posts" used `headers().get('host')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at isAdminAvailable (src/lib/firebase/admin.ts:139:25)
    at UserPostsPage (src/app/[username]/posts/page.tsx:32:40)
  137 |       const { headers } = require('next/headers');
  138 |       const headersList = headers();
> 139 |       host = headersList.get('host') || '';
      |                         ^
  140 |     } else {
  141 |       host = window.location.host;
  142 |     }
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[Firebase Admin] Admin not available but in development mode - allowing demo content
[Posts Page] Admin availability check result: true
[Posts Page] Firebase Admin DB not available but in development mode.
        - Username: dev
        - Host: localhost:3000
        - Is subdomain: false
        - NODE_ENV: development
      
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: posts
[THEME-DEBUG] Navigation context:
        - Username: dev
        - Current page: posts
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: dev's Blog
        - Username: dev
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /dev/
  4. /dev/posts
  5. /dev/about
  6. /dev/post/dev-mode
  7. /dev/post/firebase-admin-nextjs
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: posts
        - Username: dev
        - Is subdomain: false
        - Current page: posts
        - Template context keys: site, posts, navigationContext, content, navigation, userCSS, currentYear
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: dev
    - Is subdomain: false
    - HTML length: 3432
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>dev&#39;s Blog</ti...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /dev/
    /dev/posts
    /dev/about
    /dev/post/dev-mode
    /dev/post/firebase-admin-nextjs
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/dev/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/dev/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/dev/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/dev/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/dev/post/dev-mode"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/dev/post/firebase-admin-nextjs"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/dev/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /dev/themes/altay/theme.css
  3. /dev/
  4. /dev/posts
  5. /dev/about
  6. /dev/post/dev-mode
  7. /dev/post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3574 bytes
 GET /dev/posts 200 in 52ms
[Firebase Admin] Starting initialization...
[Firebase Admin] Starting initialization...
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/dev/posts
    - Hostname: localhost:3000
    - Pathname: /dev/posts
    - Headers: {
  "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "connection": "keep-alive",
  "cookie": "sidebar:state=true; __next_hmr_refresh_hash__=3b58d3fdfb05da79d5f76bbf8b2d5779633457081244afec",
  "host": "localhost:3000",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "sec-ch-ua-platform": "\"macOS\"",
  "sec-fetch-dest": "document",
  "sec-fetch-mode": "navigate",
  "sec-fetch-site": "none",
  "sec-fetch-user": "?1",
  "upgrade-insecure-requests": "1",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "dev",
  "isSubdomain": false,
  "pathInfo": {
    "originalPath": "/dev/posts",
    "normalizedPath": "/dev/posts",
    "pathSegments": [
      "dev",
      "posts"
    ],
    "pageType": "posts"
  },
  "hostInfo": {
    "hostname": "localhost:3000",
    "domainParts": [
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: localhost:3000/dev/posts
Main localhost domain detected, no rewrite needed
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: dev
    - Host: localhost:3000
    - Is subdomain detected: false
    - Original pathname: /posts
[SUBDOMAIN-DEBUG] Path processing:
        - Clean path: posts
        - Path without username: posts
        - Username check: dev
        - Starts with username?: false
[SUBDOMAIN-DEBUG] Page detection:
          - Path segments: [posts]
          - Selected page: posts
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: dev
    - Current page: posts
    - Is subdomain: false
[Posts Page] Request details:
    - Username: dev
    - Host: localhost:3000
    - Is subdomain (detected): false
    - Path: /posts
    - NODE_ENV: development
  
[Firebase Admin] isAdminAvailable() called:
    - adminInitialized: development
    - adminAuth available: false
    - adminDb available: false
    - real admin available: false
    - NODE_ENV: development
    - Project ID: mini-app-00
  
Error: Route "/[username]/posts" used `headers().get('host')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at isAdminAvailable (src/lib/firebase/admin.ts:139:25)
    at UserPostsPage (src/app/[username]/posts/page.tsx:32:40)
  137 |       const { headers } = require('next/headers');
  138 |       const headersList = headers();
> 139 |       host = headersList.get('host') || '';
      |                         ^
  140 |     } else {
  141 |       host = window.location.host;
  142 |     }
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[Firebase Admin] Admin not available but in development mode - allowing demo content
[Posts Page] Admin availability check result: true
[Posts Page] Firebase Admin DB not available but in development mode.
        - Username: dev
        - Host: localhost:3000
        - Is subdomain: false
        - NODE_ENV: development
      
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: posts
[THEME-DEBUG] Navigation context:
        - Username: dev
        - Current page: posts
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: dev's Blog
        - Username: dev
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /dev/
  4. /dev/posts
  5. /dev/about
  6. /dev/post/dev-mode
  7. /dev/post/firebase-admin-nextjs
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: posts
        - Username: dev
        - Is subdomain: false
        - Current page: posts
        - Template context keys: site, posts, navigationContext, content, navigation, userCSS, currentYear
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: dev
    - Is subdomain: false
    - HTML length: 3432
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>dev&#39;s Blog</ti...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /dev/
    /dev/posts
    /dev/about
    /dev/post/dev-mode
    /dev/post/firebase-admin-nextjs
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/dev/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/dev/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/dev/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/dev/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/dev/post/dev-mode"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/dev/post/firebase-admin-nextjs"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/dev/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /dev/themes/altay/theme.css
  3. /dev/
  4. /dev/posts
  5. /dev/about
  6. /dev/post/dev-mode
  7. /dev/post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3574 bytes
 GET /dev/posts 200 in 1192ms
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: favicon.ico
    - Host header: localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: not set
    - X-Minispace-Original-Host: not set
    - X-Minispace-Username: not set
    - All headers: {
  "host": "localhost:3000",
  "connection": "keep-alive",
  "sec-ch-ua-platform": "\"macOS\"",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "accept": "image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8",
  "sec-fetch-site": "same-origin",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-dest": "image",
  "referer": "http://localhost:3000/dev/posts",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cookie": "sidebar:state=true; __next_hmr_refresh_hash__=3b58d3fdfb05da79d5f76bbf8b2d5779633457081244afec",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::1"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: favicon.ico
    - Host: localhost:3000
    - Is subdomain detected: false
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: favicon.ico
    - Current page: home
    - Is subdomain: false
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: favicon.ico
    - Is subdomain: false
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for favicon.ico
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: favicon.ico
        - Current page: home
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: Favicon.ico
        - Username: favicon.ico
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: favicon.ico
        - Is subdomain: false
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: favicon.ico
    - Is subdomain: false
    - HTML length: 3972
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Favicon.ico</title...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /favicon.ico/
    /favicon.ico/posts
    /favicon.ico/about
    /favicon.ico/post/welcome
    /favicon.ico/post/getting-started
    /favicon.ico/posts
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/favicon.ico/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/welcome"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/getting-started"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/favicon.ico/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /favicon.ico/themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4129 bytes
 GET /favicon.ico 200 in 212ms
[Firebase Admin] Starting initialization...
[Firebase Admin] Starting initialization...
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/dev/themes/altay/theme.css
    - Hostname: localhost:3000
    - Pathname: /dev/themes/altay/theme.css
    - Headers: {
  "accept": "text/css,*/*;q=0.1",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "connection": "keep-alive",
  "cookie": "sidebar:state=true; __next_hmr_refresh_hash__=3b58d3fdfb05da79d5f76bbf8b2d5779633457081244afec; authToken=eyJhbGciOiJSUzI1NiIsImtpZCI6ImZlNjVjY2I4ZWFkMGJhZWY1ZmQzNjE5NWQ2NTI4YTA1NGZiYjc2ZjMiLCJ0eXAiOiJKV1QifQ.eyJuYW1lIjoiRGVtb3VzZXIiLCJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vbWluaS1hcHAtMDAiLCJhdWQiOiJtaW5pLWFwcC0wMCIsImF1dGhfdGltZSI6MTc0ODI4MjIxMiwidXNlcl9pZCI6IjNLWVZtUDhiSkxSVmNKRHdVWHUydzRhblJkdTEiLCJzdWIiOiIzS1lWbVA4YkpMUlZjSkR3VVh1Mnc0YW5SZHUxIiwiaWF0IjoxNzQ4MzcwOTIxLCJleHAiOjE3NDgzNzQ1MjEsImVtYWlsIjoiZGVtb0BnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsImZpcmViYXNlIjp7ImlkZW50aXRpZXMiOnsiZW1haWwiOlsiZGVtb0BnbWFpbC5jb20iXX0sInNpZ25faW5fcHJvdmlkZXIiOiJwYXNzd29yZCJ9fQ.aPnbe2RFyR1kWMutwuzwcES1W4XKFbDP0raCBwQai8PvFbZ9uNRbkiBoMIqaZIpGyNUEefaIK9uoctILpUvA-vOPWr4PhzN0pJ1H3pvVHXVcTX7d6C6Ff13B8fvLaffd9CR0hbLatLxGGvvZDgEe1EfBSe05zY7gV823CQitQUoVJhxxqXhM6aZ-N4979LZKTsocLjMZSt5SOC9n62QWapfhHBb3XA-wjtUm4i9DrmBkFlQxcSLuY4ZDVKfP9ISUfsliKI90fgRNDnkyUE6tDDQBi4wqORuegWjfRjyO8wXwGkUvV1E0MgzPMmO7dCc5I-BTpj-jjuDfw5OpQOZs1g; username=demouser",
  "host": "localhost:3000",
  "referer": "http://localhost:3000/dev/posts",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "sec-ch-ua-platform": "\"macOS\"",
  "sec-fetch-dest": "style",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-site": "same-origin",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "dev",
  "isSubdomain": false,
  "pathInfo": {
    "originalPath": "/dev/themes/altay/theme.css",
    "normalizedPath": "/dev/themes/altay/theme.css",
    "pathSegments": [
      "dev",
      "themes",
      "altay",
      "theme.css"
    ],
    "pageType": "themes"
  },
  "hostInfo": {
    "hostname": "localhost:3000",
    "domainParts": [
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: favicon.ico
    - Host header: localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: not set
    - X-Minispace-Original-Host: not set
    - X-Minispace-Username: not set
    - All headers: {
  "host": "localhost:3000",
  "connection": "keep-alive",
  "sec-ch-ua-platform": "\"macOS\"",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "accept": "image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8",
  "sec-fetch-site": "same-origin",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-dest": "image",
  "referer": "http://localhost:3000/dev/posts",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cookie": "sidebar:state=true; __next_hmr_refresh_hash__=3b58d3fdfb05da79d5f76bbf8b2d5779633457081244afec; authToken=eyJhbGciOiJSUzI1NiIsImtpZCI6ImZlNjVjY2I4ZWFkMGJhZWY1ZmQzNjE5NWQ2NTI4YTA1NGZiYjc2ZjMiLCJ0eXAiOiJKV1QifQ.eyJuYW1lIjoiRGVtb3VzZXIiLCJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vbWluaS1hcHAtMDAiLCJhdWQiOiJtaW5pLWFwcC0wMCIsImF1dGhfdGltZSI6MTc0ODI4MjIxMiwidXNlcl9pZCI6IjNLWVZtUDhiSkxSVmNKRHdVWHUydzRhblJkdTEiLCJzdWIiOiIzS1lWbVA4YkpMUlZjSkR3VVh1Mnc0YW5SZHUxIiwiaWF0IjoxNzQ4MzcwOTIxLCJleHAiOjE3NDgzNzQ1MjEsImVtYWlsIjoiZGVtb0BnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsImZpcmViYXNlIjp7ImlkZW50aXRpZXMiOnsiZW1haWwiOlsiZGVtb0BnbWFpbC5jb20iXX0sInNpZ25faW5fcHJvdmlkZXIiOiJwYXNzd29yZCJ9fQ.aPnbe2RFyR1kWMutwuzwcES1W4XKFbDP0raCBwQai8PvFbZ9uNRbkiBoMIqaZIpGyNUEefaIK9uoctILpUvA-vOPWr4PhzN0pJ1H3pvVHXVcTX7d6C6Ff13B8fvLaffd9CR0hbLatLxGGvvZDgEe1EfBSe05zY7gV823CQitQUoVJhxxqXhM6aZ-N4979LZKTsocLjMZSt5SOC9n62QWapfhHBb3XA-wjtUm4i9DrmBkFlQxcSLuY4ZDVKfP9ISUfsliKI90fgRNDnkyUE6tDDQBi4wqORuegWjfRjyO8wXwGkUvV1E0MgzPMmO7dCc5I-BTpj-jjuDfw5OpQOZs1g; username=demouser",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::1"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: favicon.ico
    - Host: localhost:3000
    - Is subdomain detected: false
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: favicon.ico
    - Current page: home
    - Is subdomain: false
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: favicon.ico
    - Is subdomain: false
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for favicon.ico
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: favicon.ico
        - Current page: home
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: Favicon.ico
        - Username: favicon.ico
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: favicon.ico
        - Is subdomain: false
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: favicon.ico
    - Is subdomain: false
    - HTML length: 3972
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Favicon.ico</title...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /favicon.ico/
    /favicon.ico/posts
    /favicon.ico/about
    /favicon.ico/post/welcome
    /favicon.ico/post/getting-started
    /favicon.ico/posts
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/favicon.ico/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/welcome"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/getting-started"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/favicon.ico/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /favicon.ico/themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4129 bytes
 GET /favicon.ico 200 in 79ms
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: favicon.ico
    - Host header: localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: not set
    - X-Minispace-Original-Host: not set
    - X-Minispace-Username: not set
    - All headers: {
  "host": "localhost:3000",
  "connection": "keep-alive",
  "sec-ch-ua-platform": "\"macOS\"",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "accept": "image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8",
  "sec-fetch-site": "same-origin",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-dest": "image",
  "referer": "http://localhost:3000/dev/posts",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cookie": "sidebar:state=true; __next_hmr_refresh_hash__=3b58d3fdfb05da79d5f76bbf8b2d5779633457081244afec; authToken=eyJhbGciOiJSUzI1NiIsImtpZCI6ImZlNjVjY2I4ZWFkMGJhZWY1ZmQzNjE5NWQ2NTI4YTA1NGZiYjc2ZjMiLCJ0eXAiOiJKV1QifQ.eyJuYW1lIjoiRGVtb3VzZXIiLCJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vbWluaS1hcHAtMDAiLCJhdWQiOiJtaW5pLWFwcC0wMCIsImF1dGhfdGltZSI6MTc0ODI4MjIxMiwidXNlcl9pZCI6IjNLWVZtUDhiSkxSVmNKRHdVWHUydzRhblJkdTEiLCJzdWIiOiIzS1lWbVA4YkpMUlZjSkR3VVh1Mnc0YW5SZHUxIiwiaWF0IjoxNzQ4MzcwOTIxLCJleHAiOjE3NDgzNzQ1MjEsImVtYWlsIjoiZGVtb0BnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsImZpcmViYXNlIjp7ImlkZW50aXRpZXMiOnsiZW1haWwiOlsiZGVtb0BnbWFpbC5jb20iXX0sInNpZ25faW5fcHJvdmlkZXIiOiJwYXNzd29yZCJ9fQ.aPnbe2RFyR1kWMutwuzwcES1W4XKFbDP0raCBwQai8PvFbZ9uNRbkiBoMIqaZIpGyNUEefaIK9uoctILpUvA-vOPWr4PhzN0pJ1H3pvVHXVcTX7d6C6Ff13B8fvLaffd9CR0hbLatLxGGvvZDgEe1EfBSe05zY7gV823CQitQUoVJhxxqXhM6aZ-N4979LZKTsocLjMZSt5SOC9n62QWapfhHBb3XA-wjtUm4i9DrmBkFlQxcSLuY4ZDVKfP9ISUfsliKI90fgRNDnkyUE6tDDQBi4wqORuegWjfRjyO8wXwGkUvV1E0MgzPMmO7dCc5I-BTpj-jjuDfw5OpQOZs1g; username=demouser",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::1"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: favicon.ico
    - Host: localhost:3000
    - Is subdomain detected: false
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: favicon.ico
    - Current page: home
    - Is subdomain: false
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: favicon.ico
    - Is subdomain: false
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for favicon.ico
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: favicon.ico
        - Current page: home
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: Favicon.ico
        - Username: favicon.ico
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: favicon.ico
        - Is subdomain: false
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: favicon.ico
    - Is subdomain: false
    - HTML length: 3972
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Favicon.ico</title...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /favicon.ico/
    /favicon.ico/posts
    /favicon.ico/about
    /favicon.ico/post/welcome
    /favicon.ico/post/getting-started
    /favicon.ico/posts
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/favicon.ico/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/welcome"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/getting-started"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/favicon.ico/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /favicon.ico/themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4129 bytes
 GET /favicon.ico 200 in 72ms
 ○ Compiling /_not-found/page ...
[Firebase Admin] Starting initialization...
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
 ✓ Compiled /_not-found/page in 1580ms
 GET /dev/themes/altay/theme.css 404 in 1636ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/
    - Hostname: demouser.localhost:3000
    - Pathname: /
    - Headers: {
  "connection": "keep-alive",
  "host": "demouser.localhost:3000",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "demouser",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/",
    "normalizedPath": "/",
    "pathSegments": [],
    "pageType": "home"
  },
  "hostInfo": {
    "hostname": "demouser.localhost:3000",
    "domainParts": [
      "demouser",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: demouser.localhost:3000/
[Middleware] Is subdomain check: demouser.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Subdomain request detected:
      - Username: demouser
      - Original pathname: /
      - Is root path: true
[SUBDOMAIN-DEBUG] Rewriting URL:
      - From: http://localhost:3000/
      - To pathname: /demouser
      - Full new URL: http://localhost:3000/demouser
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: demouser
    - Host header: demouser.localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: true
    - X-Minispace-Original-Host: demouser.localhost:3000
    - X-Minispace-Username: demouser
    - All headers: {
  "host": "demouser.localhost:3000",
  "connection": "keep-alive",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-minispace-original-host": "demouser.localhost:3000",
  "x-minispace-path-analysis": "{\"originalPath\":\"/\",\"normalizedPath\":\"/\",\"pageType\":\"home\"}",
  "x-minispace-rewritten-from-subdomain": "true",
  "x-minispace-username": "demouser"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: demouser
    - Host: demouser.localhost:3000
    - Is subdomain detected: true
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: demouser
    - Current page: home
    - Is subdomain: true
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: demouser
    - Is subdomain: true
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for demouser
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: demouser
        - Current page: home
        - Is subdomain: true
      
[THEME-DEBUG] Site context:
        - Title: Demouser
        - Username: demouser
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/welcome
  7. /post/getting-started
  8. /posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-render)
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: demouser
        - Is subdomain: true
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: demouser
    - Is subdomain: true
    - HTML length: 3882
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Demouser</title>
 ...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /
    /posts
    /about
    /post/welcome
    /post/getting-started
    /posts
[SUBDOMAIN-DEBUG] Subdomain mode - transforming username-prefixed links to relative links
    - Username pattern: /href="\/demouser(\/[^"]*|\/?)?"/g
[SUBDOMAIN-DEBUG] Links after subdomain transformation:
      []
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/welcome
  7. /post/getting-started
  8. /posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4023 bytes
 GET / 200 in 90ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/posts
    - Hostname: demouser.localhost:3000
    - Pathname: /posts
    - Headers: {
  "connection": "keep-alive",
  "host": "demouser.localhost:3000",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "demouser",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/posts",
    "normalizedPath": "/posts",
    "pathSegments": [
      "posts"
    ],
    "pageType": "posts"
  },
  "hostInfo": {
    "hostname": "demouser.localhost:3000",
    "domainParts": [
      "demouser",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: demouser.localhost:3000/posts
[Middleware] Is subdomain check: demouser.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Subdomain request detected:
      - Username: demouser
      - Original pathname: /posts
      - Is root path: false
[SUBDOMAIN-DEBUG] Rewriting URL:
      - From: http://localhost:3000/posts
      - To pathname: /demouser/posts
      - Full new URL: http://localhost:3000/demouser/posts
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: demouser
    - Host: demouser.localhost:3000
    - Is subdomain detected: true
    - Original pathname: /posts
[SUBDOMAIN-DEBUG] Path processing:
        - Clean path: posts
        - Path without username: posts
        - Username check: demouser
        - Starts with username?: false
[SUBDOMAIN-DEBUG] Page detection:
          - Path segments: [posts]
          - Selected page: posts
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: demouser
    - Current page: posts
    - Is subdomain: true
[Posts Page] Request details:
    - Username: demouser
    - Host: demouser.localhost:3000
    - Is subdomain (detected): true
    - Path: /posts
    - NODE_ENV: development
  
[Firebase Admin] isAdminAvailable() called:
    - adminInitialized: development
    - adminAuth available: false
    - adminDb available: false
    - real admin available: false
    - NODE_ENV: development
    - Project ID: mini-app-00
  
Error: Route "/[username]/posts" used `headers().get('host')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at isAdminAvailable (src/lib/firebase/admin.ts:139:25)
    at UserPostsPage (src/app/[username]/posts/page.tsx:32:40)
  137 |       const { headers } = require('next/headers');
  138 |       const headersList = headers();
> 139 |       host = headersList.get('host') || '';
      |                         ^
  140 |     } else {
  141 |       host = window.location.host;
  142 |     }
[Firebase Admin] Detected subdomain request on host: demouser.localhost:3000
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[Firebase Admin] Admin not available but in development mode - allowing demo content
[Posts Page] Admin availability check result: true
[Posts Page] Firebase Admin DB not available but in development mode.
        - Username: demouser
        - Host: demouser.localhost:3000
        - Is subdomain: true
        - NODE_ENV: development
      
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: posts
[THEME-DEBUG] Navigation context:
        - Username: demouser
        - Current page: posts
        - Is subdomain: true
      
[THEME-DEBUG] Site context:
        - Title: demouser's Blog
        - Username: demouser
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/dev-mode
  7. /post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-render)
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: posts
        - Username: demouser
        - Is subdomain: true
        - Current page: posts
        - Template context keys: site, posts, navigationContext, content, navigation, userCSS, currentYear
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: demouser
    - Is subdomain: true
    - HTML length: 3432
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>demouser&#39;s Blo...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /
    /posts
    /about
    /post/dev-mode
    /post/firebase-admin-nextjs
[SUBDOMAIN-DEBUG] Subdomain mode - transforming username-prefixed links to relative links
    - Username pattern: /href="\/demouser(\/[^"]*|\/?)?"/g
[SUBDOMAIN-DEBUG] Links after subdomain transformation:
      []
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/dev-mode
  7. /post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3574 bytes
 GET /posts 200 in 89ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/demouser/posts
    - Hostname: localhost:3000
    - Pathname: /demouser/posts
    - Headers: {
  "connection": "keep-alive",
  "host": "localhost:3000",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "demouser",
  "isSubdomain": false,
  "pathInfo": {
    "originalPath": "/demouser/posts",
    "normalizedPath": "/demouser/posts",
    "pathSegments": [
      "demouser",
      "posts"
    ],
    "pageType": "posts"
  },
  "hostInfo": {
    "hostname": "localhost:3000",
    "domainParts": [
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: localhost:3000/demouser/posts
Main localhost domain detected, no rewrite needed
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: demouser
    - Host: localhost:3000
    - Is subdomain detected: false
    - Original pathname: /posts
[SUBDOMAIN-DEBUG] Path processing:
        - Clean path: posts
        - Path without username: posts
        - Username check: demouser
        - Starts with username?: false
[SUBDOMAIN-DEBUG] Page detection:
          - Path segments: [posts]
          - Selected page: posts
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: demouser
    - Current page: posts
    - Is subdomain: false
[Posts Page] Request details:
    - Username: demouser
    - Host: localhost:3000
    - Is subdomain (detected): false
    - Path: /posts
    - NODE_ENV: development
  
[Firebase Admin] isAdminAvailable() called:
    - adminInitialized: development
    - adminAuth available: false
    - adminDb available: false
    - real admin available: false
    - NODE_ENV: development
    - Project ID: mini-app-00
  
Error: Route "/[username]/posts" used `headers().get('host')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at isAdminAvailable (src/lib/firebase/admin.ts:139:25)
    at UserPostsPage (src/app/[username]/posts/page.tsx:32:40)
  137 |       const { headers } = require('next/headers');
  138 |       const headersList = headers();
> 139 |       host = headersList.get('host') || '';
      |                         ^
  140 |     } else {
  141 |       host = window.location.host;
  142 |     }
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[Firebase Admin] Admin not available but in development mode - allowing demo content
[Posts Page] Admin availability check result: true
[Posts Page] Firebase Admin DB not available but in development mode.
        - Username: demouser
        - Host: localhost:3000
        - Is subdomain: false
        - NODE_ENV: development
      
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: posts
[THEME-DEBUG] Navigation context:
        - Username: demouser
        - Current page: posts
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: demouser's Blog
        - Username: demouser
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /demouser/
  4. /demouser/posts
  5. /demouser/about
  6. /demouser/post/dev-mode
  7. /demouser/post/firebase-admin-nextjs
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: posts
        - Username: demouser
        - Is subdomain: false
        - Current page: posts
        - Template context keys: site, posts, navigationContext, content, navigation, userCSS, currentYear
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: demouser
    - Is subdomain: false
    - HTML length: 3477
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>demouser&#39;s Blo...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /demouser/
    /demouser/posts
    /demouser/about
    /demouser/post/dev-mode
    /demouser/post/firebase-admin-nextjs
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/demouser/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/demouser/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/demouser/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/demouser/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/demouser/post/dev-mode"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/demouser/post/firebase-admin-nextjs"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/demouser/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /demouser/themes/altay/theme.css
  3. /demouser/
  4. /demouser/posts
  5. /demouser/about
  6. /demouser/post/dev-mode
  7. /demouser/post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3629 bytes
 GET /demouser/posts 200 in 102ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/post/welcome
    - Hostname: demouser.localhost:3000
    - Pathname: /post/welcome
    - Headers: {
  "connection": "keep-alive",
  "host": "demouser.localhost:3000",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "demouser",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/post/welcome",
    "normalizedPath": "/post/welcome",
    "pathSegments": [
      "post",
      "welcome"
    ],
    "pageType": "post-single"
  },
  "hostInfo": {
    "hostname": "demouser.localhost:3000",
    "domainParts": [
      "demouser",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: demouser.localhost:3000/post/welcome
[Middleware] Is subdomain check: demouser.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Subdomain request detected:
      - Username: demouser
      - Original pathname: /post/welcome
      - Is root path: false
[SUBDOMAIN-DEBUG] Rewriting URL:
      - From: http://localhost:3000/post/welcome
      - To pathname: /demouser/post/welcome
      - Full new URL: http://localhost:3000/demouser/post/welcome
 ○ Compiling /[username]/post/[slug] ...
[Firebase Admin] Starting initialization...
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
[Firebase Admin] Starting initialization...
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
 ✓ Compiled /[username]/post/[slug] in 3.6s
 GET /post/welcome 200 in 4213ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/demouser/post/welcome
    - Hostname: localhost:3000
    - Pathname: /demouser/post/welcome
    - Headers: {
  "connection": "keep-alive",
  "host": "localhost:3000",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "demouser",
  "isSubdomain": false,
  "pathInfo": {
    "originalPath": "/demouser/post/welcome",
    "normalizedPath": "/demouser/post/welcome",
    "pathSegments": [
      "demouser",
      "post",
      "welcome"
    ],
    "pageType": "post-single"
  },
  "hostInfo": {
    "hostname": "localhost:3000",
    "domainParts": [
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: localhost:3000/demouser/post/welcome
Main localhost domain detected, no rewrite needed
 GET /demouser/post/welcome 200 in 53ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/about
    - Hostname: demouser.localhost:3000
    - Pathname: /about
    - Headers: {
  "connection": "keep-alive",
  "host": "demouser.localhost:3000",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "demouser",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/about",
    "normalizedPath": "/about",
    "pathSegments": [
      "about"
    ],
    "pageType": "about"
  },
  "hostInfo": {
    "hostname": "demouser.localhost:3000",
    "domainParts": [
      "demouser",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: demouser.localhost:3000/about
[Middleware] Is subdomain check: demouser.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Subdomain request detected:
      - Username: demouser
      - Original pathname: /about
      - Is root path: false
[SUBDOMAIN-DEBUG] Rewriting URL:
      - From: http://localhost:3000/about
      - To pathname: /demouser/about
      - Full new URL: http://localhost:3000/demouser/about
 GET /about 404 in 78ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/demouser/about
    - Hostname: localhost:3000
    - Pathname: /demouser/about
    - Headers: {
  "connection": "keep-alive",
  "host": "localhost:3000",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "demouser",
  "isSubdomain": false,
  "pathInfo": {
    "originalPath": "/demouser/about",
    "normalizedPath": "/demouser/about",
    "pathSegments": [
      "demouser",
      "about"
    ],
    "pageType": "about"
  },
  "hostInfo": {
    "hostname": "localhost:3000",
    "domainParts": [
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: localhost:3000/demouser/about
Main localhost domain detected, no rewrite needed
 GET /demouser/about 404 in 46ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/
    - Hostname: test.localhost:3000
    - Pathname: /
    - Headers: {
  "connection": "keep-alive",
  "host": "test.localhost:3000",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-forwarded-host": "test.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "test",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/",
    "normalizedPath": "/",
    "pathSegments": [],
    "pageType": "home"
  },
  "hostInfo": {
    "hostname": "test.localhost:3000",
    "domainParts": [
      "test",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: test.localhost:3000/
[Middleware] Is subdomain check: test.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Subdomain request detected:
      - Username: test
      - Original pathname: /
      - Is root path: true
[SUBDOMAIN-DEBUG] Rewriting URL:
      - From: http://localhost:3000/
      - To pathname: /test
      - Full new URL: http://localhost:3000/test
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: test
    - Host header: test.localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: true
    - X-Minispace-Original-Host: test.localhost:3000
    - X-Minispace-Username: test
    - All headers: {
  "host": "test.localhost:3000",
  "connection": "keep-alive",
  "x-forwarded-host": "test.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-minispace-original-host": "test.localhost:3000",
  "x-minispace-path-analysis": "{\"originalPath\":\"/\",\"normalizedPath\":\"/\",\"pageType\":\"home\"}",
  "x-minispace-rewritten-from-subdomain": "true",
  "x-minispace-username": "test"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: test
    - Host: test.localhost:3000
    - Is subdomain detected: true
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: test
    - Current page: home
    - Is subdomain: true
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: test
    - Is subdomain: true
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for test
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: test
        - Current page: home
        - Is subdomain: true
      
[THEME-DEBUG] Site context:
        - Title: Test
        - Username: test
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/welcome
  7. /post/getting-started
  8. /posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-render)
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: test
        - Is subdomain: true
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: test
    - Is subdomain: true
    - HTML length: 3858
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Test</title>
    <...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /
    /posts
    /about
    /post/welcome
    /post/getting-started
    /posts
[SUBDOMAIN-DEBUG] Subdomain mode - transforming username-prefixed links to relative links
    - Username pattern: /href="\/test(\/[^"]*|\/?)?"/g
[SUBDOMAIN-DEBUG] Links after subdomain transformation:
      []
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/welcome
  7. /post/getting-started
  8. /posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3995 bytes
 GET / 200 in 57ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/posts
    - Hostname: test.localhost:3000
    - Pathname: /posts
    - Headers: {
  "connection": "keep-alive",
  "host": "test.localhost:3000",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-forwarded-host": "test.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "test",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/posts",
    "normalizedPath": "/posts",
    "pathSegments": [
      "posts"
    ],
    "pageType": "posts"
  },
  "hostInfo": {
    "hostname": "test.localhost:3000",
    "domainParts": [
      "test",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: test.localhost:3000/posts
[Middleware] Is subdomain check: test.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Subdomain request detected:
      - Username: test
      - Original pathname: /posts
      - Is root path: false
[SUBDOMAIN-DEBUG] Rewriting URL:
      - From: http://localhost:3000/posts
      - To pathname: /test/posts
      - Full new URL: http://localhost:3000/test/posts
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: test
    - Host: test.localhost:3000
    - Is subdomain detected: true
    - Original pathname: /posts
[SUBDOMAIN-DEBUG] Path processing:
        - Clean path: posts
        - Path without username: posts
        - Username check: test
        - Starts with username?: false
[SUBDOMAIN-DEBUG] Page detection:
          - Path segments: [posts]
          - Selected page: posts
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: test
    - Current page: posts
    - Is subdomain: true
[Posts Page] Request details:
    - Username: test
    - Host: test.localhost:3000
    - Is subdomain (detected): true
    - Path: /posts
    - NODE_ENV: development
  
[Firebase Admin] isAdminAvailable() called:
    - adminInitialized: development
    - adminAuth available: false
    - adminDb available: false
    - real admin available: false
    - NODE_ENV: development
    - Project ID: mini-app-00
  
Error: Route "/[username]/posts" used `headers().get('host')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at isAdminAvailable (src/lib/firebase/admin.ts:139:25)
    at UserPostsPage (src/app/[username]/posts/page.tsx:32:40)
  137 |       const { headers } = require('next/headers');
  138 |       const headersList = headers();
> 139 |       host = headersList.get('host') || '';
      |                         ^
  140 |     } else {
  141 |       host = window.location.host;
  142 |     }
[Firebase Admin] Detected subdomain request on host: test.localhost:3000
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[Firebase Admin] Admin not available but in development mode - allowing demo content
[Posts Page] Admin availability check result: true
[Posts Page] Firebase Admin DB not available but in development mode.
        - Username: test
        - Host: test.localhost:3000
        - Is subdomain: true
        - NODE_ENV: development
      
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: posts
[THEME-DEBUG] Navigation context:
        - Username: test
        - Current page: posts
        - Is subdomain: true
      
[THEME-DEBUG] Site context:
        - Title: test's Blog
        - Username: test
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/dev-mode
  7. /post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-render)
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: posts
        - Username: test
        - Is subdomain: true
        - Current page: posts
        - Template context keys: site, posts, navigationContext, content, navigation, userCSS, currentYear
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: test
    - Is subdomain: true
    - HTML length: 3416
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>test&#39;s Blog</t...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /
    /posts
    /about
    /post/dev-mode
    /post/firebase-admin-nextjs
[SUBDOMAIN-DEBUG] Subdomain mode - transforming username-prefixed links to relative links
    - Username pattern: /href="\/test(\/[^"]*|\/?)?"/g
[SUBDOMAIN-DEBUG] Links after subdomain transformation:
      []
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/dev-mode
  7. /post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3554 bytes
 GET /posts 200 in 88ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/test/posts
    - Hostname: localhost:3000
    - Pathname: /test/posts
    - Headers: {
  "connection": "keep-alive",
  "host": "localhost:3000",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "test",
  "isSubdomain": false,
  "pathInfo": {
    "originalPath": "/test/posts",
    "normalizedPath": "/test/posts",
    "pathSegments": [
      "test",
      "posts"
    ],
    "pageType": "posts"
  },
  "hostInfo": {
    "hostname": "localhost:3000",
    "domainParts": [
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: localhost:3000/test/posts
Main localhost domain detected, no rewrite needed
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: test
    - Host: localhost:3000
    - Is subdomain detected: false
    - Original pathname: /posts
[SUBDOMAIN-DEBUG] Path processing:
        - Clean path: posts
        - Path without username: posts
        - Username check: test
        - Starts with username?: false
[SUBDOMAIN-DEBUG] Page detection:
          - Path segments: [posts]
          - Selected page: posts
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: test
    - Current page: posts
    - Is subdomain: false
[Posts Page] Request details:
    - Username: test
    - Host: localhost:3000
    - Is subdomain (detected): false
    - Path: /posts
    - NODE_ENV: development
  
[Firebase Admin] isAdminAvailable() called:
    - adminInitialized: development
    - adminAuth available: false
    - adminDb available: false
    - real admin available: false
    - NODE_ENV: development
    - Project ID: mini-app-00
  
Error: Route "/[username]/posts" used `headers().get('host')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at isAdminAvailable (src/lib/firebase/admin.ts:139:25)
    at UserPostsPage (src/app/[username]/posts/page.tsx:32:40)
  137 |       const { headers } = require('next/headers');
  138 |       const headersList = headers();
> 139 |       host = headersList.get('host') || '';
      |                         ^
  140 |     } else {
  141 |       host = window.location.host;
  142 |     }
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[Firebase Admin] Admin not available but in development mode - allowing demo content
[Posts Page] Admin availability check result: true
[Posts Page] Firebase Admin DB not available but in development mode.
        - Username: test
        - Host: localhost:3000
        - Is subdomain: false
        - NODE_ENV: development
      
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: posts
[THEME-DEBUG] Navigation context:
        - Username: test
        - Current page: posts
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: test's Blog
        - Username: test
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /test/
  4. /test/posts
  5. /test/about
  6. /test/post/dev-mode
  7. /test/post/firebase-admin-nextjs
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: posts
        - Username: test
        - Is subdomain: false
        - Current page: posts
        - Template context keys: site, posts, navigationContext, content, navigation, userCSS, currentYear
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: test
    - Is subdomain: false
    - HTML length: 3441
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>test&#39;s Blog</t...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /test/
    /test/posts
    /test/about
    /test/post/dev-mode
    /test/post/firebase-admin-nextjs
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/test/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/test/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/test/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/test/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/test/post/dev-mode"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/test/post/firebase-admin-nextjs"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/test/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /test/themes/altay/theme.css
  3. /test/
  4. /test/posts
  5. /test/about
  6. /test/post/dev-mode
  7. /test/post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3585 bytes
 GET /test/posts 200 in 96ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/post/welcome
    - Hostname: test.localhost:3000
    - Pathname: /post/welcome
    - Headers: {
  "connection": "keep-alive",
  "host": "test.localhost:3000",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-forwarded-host": "test.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "test",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/post/welcome",
    "normalizedPath": "/post/welcome",
    "pathSegments": [
      "post",
      "welcome"
    ],
    "pageType": "post-single"
  },
  "hostInfo": {
    "hostname": "test.localhost:3000",
    "domainParts": [
      "test",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: test.localhost:3000/post/welcome
[Middleware] Is subdomain check: test.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Subdomain request detected:
      - Username: test
      - Original pathname: /post/welcome
      - Is root path: false
[SUBDOMAIN-DEBUG] Rewriting URL:
      - From: http://localhost:3000/post/welcome
      - To pathname: /test/post/welcome
      - Full new URL: http://localhost:3000/test/post/welcome
 GET /post/welcome 200 in 80ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/test/post/welcome
    - Hostname: localhost:3000
    - Pathname: /test/post/welcome
    - Headers: {
  "connection": "keep-alive",
  "host": "localhost:3000",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "test",
  "isSubdomain": false,
  "pathInfo": {
    "originalPath": "/test/post/welcome",
    "normalizedPath": "/test/post/welcome",
    "pathSegments": [
      "test",
      "post",
      "welcome"
    ],
    "pageType": "post-single"
  },
  "hostInfo": {
    "hostname": "localhost:3000",
    "domainParts": [
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: localhost:3000/test/post/welcome
Main localhost domain detected, no rewrite needed
 GET /test/post/welcome 200 in 71ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/about
    - Hostname: test.localhost:3000
    - Pathname: /about
    - Headers: {
  "connection": "keep-alive",
  "host": "test.localhost:3000",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-forwarded-host": "test.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "test",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/about",
    "normalizedPath": "/about",
    "pathSegments": [
      "about"
    ],
    "pageType": "about"
  },
  "hostInfo": {
    "hostname": "test.localhost:3000",
    "domainParts": [
      "test",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: test.localhost:3000/about
[Middleware] Is subdomain check: test.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Subdomain request detected:
      - Username: test
      - Original pathname: /about
      - Is root path: false
[SUBDOMAIN-DEBUG] Rewriting URL:
      - From: http://localhost:3000/about
      - To pathname: /test/about
      - Full new URL: http://localhost:3000/test/about
 GET /about 404 in 75ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/test/about
    - Hostname: localhost:3000
    - Pathname: /test/about
    - Headers: {
  "connection": "keep-alive",
  "host": "localhost:3000",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "test",
  "isSubdomain": false,
  "pathInfo": {
    "originalPath": "/test/about",
    "normalizedPath": "/test/about",
    "pathSegments": [
      "test",
      "about"
    ],
    "pageType": "about"
  },
  "hostInfo": {
    "hostname": "localhost:3000",
    "domainParts": [
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: localhost:3000/test/about
Main localhost domain detected, no rewrite needed
 GET /test/about 404 in 67ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/
    - Hostname: dev.localhost:3000
    - Pathname: /
    - Headers: {
  "connection": "keep-alive",
  "host": "dev.localhost:3000",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-forwarded-host": "dev.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "dev",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/",
    "normalizedPath": "/",
    "pathSegments": [],
    "pageType": "home"
  },
  "hostInfo": {
    "hostname": "dev.localhost:3000",
    "domainParts": [
      "dev",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: dev.localhost:3000/
[Middleware] Is subdomain check: dev.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Subdomain request detected:
      - Username: dev
      - Original pathname: /
      - Is root path: true
[SUBDOMAIN-DEBUG] Rewriting URL:
      - From: http://localhost:3000/
      - To pathname: /dev
      - Full new URL: http://localhost:3000/dev
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[Firebase Admin] Starting initialization...
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: dev
    - Host header: dev.localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: true
    - X-Minispace-Original-Host: dev.localhost:3000
    - X-Minispace-Username: dev
    - All headers: {
  "host": "dev.localhost:3000",
  "connection": "keep-alive",
  "x-forwarded-host": "dev.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-minispace-original-host": "dev.localhost:3000",
  "x-minispace-path-analysis": "{\"originalPath\":\"/\",\"normalizedPath\":\"/\",\"pageType\":\"home\"}",
  "x-minispace-rewritten-from-subdomain": "true",
  "x-minispace-username": "dev"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: dev
    - Host: dev.localhost:3000
    - Is subdomain detected: true
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: dev
    - Current page: home
    - Is subdomain: true
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: dev
    - Is subdomain: true
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for dev
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: dev
        - Current page: home
        - Is subdomain: true
      
[THEME-DEBUG] Site context:
        - Title: Dev
        - Username: dev
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/welcome
  7. /post/getting-started
  8. /posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-render)
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: dev
        - Is subdomain: true
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: dev
    - Is subdomain: true
    - HTML length: 3852
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Dev</title>
    <m...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /
    /posts
    /about
    /post/welcome
    /post/getting-started
    /posts
[SUBDOMAIN-DEBUG] Subdomain mode - transforming username-prefixed links to relative links
    - Username pattern: /href="\/dev(\/[^"]*|\/?)?"/g
[SUBDOMAIN-DEBUG] Links after subdomain transformation:
      []
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/welcome
  7. /post/getting-started
  8. /posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3988 bytes
 GET / 200 in 81ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/posts
    - Hostname: dev.localhost:3000
    - Pathname: /posts
    - Headers: {
  "connection": "keep-alive",
  "host": "dev.localhost:3000",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-forwarded-host": "dev.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "dev",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/posts",
    "normalizedPath": "/posts",
    "pathSegments": [
      "posts"
    ],
    "pageType": "posts"
  },
  "hostInfo": {
    "hostname": "dev.localhost:3000",
    "domainParts": [
      "dev",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: dev.localhost:3000/posts
[Middleware] Is subdomain check: dev.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Subdomain request detected:
      - Username: dev
      - Original pathname: /posts
      - Is root path: false
[SUBDOMAIN-DEBUG] Rewriting URL:
      - From: http://localhost:3000/posts
      - To pathname: /dev/posts
      - Full new URL: http://localhost:3000/dev/posts
[Firebase Admin] Starting initialization...
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: dev
    - Host: dev.localhost:3000
    - Is subdomain detected: true
    - Original pathname: /posts
[SUBDOMAIN-DEBUG] Path processing:
        - Clean path: posts
        - Path without username: posts
        - Username check: dev
        - Starts with username?: false
[SUBDOMAIN-DEBUG] Page detection:
          - Path segments: [posts]
          - Selected page: posts
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: dev
    - Current page: posts
    - Is subdomain: true
[Posts Page] Request details:
    - Username: dev
    - Host: dev.localhost:3000
    - Is subdomain (detected): true
    - Path: /posts
    - NODE_ENV: development
  
[Firebase Admin] isAdminAvailable() called:
    - adminInitialized: development
    - adminAuth available: false
    - adminDb available: false
    - real admin available: false
    - NODE_ENV: development
    - Project ID: mini-app-00
  
Error: Route "/[username]/posts" used `headers().get('host')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at isAdminAvailable (src/lib/firebase/admin.ts:139:25)
    at UserPostsPage (src/app/[username]/posts/page.tsx:32:40)
  137 |       const { headers } = require('next/headers');
  138 |       const headersList = headers();
> 139 |       host = headersList.get('host') || '';
      |                         ^
  140 |     } else {
  141 |       host = window.location.host;
  142 |     }
[Firebase Admin] Detected subdomain request on host: dev.localhost:3000
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[Firebase Admin] Admin not available but in development mode - allowing demo content
[Posts Page] Admin availability check result: true
[Posts Page] Firebase Admin DB not available but in development mode.
        - Username: dev
        - Host: dev.localhost:3000
        - Is subdomain: true
        - NODE_ENV: development
      
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: posts
[THEME-DEBUG] Navigation context:
        - Username: dev
        - Current page: posts
        - Is subdomain: true
      
[THEME-DEBUG] Site context:
        - Title: dev's Blog
        - Username: dev
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/dev-mode
  7. /post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-render)
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: posts
        - Username: dev
        - Is subdomain: true
        - Current page: posts
        - Template context keys: site, posts, navigationContext, content, navigation, userCSS, currentYear
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: dev
    - Is subdomain: true
    - HTML length: 3412
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>dev&#39;s Blog</ti...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /
    /posts
    /about
    /post/dev-mode
    /post/firebase-admin-nextjs
[SUBDOMAIN-DEBUG] Subdomain mode - transforming username-prefixed links to relative links
    - Username pattern: /href="\/dev(\/[^"]*|\/?)?"/g
[SUBDOMAIN-DEBUG] Links after subdomain transformation:
      []
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/dev-mode
  7. /post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3549 bytes
 GET /posts 200 in 47ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/dev/posts
    - Hostname: localhost:3000
    - Pathname: /dev/posts
    - Headers: {
  "connection": "keep-alive",
  "host": "localhost:3000",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "dev",
  "isSubdomain": false,
  "pathInfo": {
    "originalPath": "/dev/posts",
    "normalizedPath": "/dev/posts",
    "pathSegments": [
      "dev",
      "posts"
    ],
    "pageType": "posts"
  },
  "hostInfo": {
    "hostname": "localhost:3000",
    "domainParts": [
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: localhost:3000/dev/posts
Main localhost domain detected, no rewrite needed
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: dev
    - Host: localhost:3000
    - Is subdomain detected: false
    - Original pathname: /posts
[SUBDOMAIN-DEBUG] Path processing:
        - Clean path: posts
        - Path without username: posts
        - Username check: dev
        - Starts with username?: false
[SUBDOMAIN-DEBUG] Page detection:
          - Path segments: [posts]
          - Selected page: posts
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: dev
    - Current page: posts
    - Is subdomain: false
[Posts Page] Request details:
    - Username: dev
    - Host: localhost:3000
    - Is subdomain (detected): false
    - Path: /posts
    - NODE_ENV: development
  
[Firebase Admin] isAdminAvailable() called:
    - adminInitialized: development
    - adminAuth available: false
    - adminDb available: false
    - real admin available: false
    - NODE_ENV: development
    - Project ID: mini-app-00
  
Error: Route "/[username]/posts" used `headers().get('host')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at isAdminAvailable (src/lib/firebase/admin.ts:139:25)
    at UserPostsPage (src/app/[username]/posts/page.tsx:32:40)
  137 |       const { headers } = require('next/headers');
  138 |       const headersList = headers();
> 139 |       host = headersList.get('host') || '';
      |                         ^
  140 |     } else {
  141 |       host = window.location.host;
  142 |     }
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[Firebase Admin] Admin not available but in development mode - allowing demo content
[Posts Page] Admin availability check result: true
[Posts Page] Firebase Admin DB not available but in development mode.
        - Username: dev
        - Host: localhost:3000
        - Is subdomain: false
        - NODE_ENV: development
      
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: posts
[THEME-DEBUG] Navigation context:
        - Username: dev
        - Current page: posts
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: dev's Blog
        - Username: dev
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /dev/
  4. /dev/posts
  5. /dev/about
  6. /dev/post/dev-mode
  7. /dev/post/firebase-admin-nextjs
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: posts
        - Username: dev
        - Is subdomain: false
        - Current page: posts
        - Template context keys: site, posts, navigationContext, content, navigation, userCSS, currentYear
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: dev
    - Is subdomain: false
    - HTML length: 3432
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>dev&#39;s Blog</ti...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /dev/
    /dev/posts
    /dev/about
    /dev/post/dev-mode
    /dev/post/firebase-admin-nextjs
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/dev/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/dev/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/dev/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/dev/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/dev/post/dev-mode"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/dev/post/firebase-admin-nextjs"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/dev/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /dev/themes/altay/theme.css
  3. /dev/
  4. /dev/posts
  5. /dev/about
  6. /dev/post/dev-mode
  7. /dev/post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3574 bytes
 GET /dev/posts 200 in 38ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/post/welcome
    - Hostname: dev.localhost:3000
    - Pathname: /post/welcome
    - Headers: {
  "connection": "keep-alive",
  "host": "dev.localhost:3000",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-forwarded-host": "dev.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "dev",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/post/welcome",
    "normalizedPath": "/post/welcome",
    "pathSegments": [
      "post",
      "welcome"
    ],
    "pageType": "post-single"
  },
  "hostInfo": {
    "hostname": "dev.localhost:3000",
    "domainParts": [
      "dev",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: dev.localhost:3000/post/welcome
[Middleware] Is subdomain check: dev.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Subdomain request detected:
      - Username: dev
      - Original pathname: /post/welcome
      - Is root path: false
[SUBDOMAIN-DEBUG] Rewriting URL:
      - From: http://localhost:3000/post/welcome
      - To pathname: /dev/post/welcome
      - Full new URL: http://localhost:3000/dev/post/welcome
 GET /post/welcome 200 in 46ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/dev/post/welcome
    - Hostname: localhost:3000
    - Pathname: /dev/post/welcome
    - Headers: {
  "connection": "keep-alive",
  "host": "localhost:3000",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "dev",
  "isSubdomain": false,
  "pathInfo": {
    "originalPath": "/dev/post/welcome",
    "normalizedPath": "/dev/post/welcome",
    "pathSegments": [
      "dev",
      "post",
      "welcome"
    ],
    "pageType": "post-single"
  },
  "hostInfo": {
    "hostname": "localhost:3000",
    "domainParts": [
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: localhost:3000/dev/post/welcome
Main localhost domain detected, no rewrite needed
 GET /dev/post/welcome 200 in 53ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/about
    - Hostname: dev.localhost:3000
    - Pathname: /about
    - Headers: {
  "connection": "keep-alive",
  "host": "dev.localhost:3000",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-forwarded-host": "dev.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "dev",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/about",
    "normalizedPath": "/about",
    "pathSegments": [
      "about"
    ],
    "pageType": "about"
  },
  "hostInfo": {
    "hostname": "dev.localhost:3000",
    "domainParts": [
      "dev",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: dev.localhost:3000/about
[Middleware] Is subdomain check: dev.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Subdomain request detected:
      - Username: dev
      - Original pathname: /about
      - Is root path: false
[SUBDOMAIN-DEBUG] Rewriting URL:
      - From: http://localhost:3000/about
      - To pathname: /dev/about
      - Full new URL: http://localhost:3000/dev/about
 GET /about 404 in 41ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/dev/about
    - Hostname: localhost:3000
    - Pathname: /dev/about
    - Headers: {
  "connection": "keep-alive",
  "host": "localhost:3000",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "dev",
  "isSubdomain": false,
  "pathInfo": {
    "originalPath": "/dev/about",
    "normalizedPath": "/dev/about",
    "pathSegments": [
      "dev",
      "about"
    ],
    "pageType": "about"
  },
  "hostInfo": {
    "hostname": "localhost:3000",
    "domainParts": [
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: localhost:3000/dev/about
Main localhost domain detected, no rewrite needed
 GET /dev/about 404 in 50ms
[Firebase Admin] Starting initialization...
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/dev/posts
    - Hostname: localhost:3000
    - Pathname: /dev/posts
    - Headers: {
  "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cache-control": "max-age=0",
  "connection": "keep-alive",
  "cookie": "sidebar:state=true; __next_hmr_refresh_hash__=3b58d3fdfb05da79d5f76bbf8b2d5779633457081244afec; authToken=eyJhbGciOiJSUzI1NiIsImtpZCI6ImZlNjVjY2I4ZWFkMGJhZWY1ZmQzNjE5NWQ2NTI4YTA1NGZiYjc2ZjMiLCJ0eXAiOiJKV1QifQ.eyJuYW1lIjoiRGVtb3VzZXIiLCJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vbWluaS1hcHAtMDAiLCJhdWQiOiJtaW5pLWFwcC0wMCIsImF1dGhfdGltZSI6MTc0ODI4MjIxMiwidXNlcl9pZCI6IjNLWVZtUDhiSkxSVmNKRHdVWHUydzRhblJkdTEiLCJzdWIiOiIzS1lWbVA4YkpMUlZjSkR3VVh1Mnc0YW5SZHUxIiwiaWF0IjoxNzQ4MzcwOTIxLCJleHAiOjE3NDgzNzQ1MjEsImVtYWlsIjoiZGVtb0BnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsImZpcmViYXNlIjp7ImlkZW50aXRpZXMiOnsiZW1haWwiOlsiZGVtb0BnbWFpbC5jb20iXX0sInNpZ25faW5fcHJvdmlkZXIiOiJwYXNzd29yZCJ9fQ.aPnbe2RFyR1kWMutwuzwcES1W4XKFbDP0raCBwQai8PvFbZ9uNRbkiBoMIqaZIpGyNUEefaIK9uoctILpUvA-vOPWr4PhzN0pJ1H3pvVHXVcTX7d6C6Ff13B8fvLaffd9CR0hbLatLxGGvvZDgEe1EfBSe05zY7gV823CQitQUoVJhxxqXhM6aZ-N4979LZKTsocLjMZSt5SOC9n62QWapfhHBb3XA-wjtUm4i9DrmBkFlQxcSLuY4ZDVKfP9ISUfsliKI90fgRNDnkyUE6tDDQBi4wqORuegWjfRjyO8wXwGkUvV1E0MgzPMmO7dCc5I-BTpj-jjuDfw5OpQOZs1g; username=demouser",
  "host": "localhost:3000",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "sec-ch-ua-platform": "\"macOS\"",
  "sec-fetch-dest": "document",
  "sec-fetch-mode": "navigate",
  "sec-fetch-site": "same-origin",
  "sec-fetch-user": "?1",
  "upgrade-insecure-requests": "1",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "dev",
  "isSubdomain": false,
  "pathInfo": {
    "originalPath": "/dev/posts",
    "normalizedPath": "/dev/posts",
    "pathSegments": [
      "dev",
      "posts"
    ],
    "pageType": "posts"
  },
  "hostInfo": {
    "hostname": "localhost:3000",
    "domainParts": [
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: localhost:3000/dev/posts
Main localhost domain detected, no rewrite needed
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: dev
    - Host: localhost:3000
    - Is subdomain detected: false
    - Original pathname: /posts
[SUBDOMAIN-DEBUG] Path processing:
        - Clean path: posts
        - Path without username: posts
        - Username check: dev
        - Starts with username?: false
[SUBDOMAIN-DEBUG] Page detection:
          - Path segments: [posts]
          - Selected page: posts
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: dev
    - Current page: posts
    - Is subdomain: false
[Posts Page] Request details:
    - Username: dev
    - Host: localhost:3000
    - Is subdomain (detected): false
    - Path: /posts
    - NODE_ENV: development
  
[Firebase Admin] isAdminAvailable() called:
    - adminInitialized: development
    - adminAuth available: false
    - adminDb available: false
    - real admin available: false
    - NODE_ENV: development
    - Project ID: mini-app-00
  
Error: Route "/[username]/posts" used `headers().get('host')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at isAdminAvailable (src/lib/firebase/admin.ts:139:25)
    at UserPostsPage (src/app/[username]/posts/page.tsx:32:40)
  137 |       const { headers } = require('next/headers');
  138 |       const headersList = headers();
> 139 |       host = headersList.get('host') || '';
      |                         ^
  140 |     } else {
  141 |       host = window.location.host;
  142 |     }
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[Firebase Admin] Admin not available but in development mode - allowing demo content
[Posts Page] Admin availability check result: true
[Posts Page] Firebase Admin DB not available but in development mode.
        - Username: dev
        - Host: localhost:3000
        - Is subdomain: false
        - NODE_ENV: development
      
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: posts
[THEME-DEBUG] Navigation context:
        - Username: dev
        - Current page: posts
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: dev's Blog
        - Username: dev
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /dev/
  4. /dev/posts
  5. /dev/about
  6. /dev/post/dev-mode
  7. /dev/post/firebase-admin-nextjs
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: posts
        - Username: dev
        - Is subdomain: false
        - Current page: posts
        - Template context keys: site, posts, navigationContext, content, navigation, userCSS, currentYear
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: dev
    - Is subdomain: false
    - HTML length: 3432
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>dev&#39;s Blog</ti...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /dev/
    /dev/posts
    /dev/about
    /dev/post/dev-mode
    /dev/post/firebase-admin-nextjs
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/dev/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/dev/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/dev/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/dev/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/dev/post/dev-mode"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/dev/post/firebase-admin-nextjs"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/dev/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /dev/themes/altay/theme.css
  3. /dev/
  4. /dev/posts
  5. /dev/about
  6. /dev/post/dev-mode
  7. /dev/post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3574 bytes
 GET /dev/posts 200 in 114ms
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: favicon.ico
    - Host header: localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: not set
    - X-Minispace-Original-Host: not set
    - X-Minispace-Username: not set
    - All headers: {
  "host": "localhost:3000",
  "connection": "keep-alive",
  "sec-ch-ua-platform": "\"macOS\"",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "accept": "image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8",
  "sec-fetch-site": "same-origin",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-dest": "image",
  "referer": "http://localhost:3000/dev/posts",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cookie": "sidebar:state=true; __next_hmr_refresh_hash__=3b58d3fdfb05da79d5f76bbf8b2d5779633457081244afec; authToken=eyJhbGciOiJSUzI1NiIsImtpZCI6ImZlNjVjY2I4ZWFkMGJhZWY1ZmQzNjE5NWQ2NTI4YTA1NGZiYjc2ZjMiLCJ0eXAiOiJKV1QifQ.eyJuYW1lIjoiRGVtb3VzZXIiLCJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vbWluaS1hcHAtMDAiLCJhdWQiOiJtaW5pLWFwcC0wMCIsImF1dGhfdGltZSI6MTc0ODI4MjIxMiwidXNlcl9pZCI6IjNLWVZtUDhiSkxSVmNKRHdVWHUydzRhblJkdTEiLCJzdWIiOiIzS1lWbVA4YkpMUlZjSkR3VVh1Mnc0YW5SZHUxIiwiaWF0IjoxNzQ4MzcwOTIxLCJleHAiOjE3NDgzNzQ1MjEsImVtYWlsIjoiZGVtb0BnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsImZpcmViYXNlIjp7ImlkZW50aXRpZXMiOnsiZW1haWwiOlsiZGVtb0BnbWFpbC5jb20iXX0sInNpZ25faW5fcHJvdmlkZXIiOiJwYXNzd29yZCJ9fQ.aPnbe2RFyR1kWMutwuzwcES1W4XKFbDP0raCBwQai8PvFbZ9uNRbkiBoMIqaZIpGyNUEefaIK9uoctILpUvA-vOPWr4PhzN0pJ1H3pvVHXVcTX7d6C6Ff13B8fvLaffd9CR0hbLatLxGGvvZDgEe1EfBSe05zY7gV823CQitQUoVJhxxqXhM6aZ-N4979LZKTsocLjMZSt5SOC9n62QWapfhHBb3XA-wjtUm4i9DrmBkFlQxcSLuY4ZDVKfP9ISUfsliKI90fgRNDnkyUE6tDDQBi4wqORuegWjfRjyO8wXwGkUvV1E0MgzPMmO7dCc5I-BTpj-jjuDfw5OpQOZs1g; username=demouser",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::1"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: favicon.ico
    - Host: localhost:3000
    - Is subdomain detected: false
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: favicon.ico
    - Current page: home
    - Is subdomain: false
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: favicon.ico
    - Is subdomain: false
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for favicon.ico
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: favicon.ico
        - Current page: home
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: Favicon.ico
        - Username: favicon.ico
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: favicon.ico
        - Is subdomain: false
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: favicon.ico
    - Is subdomain: false
    - HTML length: 3972
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Favicon.ico</title...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /favicon.ico/
    /favicon.ico/posts
    /favicon.ico/about
    /favicon.ico/post/welcome
    /favicon.ico/post/getting-started
    /favicon.ico/posts
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/favicon.ico/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/welcome"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/getting-started"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/favicon.ico/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /favicon.ico/themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4129 bytes
 GET /favicon.ico 200 in 129ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/dev/themes/altay/theme.css
    - Hostname: localhost:3000
    - Pathname: /dev/themes/altay/theme.css
    - Headers: {
  "accept": "text/css,*/*;q=0.1",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "connection": "keep-alive",
  "cookie": "sidebar:state=true; __next_hmr_refresh_hash__=3b58d3fdfb05da79d5f76bbf8b2d5779633457081244afec; username=demouser; authToken=eyJhbGciOiJSUzI1NiIsImtpZCI6ImZlNjVjY2I4ZWFkMGJhZWY1ZmQzNjE5NWQ2NTI4YTA1NGZiYjc2ZjMiLCJ0eXAiOiJKV1QifQ.eyJuYW1lIjoiRGVtb3VzZXIiLCJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vbWluaS1hcHAtMDAiLCJhdWQiOiJtaW5pLWFwcC0wMCIsImF1dGhfdGltZSI6MTc0ODI4MjIxMiwidXNlcl9pZCI6IjNLWVZtUDhiSkxSVmNKRHdVWHUydzRhblJkdTEiLCJzdWIiOiIzS1lWbVA4YkpMUlZjSkR3VVh1Mnc0YW5SZHUxIiwiaWF0IjoxNzQ4MzcxMDEwLCJleHAiOjE3NDgzNzQ2MTAsImVtYWlsIjoiZGVtb0BnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsImZpcmViYXNlIjp7ImlkZW50aXRpZXMiOnsiZW1haWwiOlsiZGVtb0BnbWFpbC5jb20iXX0sInNpZ25faW5fcHJvdmlkZXIiOiJwYXNzd29yZCJ9fQ.DA27WC4tShtiIDiVKx-ShqQctCZpkHB0XaFbXJUv17vqP1HDzYfhxA4hVkrpiKw-0kHqgJqzuglY0FkXuPYxsb19lT4VZlIsgtUhHZscJjL44m82QlGDPfvaQ5M2nmzkyuuL4ez7DMrLDrnizoJubyLq-3l4abuQ2bb1_PzRu6AR7ikTcFgaZmAqAPFb1qdXY9ytcM_aDFogcZeL0isDMr8OLykNw92z6l5bUT6Io68sX7arC0l-wMq-0gcdZPPIHsAthmHryueg7UjuGkIx2llmTIDjm_CAWw4L0_zEZq-HPvaRVBwjDsuu_j0gCqRQGolmd8a8XvhPoYpfBM0tYg",
  "host": "localhost:3000",
  "referer": "http://localhost:3000/dev/posts",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "sec-ch-ua-platform": "\"macOS\"",
  "sec-fetch-dest": "style",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-site": "same-origin",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "dev",
  "isSubdomain": false,
  "pathInfo": {
    "originalPath": "/dev/themes/altay/theme.css",
    "normalizedPath": "/dev/themes/altay/theme.css",
    "pathSegments": [
      "dev",
      "themes",
      "altay",
      "theme.css"
    ],
    "pageType": "themes"
  },
  "hostInfo": {
    "hostname": "localhost:3000",
    "domainParts": [
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
[Firebase Admin] Starting initialization...
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
[Firebase Admin] Starting initialization...
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: favicon.ico
    - Host header: localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: not set
    - X-Minispace-Original-Host: not set
    - X-Minispace-Username: not set
    - All headers: {
  "host": "localhost:3000",
  "connection": "keep-alive",
  "sec-ch-ua-platform": "\"macOS\"",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "accept": "image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8",
  "sec-fetch-site": "same-origin",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-dest": "image",
  "referer": "http://localhost:3000/dev/posts",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cookie": "sidebar:state=true; __next_hmr_refresh_hash__=3b58d3fdfb05da79d5f76bbf8b2d5779633457081244afec; username=demouser; authToken=eyJhbGciOiJSUzI1NiIsImtpZCI6ImZlNjVjY2I4ZWFkMGJhZWY1ZmQzNjE5NWQ2NTI4YTA1NGZiYjc2ZjMiLCJ0eXAiOiJKV1QifQ.eyJuYW1lIjoiRGVtb3VzZXIiLCJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vbWluaS1hcHAtMDAiLCJhdWQiOiJtaW5pLWFwcC0wMCIsImF1dGhfdGltZSI6MTc0ODI4MjIxMiwidXNlcl9pZCI6IjNLWVZtUDhiSkxSVmNKRHdVWHUydzRhblJkdTEiLCJzdWIiOiIzS1lWbVA4YkpMUlZjSkR3VVh1Mnc0YW5SZHUxIiwiaWF0IjoxNzQ4MzcxMDEwLCJleHAiOjE3NDgzNzQ2MTAsImVtYWlsIjoiZGVtb0BnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsImZpcmViYXNlIjp7ImlkZW50aXRpZXMiOnsiZW1haWwiOlsiZGVtb0BnbWFpbC5jb20iXX0sInNpZ25faW5fcHJvdmlkZXIiOiJwYXNzd29yZCJ9fQ.DA27WC4tShtiIDiVKx-ShqQctCZpkHB0XaFbXJUv17vqP1HDzYfhxA4hVkrpiKw-0kHqgJqzuglY0FkXuPYxsb19lT4VZlIsgtUhHZscJjL44m82QlGDPfvaQ5M2nmzkyuuL4ez7DMrLDrnizoJubyLq-3l4abuQ2bb1_PzRu6AR7ikTcFgaZmAqAPFb1qdXY9ytcM_aDFogcZeL0isDMr8OLykNw92z6l5bUT6Io68sX7arC0l-wMq-0gcdZPPIHsAthmHryueg7UjuGkIx2llmTIDjm_CAWw4L0_zEZq-HPvaRVBwjDsuu_j0gCqRQGolmd8a8XvhPoYpfBM0tYg",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::1"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: favicon.ico
    - Host: localhost:3000
    - Is subdomain detected: false
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: favicon.ico
    - Current page: home
    - Is subdomain: false
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: favicon.ico
    - Is subdomain: false
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for favicon.ico
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: favicon.ico
        - Current page: home
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: Favicon.ico
        - Username: favicon.ico
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: favicon.ico
        - Is subdomain: false
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: favicon.ico
    - Is subdomain: false
    - HTML length: 3972
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Favicon.ico</title...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /favicon.ico/
    /favicon.ico/posts
    /favicon.ico/about
    /favicon.ico/post/welcome
    /favicon.ico/post/getting-started
    /favicon.ico/posts
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/favicon.ico/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/welcome"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/getting-started"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/favicon.ico/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /favicon.ico/themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4129 bytes
 GET /dev/themes/altay/theme.css 404 in 586ms
 GET /favicon.ico 200 in 582ms
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: favicon.ico
    - Host header: localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: not set
    - X-Minispace-Original-Host: not set
    - X-Minispace-Username: not set
    - All headers: {
  "host": "localhost:3000",
  "connection": "keep-alive",
  "sec-ch-ua-platform": "\"macOS\"",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "accept": "image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8",
  "sec-fetch-site": "same-origin",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-dest": "image",
  "referer": "http://localhost:3000/dev/posts",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cookie": "sidebar:state=true; __next_hmr_refresh_hash__=3b58d3fdfb05da79d5f76bbf8b2d5779633457081244afec; username=demouser; authToken=eyJhbGciOiJSUzI1NiIsImtpZCI6ImZlNjVjY2I4ZWFkMGJhZWY1ZmQzNjE5NWQ2NTI4YTA1NGZiYjc2ZjMiLCJ0eXAiOiJKV1QifQ.eyJuYW1lIjoiRGVtb3VzZXIiLCJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vbWluaS1hcHAtMDAiLCJhdWQiOiJtaW5pLWFwcC0wMCIsImF1dGhfdGltZSI6MTc0ODI4MjIxMiwidXNlcl9pZCI6IjNLWVZtUDhiSkxSVmNKRHdVWHUydzRhblJkdTEiLCJzdWIiOiIzS1lWbVA4YkpMUlZjSkR3VVh1Mnc0YW5SZHUxIiwiaWF0IjoxNzQ4MzcxMDEwLCJleHAiOjE3NDgzNzQ2MTAsImVtYWlsIjoiZGVtb0BnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsImZpcmViYXNlIjp7ImlkZW50aXRpZXMiOnsiZW1haWwiOlsiZGVtb0BnbWFpbC5jb20iXX0sInNpZ25faW5fcHJvdmlkZXIiOiJwYXNzd29yZCJ9fQ.DA27WC4tShtiIDiVKx-ShqQctCZpkHB0XaFbXJUv17vqP1HDzYfhxA4hVkrpiKw-0kHqgJqzuglY0FkXuPYxsb19lT4VZlIsgtUhHZscJjL44m82QlGDPfvaQ5M2nmzkyuuL4ez7DMrLDrnizoJubyLq-3l4abuQ2bb1_PzRu6AR7ikTcFgaZmAqAPFb1qdXY9ytcM_aDFogcZeL0isDMr8OLykNw92z6l5bUT6Io68sX7arC0l-wMq-0gcdZPPIHsAthmHryueg7UjuGkIx2llmTIDjm_CAWw4L0_zEZq-HPvaRVBwjDsuu_j0gCqRQGolmd8a8XvhPoYpfBM0tYg",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::1"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: favicon.ico
    - Host: localhost:3000
    - Is subdomain detected: false
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: favicon.ico
    - Current page: home
    - Is subdomain: false
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: favicon.ico
    - Is subdomain: false
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for favicon.ico
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: favicon.ico
        - Current page: home
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: Favicon.ico
        - Username: favicon.ico
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: favicon.ico
        - Is subdomain: false
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: favicon.ico
    - Is subdomain: false
    - HTML length: 3972
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Favicon.ico</title...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /favicon.ico/
    /favicon.ico/posts
    /favicon.ico/about
    /favicon.ico/post/welcome
    /favicon.ico/post/getting-started
    /favicon.ico/posts
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/favicon.ico/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/welcome"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/getting-started"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/favicon.ico/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /favicon.ico/themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4129 bytes
 GET /favicon.ico 200 in 59ms
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: favicon.ico
    - Host header: localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: not set
    - X-Minispace-Original-Host: not set
    - X-Minispace-Username: not set
    - All headers: {
  "host": "localhost:3000",
  "connection": "keep-alive",
  "sec-ch-ua-platform": "\"macOS\"",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "accept": "image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8",
  "sec-fetch-site": "same-origin",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-dest": "image",
  "referer": "http://localhost:3000/dev/posts",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cookie": "sidebar:state=true; __next_hmr_refresh_hash__=3b58d3fdfb05da79d5f76bbf8b2d5779633457081244afec; username=demouser; authToken=eyJhbGciOiJSUzI1NiIsImtpZCI6ImZlNjVjY2I4ZWFkMGJhZWY1ZmQzNjE5NWQ2NTI4YTA1NGZiYjc2ZjMiLCJ0eXAiOiJKV1QifQ.eyJuYW1lIjoiRGVtb3VzZXIiLCJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vbWluaS1hcHAtMDAiLCJhdWQiOiJtaW5pLWFwcC0wMCIsImF1dGhfdGltZSI6MTc0ODI4MjIxMiwidXNlcl9pZCI6IjNLWVZtUDhiSkxSVmNKRHdVWHUydzRhblJkdTEiLCJzdWIiOiIzS1lWbVA4YkpMUlZjSkR3VVh1Mnc0YW5SZHUxIiwiaWF0IjoxNzQ4MzcxMDEwLCJleHAiOjE3NDgzNzQ2MTAsImVtYWlsIjoiZGVtb0BnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsImZpcmViYXNlIjp7ImlkZW50aXRpZXMiOnsiZW1haWwiOlsiZGVtb0BnbWFpbC5jb20iXX0sInNpZ25faW5fcHJvdmlkZXIiOiJwYXNzd29yZCJ9fQ.DA27WC4tShtiIDiVKx-ShqQctCZpkHB0XaFbXJUv17vqP1HDzYfhxA4hVkrpiKw-0kHqgJqzuglY0FkXuPYxsb19lT4VZlIsgtUhHZscJjL44m82QlGDPfvaQ5M2nmzkyuuL4ez7DMrLDrnizoJubyLq-3l4abuQ2bb1_PzRu6AR7ikTcFgaZmAqAPFb1qdXY9ytcM_aDFogcZeL0isDMr8OLykNw92z6l5bUT6Io68sX7arC0l-wMq-0gcdZPPIHsAthmHryueg7UjuGkIx2llmTIDjm_CAWw4L0_zEZq-HPvaRVBwjDsuu_j0gCqRQGolmd8a8XvhPoYpfBM0tYg",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::1"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: favicon.ico
    - Host: localhost:3000
    - Is subdomain detected: false
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: favicon.ico
    - Current page: home
    - Is subdomain: false
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: favicon.ico
    - Is subdomain: false
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for favicon.ico
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: favicon.ico
        - Current page: home
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: Favicon.ico
        - Username: favicon.ico
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: favicon.ico
        - Is subdomain: false
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: favicon.ico
    - Is subdomain: false
    - HTML length: 3972
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Favicon.ico</title...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /favicon.ico/
    /favicon.ico/posts
    /favicon.ico/about
    /favicon.ico/post/welcome
    /favicon.ico/post/getting-started
    /favicon.ico/posts
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/favicon.ico/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/welcome"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/getting-started"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/favicon.ico/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /favicon.ico/themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4129 bytes
 GET /favicon.ico 200 in 55ms
[Firebase Admin] Starting initialization...
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/
    - Hostname: demouser.localhost:3000
    - Pathname: /
    - Headers: {
  "connection": "keep-alive",
  "host": "demouser.localhost:3000",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "demouser",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/",
    "normalizedPath": "/",
    "pathSegments": [],
    "pageType": "home"
  },
  "hostInfo": {
    "hostname": "demouser.localhost:3000",
    "domainParts": [
      "demouser",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: demouser.localhost:3000/
[Middleware] Is subdomain check: demouser.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Subdomain request detected:
      - Username: demouser
      - Original pathname: /
      - Is root path: true
[SUBDOMAIN-DEBUG] Rewriting URL:
      - From: http://localhost:3000/
      - To pathname: /demouser
      - Full new URL: http://localhost:3000/demouser
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: demouser
    - Host header: demouser.localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: true
    - X-Minispace-Original-Host: demouser.localhost:3000
    - X-Minispace-Username: demouser
    - All headers: {
  "host": "demouser.localhost:3000",
  "connection": "keep-alive",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-minispace-original-host": "demouser.localhost:3000",
  "x-minispace-path-analysis": "{\"originalPath\":\"/\",\"normalizedPath\":\"/\",\"pageType\":\"home\"}",
  "x-minispace-rewritten-from-subdomain": "true",
  "x-minispace-username": "demouser"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: demouser
    - Host: demouser.localhost:3000
    - Is subdomain detected: true
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: demouser
    - Current page: home
    - Is subdomain: true
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: demouser
    - Is subdomain: true
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for demouser
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: demouser
        - Current page: home
        - Is subdomain: true
      
[THEME-DEBUG] Site context:
        - Title: Demouser
        - Username: demouser
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/welcome
  7. /post/getting-started
  8. /posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-render)
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: demouser
        - Is subdomain: true
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: demouser
    - Is subdomain: true
    - HTML length: 3882
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Demouser</title>
 ...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /
    /posts
    /about
    /post/welcome
    /post/getting-started
    /posts
[SUBDOMAIN-DEBUG] Subdomain mode - transforming username-prefixed links to relative links
    - Username pattern: /href="\/demouser(\/[^"]*|\/?)?"/g
[SUBDOMAIN-DEBUG] Links after subdomain transformation:
      []
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/welcome
  7. /post/getting-started
  8. /posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4023 bytes
 GET / 200 in 108ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/posts
    - Hostname: demouser.localhost:3000
    - Pathname: /posts
    - Headers: {
  "connection": "keep-alive",
  "host": "demouser.localhost:3000",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "demouser",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/posts",
    "normalizedPath": "/posts",
    "pathSegments": [
      "posts"
    ],
    "pageType": "posts"
  },
  "hostInfo": {
    "hostname": "demouser.localhost:3000",
    "domainParts": [
      "demouser",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: demouser.localhost:3000/posts
[Middleware] Is subdomain check: demouser.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Subdomain request detected:
      - Username: demouser
      - Original pathname: /posts
      - Is root path: false
[SUBDOMAIN-DEBUG] Rewriting URL:
      - From: http://localhost:3000/posts
      - To pathname: /demouser/posts
      - Full new URL: http://localhost:3000/demouser/posts
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: demouser
    - Host: demouser.localhost:3000
    - Is subdomain detected: true
    - Original pathname: /posts
[SUBDOMAIN-DEBUG] Path processing:
        - Clean path: posts
        - Path without username: posts
        - Username check: demouser
        - Starts with username?: false
[SUBDOMAIN-DEBUG] Page detection:
          - Path segments: [posts]
          - Selected page: posts
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: demouser
    - Current page: posts
    - Is subdomain: true
[Posts Page] Request details:
    - Username: demouser
    - Host: demouser.localhost:3000
    - Is subdomain (detected): true
    - Path: /posts
    - NODE_ENV: development
  
[Firebase Admin] isAdminAvailable() called:
    - adminInitialized: development
    - adminAuth available: false
    - adminDb available: false
    - real admin available: false
    - NODE_ENV: development
    - Project ID: mini-app-00
  
Error: Route "/[username]/posts" used `headers().get('host')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at isAdminAvailable (src/lib/firebase/admin.ts:139:25)
    at UserPostsPage (src/app/[username]/posts/page.tsx:32:40)
  137 |       const { headers } = require('next/headers');
  138 |       const headersList = headers();
> 139 |       host = headersList.get('host') || '';
      |                         ^
  140 |     } else {
  141 |       host = window.location.host;
  142 |     }
[Firebase Admin] Detected subdomain request on host: demouser.localhost:3000
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[Firebase Admin] Admin not available but in development mode - allowing demo content
[Posts Page] Admin availability check result: true
[Posts Page] Firebase Admin DB not available but in development mode.
        - Username: demouser
        - Host: demouser.localhost:3000
        - Is subdomain: true
        - NODE_ENV: development
      
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: posts
[THEME-DEBUG] Navigation context:
        - Username: demouser
        - Current page: posts
        - Is subdomain: true
      
[THEME-DEBUG] Site context:
        - Title: demouser's Blog
        - Username: demouser
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/dev-mode
  7. /post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-render)
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: posts
        - Username: demouser
        - Is subdomain: true
        - Current page: posts
        - Template context keys: site, posts, navigationContext, content, navigation, userCSS, currentYear
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: demouser
    - Is subdomain: true
    - HTML length: 3432
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>demouser&#39;s Blo...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /
    /posts
    /about
    /post/dev-mode
    /post/firebase-admin-nextjs
[SUBDOMAIN-DEBUG] Subdomain mode - transforming username-prefixed links to relative links
    - Username pattern: /href="\/demouser(\/[^"]*|\/?)?"/g
[SUBDOMAIN-DEBUG] Links after subdomain transformation:
      []
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/dev-mode
  7. /post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3574 bytes
 GET /posts 200 in 73ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/demouser/posts
    - Hostname: localhost:3000
    - Pathname: /demouser/posts
    - Headers: {
  "connection": "keep-alive",
  "host": "localhost:3000",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "demouser",
  "isSubdomain": false,
  "pathInfo": {
    "originalPath": "/demouser/posts",
    "normalizedPath": "/demouser/posts",
    "pathSegments": [
      "demouser",
      "posts"
    ],
    "pageType": "posts"
  },
  "hostInfo": {
    "hostname": "localhost:3000",
    "domainParts": [
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: localhost:3000/demouser/posts
Main localhost domain detected, no rewrite needed
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: demouser
    - Host: localhost:3000
    - Is subdomain detected: false
    - Original pathname: /posts
[SUBDOMAIN-DEBUG] Path processing:
        - Clean path: posts
        - Path without username: posts
        - Username check: demouser
        - Starts with username?: false
[SUBDOMAIN-DEBUG] Page detection:
          - Path segments: [posts]
          - Selected page: posts
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: demouser
    - Current page: posts
    - Is subdomain: false
[Posts Page] Request details:
    - Username: demouser
    - Host: localhost:3000
    - Is subdomain (detected): false
    - Path: /posts
    - NODE_ENV: development
  
[Firebase Admin] isAdminAvailable() called:
    - adminInitialized: development
    - adminAuth available: false
    - adminDb available: false
    - real admin available: false
    - NODE_ENV: development
    - Project ID: mini-app-00
  
Error: Route "/[username]/posts" used `headers().get('host')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at isAdminAvailable (src/lib/firebase/admin.ts:139:25)
    at UserPostsPage (src/app/[username]/posts/page.tsx:32:40)
  137 |       const { headers } = require('next/headers');
  138 |       const headersList = headers();
> 139 |       host = headersList.get('host') || '';
      |                         ^
  140 |     } else {
  141 |       host = window.location.host;
  142 |     }
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[Firebase Admin] Admin not available but in development mode - allowing demo content
[Posts Page] Admin availability check result: true
[Posts Page] Firebase Admin DB not available but in development mode.
        - Username: demouser
        - Host: localhost:3000
        - Is subdomain: false
        - NODE_ENV: development
      
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: posts
[THEME-DEBUG] Navigation context:
        - Username: demouser
        - Current page: posts
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: demouser's Blog
        - Username: demouser
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /demouser/
  4. /demouser/posts
  5. /demouser/about
  6. /demouser/post/dev-mode
  7. /demouser/post/firebase-admin-nextjs
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: posts
        - Username: demouser
        - Is subdomain: false
        - Current page: posts
        - Template context keys: site, posts, navigationContext, content, navigation, userCSS, currentYear
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: demouser
    - Is subdomain: false
    - HTML length: 3477
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>demouser&#39;s Blo...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /demouser/
    /demouser/posts
    /demouser/about
    /demouser/post/dev-mode
    /demouser/post/firebase-admin-nextjs
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/demouser/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/demouser/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/demouser/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/demouser/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/demouser/post/dev-mode"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/demouser/post/firebase-admin-nextjs"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/demouser/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /demouser/themes/altay/theme.css
  3. /demouser/
  4. /demouser/posts
  5. /demouser/about
  6. /demouser/post/dev-mode
  7. /demouser/post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3629 bytes
 GET /demouser/posts 200 in 79ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/post/welcome
    - Hostname: demouser.localhost:3000
    - Pathname: /post/welcome
    - Headers: {
  "connection": "keep-alive",
  "host": "demouser.localhost:3000",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "demouser",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/post/welcome",
    "normalizedPath": "/post/welcome",
    "pathSegments": [
      "post",
      "welcome"
    ],
    "pageType": "post-single"
  },
  "hostInfo": {
    "hostname": "demouser.localhost:3000",
    "domainParts": [
      "demouser",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: demouser.localhost:3000/post/welcome
[Middleware] Is subdomain check: demouser.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Subdomain request detected:
      - Username: demouser
      - Original pathname: /post/welcome
      - Is root path: false
[SUBDOMAIN-DEBUG] Rewriting URL:
      - From: http://localhost:3000/post/welcome
      - To pathname: /demouser/post/welcome
      - Full new URL: http://localhost:3000/demouser/post/welcome
 GET /post/welcome 200 in 86ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/demouser/post/welcome
    - Hostname: localhost:3000
    - Pathname: /demouser/post/welcome
    - Headers: {
  "connection": "keep-alive",
  "host": "localhost:3000",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "demouser",
  "isSubdomain": false,
  "pathInfo": {
    "originalPath": "/demouser/post/welcome",
    "normalizedPath": "/demouser/post/welcome",
    "pathSegments": [
      "demouser",
      "post",
      "welcome"
    ],
    "pageType": "post-single"
  },
  "hostInfo": {
    "hostname": "localhost:3000",
    "domainParts": [
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: localhost:3000/demouser/post/welcome
Main localhost domain detected, no rewrite needed
 GET /demouser/post/welcome 200 in 125ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/about
    - Hostname: demouser.localhost:3000
    - Pathname: /about
    - Headers: {
  "connection": "keep-alive",
  "host": "demouser.localhost:3000",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "demouser",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/about",
    "normalizedPath": "/about",
    "pathSegments": [
      "about"
    ],
    "pageType": "about"
  },
  "hostInfo": {
    "hostname": "demouser.localhost:3000",
    "domainParts": [
      "demouser",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: demouser.localhost:3000/about
[Middleware] Is subdomain check: demouser.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Subdomain request detected:
      - Username: demouser
      - Original pathname: /about
      - Is root path: false
[SUBDOMAIN-DEBUG] Rewriting URL:
      - From: http://localhost:3000/about
      - To pathname: /demouser/about
      - Full new URL: http://localhost:3000/demouser/about
 GET /about 404 in 76ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/demouser/about
    - Hostname: localhost:3000
    - Pathname: /demouser/about
    - Headers: {
  "connection": "keep-alive",
  "host": "localhost:3000",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "demouser",
  "isSubdomain": false,
  "pathInfo": {
    "originalPath": "/demouser/about",
    "normalizedPath": "/demouser/about",
    "pathSegments": [
      "demouser",
      "about"
    ],
    "pageType": "about"
  },
  "hostInfo": {
    "hostname": "localhost:3000",
    "domainParts": [
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: localhost:3000/demouser/about
Main localhost domain detected, no rewrite needed
 GET /demouser/about 404 in 71ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/
    - Hostname: test.localhost:3000
    - Pathname: /
    - Headers: {
  "connection": "keep-alive",
  "host": "test.localhost:3000",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-forwarded-host": "test.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "test",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/",
    "normalizedPath": "/",
    "pathSegments": [],
    "pageType": "home"
  },
  "hostInfo": {
    "hostname": "test.localhost:3000",
    "domainParts": [
      "test",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: test.localhost:3000/
[Middleware] Is subdomain check: test.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Subdomain request detected:
      - Username: test
      - Original pathname: /
      - Is root path: true
[SUBDOMAIN-DEBUG] Rewriting URL:
      - From: http://localhost:3000/
      - To pathname: /test
      - Full new URL: http://localhost:3000/test
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: test
    - Host header: test.localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: true
    - X-Minispace-Original-Host: test.localhost:3000
    - X-Minispace-Username: test
    - All headers: {
  "host": "test.localhost:3000",
  "connection": "keep-alive",
  "x-forwarded-host": "test.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-minispace-original-host": "test.localhost:3000",
  "x-minispace-path-analysis": "{\"originalPath\":\"/\",\"normalizedPath\":\"/\",\"pageType\":\"home\"}",
  "x-minispace-rewritten-from-subdomain": "true",
  "x-minispace-username": "test"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: test
    - Host: test.localhost:3000
    - Is subdomain detected: true
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: test
    - Current page: home
    - Is subdomain: true
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: test
    - Is subdomain: true
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for test
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: test
        - Current page: home
        - Is subdomain: true
      
[THEME-DEBUG] Site context:
        - Title: Test
        - Username: test
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/welcome
  7. /post/getting-started
  8. /posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-render)
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: test
        - Is subdomain: true
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: test
    - Is subdomain: true
    - HTML length: 3858
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Test</title>
    <...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /
    /posts
    /about
    /post/welcome
    /post/getting-started
    /posts
[SUBDOMAIN-DEBUG] Subdomain mode - transforming username-prefixed links to relative links
    - Username pattern: /href="\/test(\/[^"]*|\/?)?"/g
[SUBDOMAIN-DEBUG] Links after subdomain transformation:
      []
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/welcome
  7. /post/getting-started
  8. /posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3995 bytes
 GET / 200 in 89ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/posts
    - Hostname: test.localhost:3000
    - Pathname: /posts
    - Headers: {
  "connection": "keep-alive",
  "host": "test.localhost:3000",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-forwarded-host": "test.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "test",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/posts",
    "normalizedPath": "/posts",
    "pathSegments": [
      "posts"
    ],
    "pageType": "posts"
  },
  "hostInfo": {
    "hostname": "test.localhost:3000",
    "domainParts": [
      "test",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: test.localhost:3000/posts
[Middleware] Is subdomain check: test.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Subdomain request detected:
      - Username: test
      - Original pathname: /posts
      - Is root path: false
[SUBDOMAIN-DEBUG] Rewriting URL:
      - From: http://localhost:3000/posts
      - To pathname: /test/posts
      - Full new URL: http://localhost:3000/test/posts
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: test
    - Host: test.localhost:3000
    - Is subdomain detected: true
    - Original pathname: /posts
[SUBDOMAIN-DEBUG] Path processing:
        - Clean path: posts
        - Path without username: posts
        - Username check: test
        - Starts with username?: false
[SUBDOMAIN-DEBUG] Page detection:
          - Path segments: [posts]
          - Selected page: posts
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: test
    - Current page: posts
    - Is subdomain: true
[Posts Page] Request details:
    - Username: test
    - Host: test.localhost:3000
    - Is subdomain (detected): true
    - Path: /posts
    - NODE_ENV: development
  
[Firebase Admin] isAdminAvailable() called:
    - adminInitialized: development
    - adminAuth available: false
    - adminDb available: false
    - real admin available: false
    - NODE_ENV: development
    - Project ID: mini-app-00
  
Error: Route "/[username]/posts" used `headers().get('host')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at isAdminAvailable (src/lib/firebase/admin.ts:139:25)
    at UserPostsPage (src/app/[username]/posts/page.tsx:32:40)
  137 |       const { headers } = require('next/headers');
  138 |       const headersList = headers();
> 139 |       host = headersList.get('host') || '';
      |                         ^
  140 |     } else {
  141 |       host = window.location.host;
  142 |     }
[Firebase Admin] Detected subdomain request on host: test.localhost:3000
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[Firebase Admin] Admin not available but in development mode - allowing demo content
[Posts Page] Admin availability check result: true
[Posts Page] Firebase Admin DB not available but in development mode.
        - Username: test
        - Host: test.localhost:3000
        - Is subdomain: true
        - NODE_ENV: development
      
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: posts
[THEME-DEBUG] Navigation context:
        - Username: test
        - Current page: posts
        - Is subdomain: true
      
[THEME-DEBUG] Site context:
        - Title: test's Blog
        - Username: test
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/dev-mode
  7. /post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-render)
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: posts
        - Username: test
        - Is subdomain: true
        - Current page: posts
        - Template context keys: site, posts, navigationContext, content, navigation, userCSS, currentYear
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: test
    - Is subdomain: true
    - HTML length: 3416
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>test&#39;s Blog</t...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /
    /posts
    /about
    /post/dev-mode
    /post/firebase-admin-nextjs
[SUBDOMAIN-DEBUG] Subdomain mode - transforming username-prefixed links to relative links
    - Username pattern: /href="\/test(\/[^"]*|\/?)?"/g
[SUBDOMAIN-DEBUG] Links after subdomain transformation:
      []
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/dev-mode
  7. /post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3554 bytes
[Firebase Admin] Starting initialization...
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
[Firebase Admin] Starting initialization...
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
 GET /posts 200 in 62ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/test/posts
    - Hostname: localhost:3000
    - Pathname: /test/posts
    - Headers: {
  "connection": "keep-alive",
  "host": "localhost:3000",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "test",
  "isSubdomain": false,
  "pathInfo": {
    "originalPath": "/test/posts",
    "normalizedPath": "/test/posts",
    "pathSegments": [
      "test",
      "posts"
    ],
    "pageType": "posts"
  },
  "hostInfo": {
    "hostname": "localhost:3000",
    "domainParts": [
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: localhost:3000/test/posts
Main localhost domain detected, no rewrite needed
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: test
    - Host: localhost:3000
    - Is subdomain detected: false
    - Original pathname: /posts
[SUBDOMAIN-DEBUG] Path processing:
        - Clean path: posts
        - Path without username: posts
        - Username check: test
        - Starts with username?: false
[SUBDOMAIN-DEBUG] Page detection:
          - Path segments: [posts]
          - Selected page: posts
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: test
    - Current page: posts
    - Is subdomain: false
[Posts Page] Request details:
    - Username: test
    - Host: localhost:3000
    - Is subdomain (detected): false
    - Path: /posts
    - NODE_ENV: development
  
[Firebase Admin] isAdminAvailable() called:
    - adminInitialized: development
    - adminAuth available: false
    - adminDb available: false
    - real admin available: false
    - NODE_ENV: development
    - Project ID: mini-app-00
  
Error: Route "/[username]/posts" used `headers().get('host')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at isAdminAvailable (src/lib/firebase/admin.ts:139:25)
    at UserPostsPage (src/app/[username]/posts/page.tsx:32:40)
  137 |       const { headers } = require('next/headers');
  138 |       const headersList = headers();
> 139 |       host = headersList.get('host') || '';
      |                         ^
  140 |     } else {
  141 |       host = window.location.host;
  142 |     }
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[Firebase Admin] Admin not available but in development mode - allowing demo content
[Posts Page] Admin availability check result: true
[Posts Page] Firebase Admin DB not available but in development mode.
        - Username: test
        - Host: localhost:3000
        - Is subdomain: false
        - NODE_ENV: development
      
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: posts
[THEME-DEBUG] Navigation context:
        - Username: test
        - Current page: posts
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: test's Blog
        - Username: test
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /test/
  4. /test/posts
  5. /test/about
  6. /test/post/dev-mode
  7. /test/post/firebase-admin-nextjs
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: posts
        - Username: test
        - Is subdomain: false
        - Current page: posts
        - Template context keys: site, posts, navigationContext, content, navigation, userCSS, currentYear
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: test
    - Is subdomain: false
    - HTML length: 3441
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>test&#39;s Blog</t...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /test/
    /test/posts
    /test/about
    /test/post/dev-mode
    /test/post/firebase-admin-nextjs
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/test/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/test/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/test/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/test/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/test/post/dev-mode"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/test/post/firebase-admin-nextjs"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/test/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /test/themes/altay/theme.css
  3. /test/
  4. /test/posts
  5. /test/about
  6. /test/post/dev-mode
  7. /test/post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3585 bytes
 GET /test/posts 200 in 43ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/post/welcome
    - Hostname: test.localhost:3000
    - Pathname: /post/welcome
    - Headers: {
  "connection": "keep-alive",
  "host": "test.localhost:3000",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-forwarded-host": "test.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "test",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/post/welcome",
    "normalizedPath": "/post/welcome",
    "pathSegments": [
      "post",
      "welcome"
    ],
    "pageType": "post-single"
  },
  "hostInfo": {
    "hostname": "test.localhost:3000",
    "domainParts": [
      "test",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: test.localhost:3000/post/welcome
[Middleware] Is subdomain check: test.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Subdomain request detected:
      - Username: test
      - Original pathname: /post/welcome
      - Is root path: false
[SUBDOMAIN-DEBUG] Rewriting URL:
      - From: http://localhost:3000/post/welcome
      - To pathname: /test/post/welcome
      - Full new URL: http://localhost:3000/test/post/welcome
 GET /post/welcome 200 in 65ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/test/post/welcome
    - Hostname: localhost:3000
    - Pathname: /test/post/welcome
    - Headers: {
  "connection": "keep-alive",
  "host": "localhost:3000",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "test",
  "isSubdomain": false,
  "pathInfo": {
    "originalPath": "/test/post/welcome",
    "normalizedPath": "/test/post/welcome",
    "pathSegments": [
      "test",
      "post",
      "welcome"
    ],
    "pageType": "post-single"
  },
  "hostInfo": {
    "hostname": "localhost:3000",
    "domainParts": [
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: localhost:3000/test/post/welcome
Main localhost domain detected, no rewrite needed
 GET /test/post/welcome 200 in 59ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/about
    - Hostname: test.localhost:3000
    - Pathname: /about
    - Headers: {
  "connection": "keep-alive",
  "host": "test.localhost:3000",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-forwarded-host": "test.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "test",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/about",
    "normalizedPath": "/about",
    "pathSegments": [
      "about"
    ],
    "pageType": "about"
  },
  "hostInfo": {
    "hostname": "test.localhost:3000",
    "domainParts": [
      "test",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: test.localhost:3000/about
[Middleware] Is subdomain check: test.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Subdomain request detected:
      - Username: test
      - Original pathname: /about
      - Is root path: false
[SUBDOMAIN-DEBUG] Rewriting URL:
      - From: http://localhost:3000/about
      - To pathname: /test/about
      - Full new URL: http://localhost:3000/test/about
 GET /about 404 in 49ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/test/about
    - Hostname: localhost:3000
    - Pathname: /test/about
    - Headers: {
  "connection": "keep-alive",
  "host": "localhost:3000",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "test",
  "isSubdomain": false,
  "pathInfo": {
    "originalPath": "/test/about",
    "normalizedPath": "/test/about",
    "pathSegments": [
      "test",
      "about"
    ],
    "pageType": "about"
  },
  "hostInfo": {
    "hostname": "localhost:3000",
    "domainParts": [
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: localhost:3000/test/about
Main localhost domain detected, no rewrite needed
 GET /test/about 404 in 57ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/
    - Hostname: dev.localhost:3000
    - Pathname: /
    - Headers: {
  "connection": "keep-alive",
  "host": "dev.localhost:3000",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-forwarded-host": "dev.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "dev",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/",
    "normalizedPath": "/",
    "pathSegments": [],
    "pageType": "home"
  },
  "hostInfo": {
    "hostname": "dev.localhost:3000",
    "domainParts": [
      "dev",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: dev.localhost:3000/
[Middleware] Is subdomain check: dev.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Subdomain request detected:
      - Username: dev
      - Original pathname: /
      - Is root path: true
[SUBDOMAIN-DEBUG] Rewriting URL:
      - From: http://localhost:3000/
      - To pathname: /dev
      - Full new URL: http://localhost:3000/dev
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: dev
    - Host header: dev.localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: true
    - X-Minispace-Original-Host: dev.localhost:3000
    - X-Minispace-Username: dev
    - All headers: {
  "host": "dev.localhost:3000",
  "connection": "keep-alive",
  "x-forwarded-host": "dev.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-minispace-original-host": "dev.localhost:3000",
  "x-minispace-path-analysis": "{\"originalPath\":\"/\",\"normalizedPath\":\"/\",\"pageType\":\"home\"}",
  "x-minispace-rewritten-from-subdomain": "true",
  "x-minispace-username": "dev"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: dev
    - Host: dev.localhost:3000
    - Is subdomain detected: true
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: dev
    - Current page: home
    - Is subdomain: true
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: dev
    - Is subdomain: true
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for dev
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: dev
        - Current page: home
        - Is subdomain: true
      
[THEME-DEBUG] Site context:
        - Title: Dev
        - Username: dev
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/welcome
  7. /post/getting-started
  8. /posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-render)
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: dev
        - Is subdomain: true
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: dev
    - Is subdomain: true
    - HTML length: 3852
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Dev</title>
    <m...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /
    /posts
    /about
    /post/welcome
    /post/getting-started
    /posts
[SUBDOMAIN-DEBUG] Subdomain mode - transforming username-prefixed links to relative links
    - Username pattern: /href="\/dev(\/[^"]*|\/?)?"/g
[SUBDOMAIN-DEBUG] Links after subdomain transformation:
      []
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/welcome
  7. /post/getting-started
  8. /posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3988 bytes
 GET / 200 in 347ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/posts
    - Hostname: dev.localhost:3000
    - Pathname: /posts
    - Headers: {
  "connection": "keep-alive",
  "host": "dev.localhost:3000",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-forwarded-host": "dev.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "dev",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/posts",
    "normalizedPath": "/posts",
    "pathSegments": [
      "posts"
    ],
    "pageType": "posts"
  },
  "hostInfo": {
    "hostname": "dev.localhost:3000",
    "domainParts": [
      "dev",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: dev.localhost:3000/posts
[Middleware] Is subdomain check: dev.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Subdomain request detected:
      - Username: dev
      - Original pathname: /posts
      - Is root path: false
[SUBDOMAIN-DEBUG] Rewriting URL:
      - From: http://localhost:3000/posts
      - To pathname: /dev/posts
      - Full new URL: http://localhost:3000/dev/posts
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: dev
    - Host: dev.localhost:3000
    - Is subdomain detected: true
    - Original pathname: /posts
[SUBDOMAIN-DEBUG] Path processing:
        - Clean path: posts
        - Path without username: posts
        - Username check: dev
        - Starts with username?: false
[SUBDOMAIN-DEBUG] Page detection:
          - Path segments: [posts]
          - Selected page: posts
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: dev
    - Current page: posts
    - Is subdomain: true
[Posts Page] Request details:
    - Username: dev
    - Host: dev.localhost:3000
    - Is subdomain (detected): true
    - Path: /posts
    - NODE_ENV: development
  
[Firebase Admin] isAdminAvailable() called:
    - adminInitialized: development
    - adminAuth available: false
    - adminDb available: false
    - real admin available: false
    - NODE_ENV: development
    - Project ID: mini-app-00
  
Error: Route "/[username]/posts" used `headers().get('host')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at isAdminAvailable (src/lib/firebase/admin.ts:139:25)
    at UserPostsPage (src/app/[username]/posts/page.tsx:32:40)
  137 |       const { headers } = require('next/headers');
  138 |       const headersList = headers();
> 139 |       host = headersList.get('host') || '';
      |                         ^
  140 |     } else {
  141 |       host = window.location.host;
  142 |     }
[Firebase Admin] Detected subdomain request on host: dev.localhost:3000
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[Firebase Admin] Admin not available but in development mode - allowing demo content
[Posts Page] Admin availability check result: true
[Posts Page] Firebase Admin DB not available but in development mode.
        - Username: dev
        - Host: dev.localhost:3000
        - Is subdomain: true
        - NODE_ENV: development
      
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: posts
[THEME-DEBUG] Navigation context:
        - Username: dev
        - Current page: posts
        - Is subdomain: true
      
[THEME-DEBUG] Site context:
        - Title: dev's Blog
        - Username: dev
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/dev-mode
  7. /post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-render)
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: posts
        - Username: dev
        - Is subdomain: true
        - Current page: posts
        - Template context keys: site, posts, navigationContext, content, navigation, userCSS, currentYear
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: dev
    - Is subdomain: true
    - HTML length: 3412
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>dev&#39;s Blog</ti...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /
    /posts
    /about
    /post/dev-mode
    /post/firebase-admin-nextjs
[SUBDOMAIN-DEBUG] Subdomain mode - transforming username-prefixed links to relative links
    - Username pattern: /href="\/dev(\/[^"]*|\/?)?"/g
[SUBDOMAIN-DEBUG] Links after subdomain transformation:
      []
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/dev-mode
  7. /post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3549 bytes
 GET /posts 200 in 78ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/dev/posts
    - Hostname: localhost:3000
    - Pathname: /dev/posts
    - Headers: {
  "connection": "keep-alive",
  "host": "localhost:3000",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "dev",
  "isSubdomain": false,
  "pathInfo": {
    "originalPath": "/dev/posts",
    "normalizedPath": "/dev/posts",
    "pathSegments": [
      "dev",
      "posts"
    ],
    "pageType": "posts"
  },
  "hostInfo": {
    "hostname": "localhost:3000",
    "domainParts": [
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: localhost:3000/dev/posts
Main localhost domain detected, no rewrite needed
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: dev
    - Host: localhost:3000
    - Is subdomain detected: false
    - Original pathname: /posts
[SUBDOMAIN-DEBUG] Path processing:
        - Clean path: posts
        - Path without username: posts
        - Username check: dev
        - Starts with username?: false
[SUBDOMAIN-DEBUG] Page detection:
          - Path segments: [posts]
          - Selected page: posts
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: dev
    - Current page: posts
    - Is subdomain: false
[Posts Page] Request details:
    - Username: dev
    - Host: localhost:3000
    - Is subdomain (detected): false
    - Path: /posts
    - NODE_ENV: development
  
[Firebase Admin] isAdminAvailable() called:
    - adminInitialized: development
    - adminAuth available: false
    - adminDb available: false
    - real admin available: false
    - NODE_ENV: development
    - Project ID: mini-app-00
  
Error: Route "/[username]/posts" used `headers().get('host')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at isAdminAvailable (src/lib/firebase/admin.ts:139:25)
    at UserPostsPage (src/app/[username]/posts/page.tsx:32:40)
  137 |       const { headers } = require('next/headers');
  138 |       const headersList = headers();
> 139 |       host = headersList.get('host') || '';
      |                         ^
  140 |     } else {
  141 |       host = window.location.host;
  142 |     }
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[Firebase Admin] Admin not available but in development mode - allowing demo content
[Posts Page] Admin availability check result: true
[Posts Page] Firebase Admin DB not available but in development mode.
        - Username: dev
        - Host: localhost:3000
        - Is subdomain: false
        - NODE_ENV: development
      
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: posts
[THEME-DEBUG] Navigation context:
        - Username: dev
        - Current page: posts
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: dev's Blog
        - Username: dev
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /dev/
  4. /dev/posts
  5. /dev/about
  6. /dev/post/dev-mode
  7. /dev/post/firebase-admin-nextjs
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: posts
        - Username: dev
        - Is subdomain: false
        - Current page: posts
        - Template context keys: site, posts, navigationContext, content, navigation, userCSS, currentYear
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: dev
    - Is subdomain: false
    - HTML length: 3432
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>dev&#39;s Blog</ti...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /dev/
    /dev/posts
    /dev/about
    /dev/post/dev-mode
    /dev/post/firebase-admin-nextjs
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/dev/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/dev/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/dev/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/dev/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/dev/post/dev-mode"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/dev/post/firebase-admin-nextjs"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/dev/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /dev/themes/altay/theme.css
  3. /dev/
  4. /dev/posts
  5. /dev/about
  6. /dev/post/dev-mode
  7. /dev/post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3574 bytes
 GET /dev/posts 200 in 58ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/post/welcome
    - Hostname: dev.localhost:3000
    - Pathname: /post/welcome
    - Headers: {
  "connection": "keep-alive",
  "host": "dev.localhost:3000",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-forwarded-host": "dev.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "dev",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/post/welcome",
    "normalizedPath": "/post/welcome",
    "pathSegments": [
      "post",
      "welcome"
    ],
    "pageType": "post-single"
  },
  "hostInfo": {
    "hostname": "dev.localhost:3000",
    "domainParts": [
      "dev",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: dev.localhost:3000/post/welcome
[Middleware] Is subdomain check: dev.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Subdomain request detected:
      - Username: dev
      - Original pathname: /post/welcome
      - Is root path: false
[SUBDOMAIN-DEBUG] Rewriting URL:
      - From: http://localhost:3000/post/welcome
      - To pathname: /dev/post/welcome
      - Full new URL: http://localhost:3000/dev/post/welcome
[Firebase Admin] Starting initialization...
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
 GET /post/welcome 200 in 46ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/dev/post/welcome
    - Hostname: localhost:3000
    - Pathname: /dev/post/welcome
    - Headers: {
  "connection": "keep-alive",
  "host": "localhost:3000",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "dev",
  "isSubdomain": false,
  "pathInfo": {
    "originalPath": "/dev/post/welcome",
    "normalizedPath": "/dev/post/welcome",
    "pathSegments": [
      "dev",
      "post",
      "welcome"
    ],
    "pageType": "post-single"
  },
  "hostInfo": {
    "hostname": "localhost:3000",
    "domainParts": [
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: localhost:3000/dev/post/welcome
Main localhost domain detected, no rewrite needed
 GET /dev/post/welcome 200 in 43ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/about
    - Hostname: dev.localhost:3000
    - Pathname: /about
    - Headers: {
  "connection": "keep-alive",
  "host": "dev.localhost:3000",
  "x-forwarded-for": "::ffff:127.0.0.1",
  "x-forwarded-host": "dev.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "dev",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/about",
    "normalizedPath": "/about",
    "pathSegments": [
      "about"
    ],
    "pageType": "about"
  },
  "hostInfo": {
    "hostname": "dev.localhost:3000",
    "domainParts": [
      "dev",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: dev.localhost:3000/about
[Middleware] Is subdomain check: dev.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Subdomain request detected:
      - Username: dev
      - Original pathname: /about
      - Is root path: false
[SUBDOMAIN-DEBUG] Rewriting URL:
      - From: http://localhost:3000/about
      - To pathname: /dev/about
      - Full new URL: http://localhost:3000/dev/about
 GET /about 404 in 36ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/dev/about
    - Hostname: localhost:3000
    - Pathname: /dev/about
    - Headers: {
  "connection": "keep-alive",
  "host": "localhost:3000",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "dev",
  "isSubdomain": false,
  "pathInfo": {
    "originalPath": "/dev/about",
    "normalizedPath": "/dev/about",
    "pathSegments": [
      "dev",
      "about"
    ],
    "pageType": "about"
  },
  "hostInfo": {
    "hostname": "localhost:3000",
    "domainParts": [
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: localhost:3000/dev/about
Main localhost domain detected, no rewrite needed
 GET /dev/about 404 in 39ms
[Firebase Admin] Starting initialization...
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/dev/posts
    - Hostname: localhost:3000
    - Pathname: /dev/posts
    - Headers: {
  "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cache-control": "max-age=0",
  "connection": "keep-alive",
  "cookie": "sidebar:state=true; __next_hmr_refresh_hash__=3b58d3fdfb05da79d5f76bbf8b2d5779633457081244afec; username=demouser; authToken=eyJhbGciOiJSUzI1NiIsImtpZCI6ImZlNjVjY2I4ZWFkMGJhZWY1ZmQzNjE5NWQ2NTI4YTA1NGZiYjc2ZjMiLCJ0eXAiOiJKV1QifQ.eyJuYW1lIjoiRGVtb3VzZXIiLCJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vbWluaS1hcHAtMDAiLCJhdWQiOiJtaW5pLWFwcC0wMCIsImF1dGhfdGltZSI6MTc0ODI4MjIxMiwidXNlcl9pZCI6IjNLWVZtUDhiSkxSVmNKRHdVWHUydzRhblJkdTEiLCJzdWIiOiIzS1lWbVA4YkpMUlZjSkR3VVh1Mnc0YW5SZHUxIiwiaWF0IjoxNzQ4MzcxMDEwLCJleHAiOjE3NDgzNzQ2MTAsImVtYWlsIjoiZGVtb0BnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsImZpcmViYXNlIjp7ImlkZW50aXRpZXMiOnsiZW1haWwiOlsiZGVtb0BnbWFpbC5jb20iXX0sInNpZ25faW5fcHJvdmlkZXIiOiJwYXNzd29yZCJ9fQ.DA27WC4tShtiIDiVKx-ShqQctCZpkHB0XaFbXJUv17vqP1HDzYfhxA4hVkrpiKw-0kHqgJqzuglY0FkXuPYxsb19lT4VZlIsgtUhHZscJjL44m82QlGDPfvaQ5M2nmzkyuuL4ez7DMrLDrnizoJubyLq-3l4abuQ2bb1_PzRu6AR7ikTcFgaZmAqAPFb1qdXY9ytcM_aDFogcZeL0isDMr8OLykNw92z6l5bUT6Io68sX7arC0l-wMq-0gcdZPPIHsAthmHryueg7UjuGkIx2llmTIDjm_CAWw4L0_zEZq-HPvaRVBwjDsuu_j0gCqRQGolmd8a8XvhPoYpfBM0tYg",
  "host": "localhost:3000",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "sec-ch-ua-platform": "\"macOS\"",
  "sec-fetch-dest": "document",
  "sec-fetch-mode": "navigate",
  "sec-fetch-site": "same-origin",
  "sec-fetch-user": "?1",
  "upgrade-insecure-requests": "1",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "dev",
  "isSubdomain": false,
  "pathInfo": {
    "originalPath": "/dev/posts",
    "normalizedPath": "/dev/posts",
    "pathSegments": [
      "dev",
      "posts"
    ],
    "pageType": "posts"
  },
  "hostInfo": {
    "hostname": "localhost:3000",
    "domainParts": [
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: localhost:3000/dev/posts
Main localhost domain detected, no rewrite needed
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: dev
    - Host: localhost:3000
    - Is subdomain detected: false
    - Original pathname: /posts
[SUBDOMAIN-DEBUG] Path processing:
        - Clean path: posts
        - Path without username: posts
        - Username check: dev
        - Starts with username?: false
[SUBDOMAIN-DEBUG] Page detection:
          - Path segments: [posts]
          - Selected page: posts
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: dev
    - Current page: posts
    - Is subdomain: false
[Posts Page] Request details:
    - Username: dev
    - Host: localhost:3000
    - Is subdomain (detected): false
    - Path: /posts
    - NODE_ENV: development
  
[Firebase Admin] isAdminAvailable() called:
    - adminInitialized: development
    - adminAuth available: false
    - adminDb available: false
    - real admin available: false
    - NODE_ENV: development
    - Project ID: mini-app-00
  
Error: Route "/[username]/posts" used `headers().get('host')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at isAdminAvailable (src/lib/firebase/admin.ts:139:25)
    at UserPostsPage (src/app/[username]/posts/page.tsx:32:40)
  137 |       const { headers } = require('next/headers');
  138 |       const headersList = headers();
> 139 |       host = headersList.get('host') || '';
      |                         ^
  140 |     } else {
  141 |       host = window.location.host;
  142 |     }
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[Firebase Admin] Admin not available but in development mode - allowing demo content
[Posts Page] Admin availability check result: true
[Posts Page] Firebase Admin DB not available but in development mode.
        - Username: dev
        - Host: localhost:3000
        - Is subdomain: false
        - NODE_ENV: development
      
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: posts
[THEME-DEBUG] Navigation context:
        - Username: dev
        - Current page: posts
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: dev's Blog
        - Username: dev
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /dev/
  4. /dev/posts
  5. /dev/about
  6. /dev/post/dev-mode
  7. /dev/post/firebase-admin-nextjs
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: posts
        - Username: dev
        - Is subdomain: false
        - Current page: posts
        - Template context keys: site, posts, navigationContext, content, navigation, userCSS, currentYear
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: dev
    - Is subdomain: false
    - HTML length: 3432
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>dev&#39;s Blog</ti...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /dev/
    /dev/posts
    /dev/about
    /dev/post/dev-mode
    /dev/post/firebase-admin-nextjs
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/dev/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/dev/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/dev/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/dev/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/dev/post/dev-mode"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/dev/post/firebase-admin-nextjs"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/dev/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /dev/themes/altay/theme.css
  3. /dev/
  4. /dev/posts
  5. /dev/about
  6. /dev/post/dev-mode
  7. /dev/post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3574 bytes
 GET /dev/posts 200 in 420ms
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: favicon.ico
    - Host header: localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: not set
    - X-Minispace-Original-Host: not set
    - X-Minispace-Username: not set
    - All headers: {
  "host": "localhost:3000",
  "connection": "keep-alive",
  "sec-ch-ua-platform": "\"macOS\"",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "accept": "image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8",
  "sec-fetch-site": "same-origin",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-dest": "image",
  "referer": "http://localhost:3000/dev/posts",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cookie": "sidebar:state=true; __next_hmr_refresh_hash__=3b58d3fdfb05da79d5f76bbf8b2d5779633457081244afec; username=demouser; authToken=eyJhbGciOiJSUzI1NiIsImtpZCI6ImZlNjVjY2I4ZWFkMGJhZWY1ZmQzNjE5NWQ2NTI4YTA1NGZiYjc2ZjMiLCJ0eXAiOiJKV1QifQ.eyJuYW1lIjoiRGVtb3VzZXIiLCJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vbWluaS1hcHAtMDAiLCJhdWQiOiJtaW5pLWFwcC0wMCIsImF1dGhfdGltZSI6MTc0ODI4MjIxMiwidXNlcl9pZCI6IjNLWVZtUDhiSkxSVmNKRHdVWHUydzRhblJkdTEiLCJzdWIiOiIzS1lWbVA4YkpMUlZjSkR3VVh1Mnc0YW5SZHUxIiwiaWF0IjoxNzQ4MzcxMDEwLCJleHAiOjE3NDgzNzQ2MTAsImVtYWlsIjoiZGVtb0BnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsImZpcmViYXNlIjp7ImlkZW50aXRpZXMiOnsiZW1haWwiOlsiZGVtb0BnbWFpbC5jb20iXX0sInNpZ25faW5fcHJvdmlkZXIiOiJwYXNzd29yZCJ9fQ.DA27WC4tShtiIDiVKx-ShqQctCZpkHB0XaFbXJUv17vqP1HDzYfhxA4hVkrpiKw-0kHqgJqzuglY0FkXuPYxsb19lT4VZlIsgtUhHZscJjL44m82QlGDPfvaQ5M2nmzkyuuL4ez7DMrLDrnizoJubyLq-3l4abuQ2bb1_PzRu6AR7ikTcFgaZmAqAPFb1qdXY9ytcM_aDFogcZeL0isDMr8OLykNw92z6l5bUT6Io68sX7arC0l-wMq-0gcdZPPIHsAthmHryueg7UjuGkIx2llmTIDjm_CAWw4L0_zEZq-HPvaRVBwjDsuu_j0gCqRQGolmd8a8XvhPoYpfBM0tYg",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::1"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: favicon.ico
    - Host: localhost:3000
    - Is subdomain detected: false
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: favicon.ico
    - Current page: home
    - Is subdomain: false
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: favicon.ico
    - Is subdomain: false
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for favicon.ico
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: favicon.ico
        - Current page: home
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: Favicon.ico
        - Username: favicon.ico
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: favicon.ico
        - Is subdomain: false
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: favicon.ico
    - Is subdomain: false
    - HTML length: 3972
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Favicon.ico</title...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /favicon.ico/
    /favicon.ico/posts
    /favicon.ico/about
    /favicon.ico/post/welcome
    /favicon.ico/post/getting-started
    /favicon.ico/posts
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/favicon.ico/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/welcome"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/getting-started"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/favicon.ico/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /favicon.ico/themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4129 bytes
 GET /favicon.ico 200 in 158ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/dev/themes/altay/theme.css
    - Hostname: localhost:3000
    - Pathname: /dev/themes/altay/theme.css
    - Headers: {
  "accept": "text/css,*/*;q=0.1",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "connection": "keep-alive",
  "cookie": "sidebar:state=true; __next_hmr_refresh_hash__=3b58d3fdfb05da79d5f76bbf8b2d5779633457081244afec; username=demouser; authToken=eyJhbGciOiJSUzI1NiIsImtpZCI6ImZlNjVjY2I4ZWFkMGJhZWY1ZmQzNjE5NWQ2NTI4YTA1NGZiYjc2ZjMiLCJ0eXAiOiJKV1QifQ.eyJuYW1lIjoiRGVtb3VzZXIiLCJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vbWluaS1hcHAtMDAiLCJhdWQiOiJtaW5pLWFwcC0wMCIsImF1dGhfdGltZSI6MTc0ODI4MjIxMiwidXNlcl9pZCI6IjNLWVZtUDhiSkxSVmNKRHdVWHUydzRhblJkdTEiLCJzdWIiOiIzS1lWbVA4YkpMUlZjSkR3VVh1Mnc0YW5SZHUxIiwiaWF0IjoxNzQ4MzcxMDYwLCJleHAiOjE3NDgzNzQ2NjAsImVtYWlsIjoiZGVtb0BnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsImZpcmViYXNlIjp7ImlkZW50aXRpZXMiOnsiZW1haWwiOlsiZGVtb0BnbWFpbC5jb20iXX0sInNpZ25faW5fcHJvdmlkZXIiOiJwYXNzd29yZCJ9fQ.AGfJnjnFq5dE0oTxdZ5vnR631g428B83yTRJf18OLLIGQNFyE7IQ63dpzg6_VP9Gqhh2IWP2Y54nIG8bat67iasJtL0DkHwDFwK4SVKyaCRpQZsZM7JOWFirOM-5HCHNqlyDS6oMYfzflAzRUZUOQe7AB-vx2lpHn4M7TNx0tNXwaulcU-yOf_cOfYFOktLIDGRP-MiLWA0-62NZSiYvoP15c3XJRj4xRyYIyfyUAMGgiNsUcVkdVlQlKPsGJ5qCPRePc0pPoazkh9nbbjmU8G_mrIFk7zmqImyQlLl1diko8omNBIYPYunmPP0rDNsikNQV8ZQtM5n2Uv-ldAitXQ",
  "host": "localhost:3000",
  "referer": "http://localhost:3000/dev/posts",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "sec-ch-ua-platform": "\"macOS\"",
  "sec-fetch-dest": "style",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-site": "same-origin",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "dev",
  "isSubdomain": false,
  "pathInfo": {
    "originalPath": "/dev/themes/altay/theme.css",
    "normalizedPath": "/dev/themes/altay/theme.css",
    "pathSegments": [
      "dev",
      "themes",
      "altay",
      "theme.css"
    ],
    "pageType": "themes"
  },
  "hostInfo": {
    "hostname": "localhost:3000",
    "domainParts": [
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: favicon.ico
    - Host header: localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: not set
    - X-Minispace-Original-Host: not set
    - X-Minispace-Username: not set
    - All headers: {
  "host": "localhost:3000",
  "connection": "keep-alive",
  "sec-ch-ua-platform": "\"macOS\"",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "accept": "image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8",
  "sec-fetch-site": "same-origin",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-dest": "image",
  "referer": "http://localhost:3000/dev/posts",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cookie": "sidebar:state=true; __next_hmr_refresh_hash__=3b58d3fdfb05da79d5f76bbf8b2d5779633457081244afec; username=demouser; authToken=eyJhbGciOiJSUzI1NiIsImtpZCI6ImZlNjVjY2I4ZWFkMGJhZWY1ZmQzNjE5NWQ2NTI4YTA1NGZiYjc2ZjMiLCJ0eXAiOiJKV1QifQ.eyJuYW1lIjoiRGVtb3VzZXIiLCJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vbWluaS1hcHAtMDAiLCJhdWQiOiJtaW5pLWFwcC0wMCIsImF1dGhfdGltZSI6MTc0ODI4MjIxMiwidXNlcl9pZCI6IjNLWVZtUDhiSkxSVmNKRHdVWHUydzRhblJkdTEiLCJzdWIiOiIzS1lWbVA4YkpMUlZjSkR3VVh1Mnc0YW5SZHUxIiwiaWF0IjoxNzQ4MzcxMDYwLCJleHAiOjE3NDgzNzQ2NjAsImVtYWlsIjoiZGVtb0BnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsImZpcmViYXNlIjp7ImlkZW50aXRpZXMiOnsiZW1haWwiOlsiZGVtb0BnbWFpbC5jb20iXX0sInNpZ25faW5fcHJvdmlkZXIiOiJwYXNzd29yZCJ9fQ.AGfJnjnFq5dE0oTxdZ5vnR631g428B83yTRJf18OLLIGQNFyE7IQ63dpzg6_VP9Gqhh2IWP2Y54nIG8bat67iasJtL0DkHwDFwK4SVKyaCRpQZsZM7JOWFirOM-5HCHNqlyDS6oMYfzflAzRUZUOQe7AB-vx2lpHn4M7TNx0tNXwaulcU-yOf_cOfYFOktLIDGRP-MiLWA0-62NZSiYvoP15c3XJRj4xRyYIyfyUAMGgiNsUcVkdVlQlKPsGJ5qCPRePc0pPoazkh9nbbjmU8G_mrIFk7zmqImyQlLl1diko8omNBIYPYunmPP0rDNsikNQV8ZQtM5n2Uv-ldAitXQ",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::1"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: favicon.ico
    - Host: localhost:3000
    - Is subdomain detected: false
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: favicon.ico
    - Current page: home
    - Is subdomain: false
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: favicon.ico
    - Is subdomain: false
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for favicon.ico
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: favicon.ico
        - Current page: home
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: Favicon.ico
        - Username: favicon.ico
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: favicon.ico
        - Is subdomain: false
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: favicon.ico
    - Is subdomain: false
    - HTML length: 3972
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Favicon.ico</title...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /favicon.ico/
    /favicon.ico/posts
    /favicon.ico/about
    /favicon.ico/post/welcome
    /favicon.ico/post/getting-started
    /favicon.ico/posts
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/favicon.ico/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/welcome"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/getting-started"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/favicon.ico/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /favicon.ico/themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4129 bytes
 GET /dev/themes/altay/theme.css 404 in 757ms
 GET /favicon.ico 200 in 917ms
[Firebase Admin] Starting initialization...
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
[Firebase Admin] Starting initialization...
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: favicon.ico
    - Host header: localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: not set
    - X-Minispace-Original-Host: not set
    - X-Minispace-Username: not set
    - All headers: {
  "host": "localhost:3000",
  "connection": "keep-alive",
  "sec-ch-ua-platform": "\"macOS\"",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "accept": "image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8",
  "sec-fetch-site": "same-origin",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-dest": "image",
  "referer": "http://localhost:3000/dev/posts",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cookie": "sidebar:state=true; __next_hmr_refresh_hash__=3b58d3fdfb05da79d5f76bbf8b2d5779633457081244afec; username=demouser; authToken=eyJhbGciOiJSUzI1NiIsImtpZCI6ImZlNjVjY2I4ZWFkMGJhZWY1ZmQzNjE5NWQ2NTI4YTA1NGZiYjc2ZjMiLCJ0eXAiOiJKV1QifQ.eyJuYW1lIjoiRGVtb3VzZXIiLCJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vbWluaS1hcHAtMDAiLCJhdWQiOiJtaW5pLWFwcC0wMCIsImF1dGhfdGltZSI6MTc0ODI4MjIxMiwidXNlcl9pZCI6IjNLWVZtUDhiSkxSVmNKRHdVWHUydzRhblJkdTEiLCJzdWIiOiIzS1lWbVA4YkpMUlZjSkR3VVh1Mnc0YW5SZHUxIiwiaWF0IjoxNzQ4MzcxMDYwLCJleHAiOjE3NDgzNzQ2NjAsImVtYWlsIjoiZGVtb0BnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsImZpcmViYXNlIjp7ImlkZW50aXRpZXMiOnsiZW1haWwiOlsiZGVtb0BnbWFpbC5jb20iXX0sInNpZ25faW5fcHJvdmlkZXIiOiJwYXNzd29yZCJ9fQ.AGfJnjnFq5dE0oTxdZ5vnR631g428B83yTRJf18OLLIGQNFyE7IQ63dpzg6_VP9Gqhh2IWP2Y54nIG8bat67iasJtL0DkHwDFwK4SVKyaCRpQZsZM7JOWFirOM-5HCHNqlyDS6oMYfzflAzRUZUOQe7AB-vx2lpHn4M7TNx0tNXwaulcU-yOf_cOfYFOktLIDGRP-MiLWA0-62NZSiYvoP15c3XJRj4xRyYIyfyUAMGgiNsUcVkdVlQlKPsGJ5qCPRePc0pPoazkh9nbbjmU8G_mrIFk7zmqImyQlLl1diko8omNBIYPYunmPP0rDNsikNQV8ZQtM5n2Uv-ldAitXQ",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::1"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: favicon.ico
    - Host: localhost:3000
    - Is subdomain detected: false
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: favicon.ico
    - Current page: home
    - Is subdomain: false
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: favicon.ico
    - Is subdomain: false
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for favicon.ico
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: favicon.ico
        - Current page: home
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: Favicon.ico
        - Username: favicon.ico
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: favicon.ico
        - Is subdomain: false
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: favicon.ico
    - Is subdomain: false
    - HTML length: 3972
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Favicon.ico</title...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /favicon.ico/
    /favicon.ico/posts
    /favicon.ico/about
    /favicon.ico/post/welcome
    /favicon.ico/post/getting-started
    /favicon.ico/posts
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/favicon.ico/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/welcome"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/getting-started"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/favicon.ico/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /favicon.ico/themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4129 bytes
 GET /favicon.ico 200 in 298ms
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: favicon.ico
    - Host header: localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: not set
    - X-Minispace-Original-Host: not set
    - X-Minispace-Username: not set
    - All headers: {
  "host": "localhost:3000",
  "connection": "keep-alive",
  "sec-ch-ua-platform": "\"macOS\"",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "accept": "image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8",
  "sec-fetch-site": "same-origin",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-dest": "image",
  "referer": "http://localhost:3000/dev/posts",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cookie": "sidebar:state=true; __next_hmr_refresh_hash__=3b58d3fdfb05da79d5f76bbf8b2d5779633457081244afec; username=demouser; authToken=eyJhbGciOiJSUzI1NiIsImtpZCI6ImZlNjVjY2I4ZWFkMGJhZWY1ZmQzNjE5NWQ2NTI4YTA1NGZiYjc2ZjMiLCJ0eXAiOiJKV1QifQ.eyJuYW1lIjoiRGVtb3VzZXIiLCJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vbWluaS1hcHAtMDAiLCJhdWQiOiJtaW5pLWFwcC0wMCIsImF1dGhfdGltZSI6MTc0ODI4MjIxMiwidXNlcl9pZCI6IjNLWVZtUDhiSkxSVmNKRHdVWHUydzRhblJkdTEiLCJzdWIiOiIzS1lWbVA4YkpMUlZjSkR3VVh1Mnc0YW5SZHUxIiwiaWF0IjoxNzQ4MzcxMDYwLCJleHAiOjE3NDgzNzQ2NjAsImVtYWlsIjoiZGVtb0BnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsImZpcmViYXNlIjp7ImlkZW50aXRpZXMiOnsiZW1haWwiOlsiZGVtb0BnbWFpbC5jb20iXX0sInNpZ25faW5fcHJvdmlkZXIiOiJwYXNzd29yZCJ9fQ.AGfJnjnFq5dE0oTxdZ5vnR631g428B83yTRJf18OLLIGQNFyE7IQ63dpzg6_VP9Gqhh2IWP2Y54nIG8bat67iasJtL0DkHwDFwK4SVKyaCRpQZsZM7JOWFirOM-5HCHNqlyDS6oMYfzflAzRUZUOQe7AB-vx2lpHn4M7TNx0tNXwaulcU-yOf_cOfYFOktLIDGRP-MiLWA0-62NZSiYvoP15c3XJRj4xRyYIyfyUAMGgiNsUcVkdVlQlKPsGJ5qCPRePc0pPoazkh9nbbjmU8G_mrIFk7zmqImyQlLl1diko8omNBIYPYunmPP0rDNsikNQV8ZQtM5n2Uv-ldAitXQ",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::1"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: favicon.ico
    - Host: localhost:3000
    - Is subdomain detected: false
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: favicon.ico
    - Current page: home
    - Is subdomain: false
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: favicon.ico
    - Is subdomain: false
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for favicon.ico
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: favicon.ico
        - Current page: home
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: Favicon.ico
        - Username: favicon.ico
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: favicon.ico
        - Is subdomain: false
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: favicon.ico
    - Is subdomain: false
    - HTML length: 3972
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Favicon.ico</title...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /favicon.ico/
    /favicon.ico/posts
    /favicon.ico/about
    /favicon.ico/post/welcome
    /favicon.ico/post/getting-started
    /favicon.ico/posts
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/favicon.ico/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/welcome"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/getting-started"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/favicon.ico/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /favicon.ico/themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4129 bytes
 GET /favicon.ico 200 in 42ms
[Firebase Admin] Starting initialization...
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/demouser/posts
    - Hostname: localhost:3000
    - Pathname: /demouser/posts
    - Headers: {
  "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "connection": "keep-alive",
  "cookie": "sidebar:state=true; __next_hmr_refresh_hash__=3b58d3fdfb05da79d5f76bbf8b2d5779633457081244afec; username=demouser; authToken=eyJhbGciOiJSUzI1NiIsImtpZCI6ImZlNjVjY2I4ZWFkMGJhZWY1ZmQzNjE5NWQ2NTI4YTA1NGZiYjc2ZjMiLCJ0eXAiOiJKV1QifQ.eyJuYW1lIjoiRGVtb3VzZXIiLCJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vbWluaS1hcHAtMDAiLCJhdWQiOiJtaW5pLWFwcC0wMCIsImF1dGhfdGltZSI6MTc0ODI4MjIxMiwidXNlcl9pZCI6IjNLWVZtUDhiSkxSVmNKRHdVWHUydzRhblJkdTEiLCJzdWIiOiIzS1lWbVA4YkpMUlZjSkR3VVh1Mnc0YW5SZHUxIiwiaWF0IjoxNzQ4MzcxMDYwLCJleHAiOjE3NDgzNzQ2NjAsImVtYWlsIjoiZGVtb0BnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsImZpcmViYXNlIjp7ImlkZW50aXRpZXMiOnsiZW1haWwiOlsiZGVtb0BnbWFpbC5jb20iXX0sInNpZ25faW5fcHJvdmlkZXIiOiJwYXNzd29yZCJ9fQ.AGfJnjnFq5dE0oTxdZ5vnR631g428B83yTRJf18OLLIGQNFyE7IQ63dpzg6_VP9Gqhh2IWP2Y54nIG8bat67iasJtL0DkHwDFwK4SVKyaCRpQZsZM7JOWFirOM-5HCHNqlyDS6oMYfzflAzRUZUOQe7AB-vx2lpHn4M7TNx0tNXwaulcU-yOf_cOfYFOktLIDGRP-MiLWA0-62NZSiYvoP15c3XJRj4xRyYIyfyUAMGgiNsUcVkdVlQlKPsGJ5qCPRePc0pPoazkh9nbbjmU8G_mrIFk7zmqImyQlLl1diko8omNBIYPYunmPP0rDNsikNQV8ZQtM5n2Uv-ldAitXQ",
  "host": "localhost:3000",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "sec-ch-ua-platform": "\"macOS\"",
  "sec-fetch-dest": "document",
  "sec-fetch-mode": "navigate",
  "sec-fetch-site": "none",
  "sec-fetch-user": "?1",
  "upgrade-insecure-requests": "1",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "demouser",
  "isSubdomain": false,
  "pathInfo": {
    "originalPath": "/demouser/posts",
    "normalizedPath": "/demouser/posts",
    "pathSegments": [
      "demouser",
      "posts"
    ],
    "pageType": "posts"
  },
  "hostInfo": {
    "hostname": "localhost:3000",
    "domainParts": [
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: localhost:3000/demouser/posts
Main localhost domain detected, no rewrite needed
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: demouser
    - Host: localhost:3000
    - Is subdomain detected: false
    - Original pathname: /posts
[SUBDOMAIN-DEBUG] Path processing:
        - Clean path: posts
        - Path without username: posts
        - Username check: demouser
        - Starts with username?: false
[SUBDOMAIN-DEBUG] Page detection:
          - Path segments: [posts]
          - Selected page: posts
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: demouser
    - Current page: posts
    - Is subdomain: false
[Posts Page] Request details:
    - Username: demouser
    - Host: localhost:3000
    - Is subdomain (detected): false
    - Path: /posts
    - NODE_ENV: development
  
[Firebase Admin] isAdminAvailable() called:
    - adminInitialized: development
    - adminAuth available: false
    - adminDb available: false
    - real admin available: false
    - NODE_ENV: development
    - Project ID: mini-app-00
  
Error: Route "/[username]/posts" used `headers().get('host')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at isAdminAvailable (src/lib/firebase/admin.ts:139:25)
    at UserPostsPage (src/app/[username]/posts/page.tsx:32:40)
  137 |       const { headers } = require('next/headers');
  138 |       const headersList = headers();
> 139 |       host = headersList.get('host') || '';
      |                         ^
  140 |     } else {
  141 |       host = window.location.host;
  142 |     }
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[Firebase Admin] Admin not available but in development mode - allowing demo content
[Posts Page] Admin availability check result: true
[Posts Page] Firebase Admin DB not available but in development mode.
        - Username: demouser
        - Host: localhost:3000
        - Is subdomain: false
        - NODE_ENV: development
      
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: posts
[THEME-DEBUG] Navigation context:
        - Username: demouser
        - Current page: posts
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: demouser's Blog
        - Username: demouser
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /demouser/
  4. /demouser/posts
  5. /demouser/about
  6. /demouser/post/dev-mode
  7. /demouser/post/firebase-admin-nextjs
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: posts
        - Username: demouser
        - Is subdomain: false
        - Current page: posts
        - Template context keys: site, posts, navigationContext, content, navigation, userCSS, currentYear
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: demouser
    - Is subdomain: false
    - HTML length: 3477
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>demouser&#39;s Blo...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /demouser/
    /demouser/posts
    /demouser/about
    /demouser/post/dev-mode
    /demouser/post/firebase-admin-nextjs
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/demouser/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/demouser/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/demouser/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/demouser/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/demouser/post/dev-mode"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/demouser/post/firebase-admin-nextjs"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/demouser/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /demouser/themes/altay/theme.css
  3. /demouser/
  4. /demouser/posts
  5. /demouser/about
  6. /demouser/post/dev-mode
  7. /demouser/post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3629 bytes
 GET /demouser/posts 200 in 96ms
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: favicon.ico
    - Host header: localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: not set
    - X-Minispace-Original-Host: not set
    - X-Minispace-Username: not set
    - All headers: {
  "host": "localhost:3000",
  "connection": "keep-alive",
  "sec-ch-ua-platform": "\"macOS\"",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "accept": "image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8",
  "sec-fetch-site": "same-origin",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-dest": "image",
  "referer": "http://localhost:3000/demouser/posts",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cookie": "sidebar:state=true; __next_hmr_refresh_hash__=3b58d3fdfb05da79d5f76bbf8b2d5779633457081244afec; username=demouser; authToken=eyJhbGciOiJSUzI1NiIsImtpZCI6ImZlNjVjY2I4ZWFkMGJhZWY1ZmQzNjE5NWQ2NTI4YTA1NGZiYjc2ZjMiLCJ0eXAiOiJKV1QifQ.eyJuYW1lIjoiRGVtb3VzZXIiLCJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vbWluaS1hcHAtMDAiLCJhdWQiOiJtaW5pLWFwcC0wMCIsImF1dGhfdGltZSI6MTc0ODI4MjIxMiwidXNlcl9pZCI6IjNLWVZtUDhiSkxSVmNKRHdVWHUydzRhblJkdTEiLCJzdWIiOiIzS1lWbVA4YkpMUlZjSkR3VVh1Mnc0YW5SZHUxIiwiaWF0IjoxNzQ4MzcxMDYwLCJleHAiOjE3NDgzNzQ2NjAsImVtYWlsIjoiZGVtb0BnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsImZpcmViYXNlIjp7ImlkZW50aXRpZXMiOnsiZW1haWwiOlsiZGVtb0BnbWFpbC5jb20iXX0sInNpZ25faW5fcHJvdmlkZXIiOiJwYXNzd29yZCJ9fQ.AGfJnjnFq5dE0oTxdZ5vnR631g428B83yTRJf18OLLIGQNFyE7IQ63dpzg6_VP9Gqhh2IWP2Y54nIG8bat67iasJtL0DkHwDFwK4SVKyaCRpQZsZM7JOWFirOM-5HCHNqlyDS6oMYfzflAzRUZUOQe7AB-vx2lpHn4M7TNx0tNXwaulcU-yOf_cOfYFOktLIDGRP-MiLWA0-62NZSiYvoP15c3XJRj4xRyYIyfyUAMGgiNsUcVkdVlQlKPsGJ5qCPRePc0pPoazkh9nbbjmU8G_mrIFk7zmqImyQlLl1diko8omNBIYPYunmPP0rDNsikNQV8ZQtM5n2Uv-ldAitXQ",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::1"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: favicon.ico
    - Host: localhost:3000
    - Is subdomain detected: false
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: favicon.ico
    - Current page: home
    - Is subdomain: false
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: favicon.ico
    - Is subdomain: false
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for favicon.ico
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: favicon.ico
        - Current page: home
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: Favicon.ico
        - Username: favicon.ico
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: favicon.ico
        - Is subdomain: false
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: favicon.ico
    - Is subdomain: false
    - HTML length: 3972
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Favicon.ico</title...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /favicon.ico/
    /favicon.ico/posts
    /favicon.ico/about
    /favicon.ico/post/welcome
    /favicon.ico/post/getting-started
    /favicon.ico/posts
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/favicon.ico/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/welcome"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/getting-started"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/favicon.ico/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /favicon.ico/themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4129 bytes
 GET /favicon.ico 200 in 57ms
[Firebase Admin] Starting initialization...
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
[Firebase Admin] Starting initialization...
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/demouser/themes/altay/theme.css
    - Hostname: localhost:3000
    - Pathname: /demouser/themes/altay/theme.css
    - Headers: {
  "accept": "text/css,*/*;q=0.1",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "connection": "keep-alive",
  "cookie": "sidebar:state=true; __next_hmr_refresh_hash__=3b58d3fdfb05da79d5f76bbf8b2d5779633457081244afec; username=demouser; authToken=eyJhbGciOiJSUzI1NiIsImtpZCI6ImZlNjVjY2I4ZWFkMGJhZWY1ZmQzNjE5NWQ2NTI4YTA1NGZiYjc2ZjMiLCJ0eXAiOiJKV1QifQ.eyJuYW1lIjoiRGVtb3VzZXIiLCJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vbWluaS1hcHAtMDAiLCJhdWQiOiJtaW5pLWFwcC0wMCIsImF1dGhfdGltZSI6MTc0ODI4MjIxMiwidXNlcl9pZCI6IjNLWVZtUDhiSkxSVmNKRHdVWHUydzRhblJkdTEiLCJzdWIiOiIzS1lWbVA4YkpMUlZjSkR3VVh1Mnc0YW5SZHUxIiwiaWF0IjoxNzQ4MzcxMDczLCJleHAiOjE3NDgzNzQ2NzMsImVtYWlsIjoiZGVtb0BnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsImZpcmViYXNlIjp7ImlkZW50aXRpZXMiOnsiZW1haWwiOlsiZGVtb0BnbWFpbC5jb20iXX0sInNpZ25faW5fcHJvdmlkZXIiOiJwYXNzd29yZCJ9fQ.eOBnl9BwQ8m_h5Drw_TRYN5_KaXocgctkg8eGSdAOc0y_RicI-JfvVnO1zpT2kvMAVvFT36OTfHpgq9mWIceoqZ4DC-Mj5Utkr0Q5I2hhGtbLH9IRpyQEWnMHgDk1f1jp76DhXRzEuFX-NhKwcBUtCNu_qh9V7qoeWA1u0HDdz99PCfTTyxQri9pUWyJEcrnD_ytIlpLJM6v2lcffqssVC2BTHCCtHzG5MAHYle7I1EeUF0GWc7snSBHaYZ-nSYnXeLZNGkWSTamaSMv7GmwmgEKOgDlHoJDaDyanb6DIla2g3J11NKanElUpuZlGcpnnfMS9fza-nHM2p-JCyBHEA",
  "host": "localhost:3000",
  "referer": "http://localhost:3000/demouser/posts",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "sec-ch-ua-platform": "\"macOS\"",
  "sec-fetch-dest": "style",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-site": "same-origin",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "demouser",
  "isSubdomain": false,
  "pathInfo": {
    "originalPath": "/demouser/themes/altay/theme.css",
    "normalizedPath": "/demouser/themes/altay/theme.css",
    "pathSegments": [
      "demouser",
      "themes",
      "altay",
      "theme.css"
    ],
    "pageType": "themes"
  },
  "hostInfo": {
    "hostname": "localhost:3000",
    "domainParts": [
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
 GET /demouser/themes/altay/theme.css 404 in 58ms
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: favicon.ico
    - Host header: localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: not set
    - X-Minispace-Original-Host: not set
    - X-Minispace-Username: not set
    - All headers: {
  "host": "localhost:3000",
  "connection": "keep-alive",
  "sec-ch-ua-platform": "\"macOS\"",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "accept": "image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8",
  "sec-fetch-site": "same-origin",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-dest": "image",
  "referer": "http://localhost:3000/demouser/posts",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cookie": "sidebar:state=true; __next_hmr_refresh_hash__=3b58d3fdfb05da79d5f76bbf8b2d5779633457081244afec; username=demouser; authToken=eyJhbGciOiJSUzI1NiIsImtpZCI6ImZlNjVjY2I4ZWFkMGJhZWY1ZmQzNjE5NWQ2NTI4YTA1NGZiYjc2ZjMiLCJ0eXAiOiJKV1QifQ.eyJuYW1lIjoiRGVtb3VzZXIiLCJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vbWluaS1hcHAtMDAiLCJhdWQiOiJtaW5pLWFwcC0wMCIsImF1dGhfdGltZSI6MTc0ODI4MjIxMiwidXNlcl9pZCI6IjNLWVZtUDhiSkxSVmNKRHdVWHUydzRhblJkdTEiLCJzdWIiOiIzS1lWbVA4YkpMUlZjSkR3VVh1Mnc0YW5SZHUxIiwiaWF0IjoxNzQ4MzcxMDczLCJleHAiOjE3NDgzNzQ2NzMsImVtYWlsIjoiZGVtb0BnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsImZpcmViYXNlIjp7ImlkZW50aXRpZXMiOnsiZW1haWwiOlsiZGVtb0BnbWFpbC5jb20iXX0sInNpZ25faW5fcHJvdmlkZXIiOiJwYXNzd29yZCJ9fQ.eOBnl9BwQ8m_h5Drw_TRYN5_KaXocgctkg8eGSdAOc0y_RicI-JfvVnO1zpT2kvMAVvFT36OTfHpgq9mWIceoqZ4DC-Mj5Utkr0Q5I2hhGtbLH9IRpyQEWnMHgDk1f1jp76DhXRzEuFX-NhKwcBUtCNu_qh9V7qoeWA1u0HDdz99PCfTTyxQri9pUWyJEcrnD_ytIlpLJM6v2lcffqssVC2BTHCCtHzG5MAHYle7I1EeUF0GWc7snSBHaYZ-nSYnXeLZNGkWSTamaSMv7GmwmgEKOgDlHoJDaDyanb6DIla2g3J11NKanElUpuZlGcpnnfMS9fza-nHM2p-JCyBHEA",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::1"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: favicon.ico
    - Host: localhost:3000
    - Is subdomain detected: false
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: favicon.ico
    - Current page: home
    - Is subdomain: false
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: favicon.ico
    - Is subdomain: false
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for favicon.ico
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: favicon.ico
        - Current page: home
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: Favicon.ico
        - Username: favicon.ico
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: favicon.ico
        - Is subdomain: false
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: favicon.ico
    - Is subdomain: false
    - HTML length: 3972
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Favicon.ico</title...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /favicon.ico/
    /favicon.ico/posts
    /favicon.ico/about
    /favicon.ico/post/welcome
    /favicon.ico/post/getting-started
    /favicon.ico/posts
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/favicon.ico/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/welcome"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/getting-started"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/favicon.ico/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /favicon.ico/themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4129 bytes
 GET /favicon.ico 200 in 84ms
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: favicon.ico
    - Host header: localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: not set
    - X-Minispace-Original-Host: not set
    - X-Minispace-Username: not set
    - All headers: {
  "host": "localhost:3000",
  "connection": "keep-alive",
  "sec-ch-ua-platform": "\"macOS\"",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "accept": "image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8",
  "sec-fetch-site": "same-origin",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-dest": "image",
  "referer": "http://localhost:3000/demouser/posts",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cookie": "sidebar:state=true; __next_hmr_refresh_hash__=3b58d3fdfb05da79d5f76bbf8b2d5779633457081244afec; username=demouser; authToken=eyJhbGciOiJSUzI1NiIsImtpZCI6ImZlNjVjY2I4ZWFkMGJhZWY1ZmQzNjE5NWQ2NTI4YTA1NGZiYjc2ZjMiLCJ0eXAiOiJKV1QifQ.eyJuYW1lIjoiRGVtb3VzZXIiLCJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vbWluaS1hcHAtMDAiLCJhdWQiOiJtaW5pLWFwcC0wMCIsImF1dGhfdGltZSI6MTc0ODI4MjIxMiwidXNlcl9pZCI6IjNLWVZtUDhiSkxSVmNKRHdVWHUydzRhblJkdTEiLCJzdWIiOiIzS1lWbVA4YkpMUlZjSkR3VVh1Mnc0YW5SZHUxIiwiaWF0IjoxNzQ4MzcxMDczLCJleHAiOjE3NDgzNzQ2NzMsImVtYWlsIjoiZGVtb0BnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsImZpcmViYXNlIjp7ImlkZW50aXRpZXMiOnsiZW1haWwiOlsiZGVtb0BnbWFpbC5jb20iXX0sInNpZ25faW5fcHJvdmlkZXIiOiJwYXNzd29yZCJ9fQ.eOBnl9BwQ8m_h5Drw_TRYN5_KaXocgctkg8eGSdAOc0y_RicI-JfvVnO1zpT2kvMAVvFT36OTfHpgq9mWIceoqZ4DC-Mj5Utkr0Q5I2hhGtbLH9IRpyQEWnMHgDk1f1jp76DhXRzEuFX-NhKwcBUtCNu_qh9V7qoeWA1u0HDdz99PCfTTyxQri9pUWyJEcrnD_ytIlpLJM6v2lcffqssVC2BTHCCtHzG5MAHYle7I1EeUF0GWc7snSBHaYZ-nSYnXeLZNGkWSTamaSMv7GmwmgEKOgDlHoJDaDyanb6DIla2g3J11NKanElUpuZlGcpnnfMS9fza-nHM2p-JCyBHEA",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::1"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: favicon.ico
    - Host: localhost:3000
    - Is subdomain detected: false
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: favicon.ico
    - Current page: home
    - Is subdomain: false
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: favicon.ico
    - Is subdomain: false
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for favicon.ico
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: favicon.ico
        - Current page: home
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: Favicon.ico
        - Username: favicon.ico
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: favicon.ico
        - Is subdomain: false
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: favicon.ico
    - Is subdomain: false
    - HTML length: 3972
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Favicon.ico</title...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /favicon.ico/
    /favicon.ico/posts
    /favicon.ico/about
    /favicon.ico/post/welcome
    /favicon.ico/post/getting-started
    /favicon.ico/posts
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/favicon.ico/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/welcome"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/getting-started"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/favicon.ico/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /favicon.ico/themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4129 bytes
 GET /favicon.ico 200 in 42ms
[Firebase Admin] Starting initialization...
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/posts
    - Hostname: demouser.localhost:3000
    - Pathname: /posts
    - Headers: {
  "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cache-control": "max-age=0",
  "connection": "keep-alive",
  "cookie": "__next_hmr_refresh_hash__=203",
  "host": "demouser.localhost:3000",
  "referer": "http://demouser.localhost:3000/",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "sec-ch-ua-platform": "\"macOS\"",
  "sec-fetch-dest": "document",
  "sec-fetch-mode": "navigate",
  "sec-fetch-site": "same-origin",
  "sec-fetch-user": "?1",
  "upgrade-insecure-requests": "1",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "demouser",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/posts",
    "normalizedPath": "/posts",
    "pathSegments": [
      "posts"
    ],
    "pageType": "posts"
  },
  "hostInfo": {
    "hostname": "demouser.localhost:3000",
    "domainParts": [
      "demouser",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: demouser.localhost:3000/posts
[Middleware] Is subdomain check: demouser.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Subdomain request detected:
      - Username: demouser
      - Original pathname: /posts
      - Is root path: false
[SUBDOMAIN-DEBUG] Rewriting URL:
      - From: http://localhost:3000/posts
      - To pathname: /demouser/posts
      - Full new URL: http://localhost:3000/demouser/posts
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: demouser
    - Host: demouser.localhost:3000
    - Is subdomain detected: true
    - Original pathname: /posts
[SUBDOMAIN-DEBUG] Path processing:
        - Clean path: posts
        - Path without username: posts
        - Username check: demouser
        - Starts with username?: false
[SUBDOMAIN-DEBUG] Page detection:
          - Path segments: [posts]
          - Selected page: posts
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: demouser
    - Current page: posts
    - Is subdomain: true
[Posts Page] Request details:
    - Username: demouser
    - Host: demouser.localhost:3000
    - Is subdomain (detected): true
    - Path: /posts
    - NODE_ENV: development
  
[Firebase Admin] isAdminAvailable() called:
    - adminInitialized: development
    - adminAuth available: false
    - adminDb available: false
    - real admin available: false
    - NODE_ENV: development
    - Project ID: mini-app-00
  
Error: Route "/[username]/posts" used `headers().get('host')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at isAdminAvailable (src/lib/firebase/admin.ts:139:25)
    at UserPostsPage (src/app/[username]/posts/page.tsx:32:40)
  137 |       const { headers } = require('next/headers');
  138 |       const headersList = headers();
> 139 |       host = headersList.get('host') || '';
      |                         ^
  140 |     } else {
  141 |       host = window.location.host;
  142 |     }
[Firebase Admin] Detected subdomain request on host: demouser.localhost:3000
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[Firebase Admin] Admin not available but in development mode - allowing demo content
[Posts Page] Admin availability check result: true
[Posts Page] Firebase Admin DB not available but in development mode.
        - Username: demouser
        - Host: demouser.localhost:3000
        - Is subdomain: true
        - NODE_ENV: development
      
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: posts
[THEME-DEBUG] Navigation context:
        - Username: demouser
        - Current page: posts
        - Is subdomain: true
      
[THEME-DEBUG] Site context:
        - Title: demouser's Blog
        - Username: demouser
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/dev-mode
  7. /post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-render)
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: posts
        - Username: demouser
        - Is subdomain: true
        - Current page: posts
        - Template context keys: site, posts, navigationContext, content, navigation, userCSS, currentYear
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: demouser
    - Is subdomain: true
    - HTML length: 3432
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>demouser&#39;s Blo...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /
    /posts
    /about
    /post/dev-mode
    /post/firebase-admin-nextjs
[SUBDOMAIN-DEBUG] Subdomain mode - transforming username-prefixed links to relative links
    - Username pattern: /href="\/demouser(\/[^"]*|\/?)?"/g
[SUBDOMAIN-DEBUG] Links after subdomain transformation:
      []
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/dev-mode
  7. /post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3574 bytes
 GET /posts 200 in 84ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/themes/altay/theme.css
    - Hostname: demouser.localhost:3000
    - Pathname: /themes/altay/theme.css
    - Headers: {
  "accept": "text/css,*/*;q=0.1",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "connection": "keep-alive",
  "cookie": "__next_hmr_refresh_hash__=203",
  "host": "demouser.localhost:3000",
  "if-modified-since": "Fri, 23 May 2025 14:19:28 GMT",
  "if-none-match": "W/\"2551-196fd8364d2\"",
  "referer": "http://demouser.localhost:3000/posts",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "sec-ch-ua-platform": "\"macOS\"",
  "sec-fetch-dest": "style",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-site": "same-origin",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "demouser",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/themes/altay/theme.css",
    "normalizedPath": "/themes/altay/theme.css",
    "pathSegments": [
      "themes",
      "altay",
      "theme.css"
    ],
    "pageType": "themes"
  },
  "hostInfo": {
    "hostname": "demouser.localhost:3000",
    "domainParts": [
      "demouser",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: favicon.ico
    - Host header: demouser.localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: not set
    - X-Minispace-Original-Host: not set
    - X-Minispace-Username: not set
    - All headers: {
  "host": "demouser.localhost:3000",
  "connection": "keep-alive",
  "sec-ch-ua-platform": "\"macOS\"",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "accept": "image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8",
  "sec-fetch-site": "same-origin",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-dest": "image",
  "referer": "http://demouser.localhost:3000/posts",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cookie": "__next_hmr_refresh_hash__=203",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::1"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: favicon.ico
    - Host: demouser.localhost:3000
    - Is subdomain detected: false
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: favicon.ico
    - Current page: home
    - Is subdomain: false
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: favicon.ico
    - Is subdomain: false
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for favicon.ico
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: favicon.ico
        - Current page: home
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: Favicon.ico
        - Username: favicon.ico
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: favicon.ico
        - Is subdomain: false
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: favicon.ico
    - Is subdomain: false
    - HTML length: 3972
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Favicon.ico</title...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /favicon.ico/
    /favicon.ico/posts
    /favicon.ico/about
    /favicon.ico/post/welcome
    /favicon.ico/post/getting-started
    /favicon.ico/posts
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/favicon.ico/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/welcome"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/getting-started"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/favicon.ico/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /favicon.ico/themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4129 bytes
 GET /favicon.ico 200 in 137ms
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: favicon.ico
    - Host header: demouser.localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: not set
    - X-Minispace-Original-Host: not set
    - X-Minispace-Username: not set
    - All headers: {
  "host": "demouser.localhost:3000",
  "connection": "keep-alive",
  "sec-ch-ua-platform": "\"macOS\"",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "accept": "image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8",
  "sec-fetch-site": "same-origin",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-dest": "image",
  "referer": "http://demouser.localhost:3000/posts",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cookie": "__next_hmr_refresh_hash__=203",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::1"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: favicon.ico
    - Host: demouser.localhost:3000
    - Is subdomain detected: false
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: favicon.ico
    - Current page: home
    - Is subdomain: false
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: favicon.ico
    - Is subdomain: false
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for favicon.ico
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: favicon.ico
        - Current page: home
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: Favicon.ico
        - Username: favicon.ico
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: favicon.ico
        - Is subdomain: false
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: favicon.ico
    - Is subdomain: false
    - HTML length: 3972
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Favicon.ico</title...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /favicon.ico/
    /favicon.ico/posts
    /favicon.ico/about
    /favicon.ico/post/welcome
    /favicon.ico/post/getting-started
    /favicon.ico/posts
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/favicon.ico/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/welcome"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/getting-started"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/favicon.ico/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /favicon.ico/themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4129 bytes
 GET /favicon.ico 200 in 69ms
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: favicon.ico
    - Host header: demouser.localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: not set
    - X-Minispace-Original-Host: not set
    - X-Minispace-Username: not set
    - All headers: {
  "host": "demouser.localhost:3000",
  "connection": "keep-alive",
  "sec-ch-ua-platform": "\"macOS\"",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "accept": "image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8",
  "sec-fetch-site": "same-origin",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-dest": "image",
  "referer": "http://demouser.localhost:3000/posts",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cookie": "__next_hmr_refresh_hash__=203",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::1"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: favicon.ico
    - Host: demouser.localhost:3000
    - Is subdomain detected: false
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: favicon.ico
    - Current page: home
    - Is subdomain: false
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: favicon.ico
    - Is subdomain: false
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for favicon.ico
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: favicon.ico
        - Current page: home
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: Favicon.ico
        - Username: favicon.ico
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: favicon.ico
        - Is subdomain: false
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: favicon.ico
    - Is subdomain: false
    - HTML length: 3972
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Favicon.ico</title...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /favicon.ico/
    /favicon.ico/posts
    /favicon.ico/about
    /favicon.ico/post/welcome
    /favicon.ico/post/getting-started
    /favicon.ico/posts
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/favicon.ico/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/welcome"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/getting-started"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/favicon.ico/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /favicon.ico/themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4129 bytes
 GET /favicon.ico 200 in 62ms
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: favicon.ico
    - Host header: demouser.localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: not set
    - X-Minispace-Original-Host: not set
    - X-Minispace-Username: not set
    - All headers: {
  "host": "demouser.localhost:3000",
  "connection": "keep-alive",
  "sec-ch-ua-platform": "\"macOS\"",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "accept": "image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8",
  "sec-fetch-site": "same-origin",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-dest": "image",
  "referer": "http://demouser.localhost:3000/posts",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cookie": "__next_hmr_refresh_hash__=203",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::1"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: favicon.ico
    - Host: demouser.localhost:3000
    - Is subdomain detected: false
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: favicon.ico
    - Current page: home
    - Is subdomain: false
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: favicon.ico
    - Is subdomain: false
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for favicon.ico
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: favicon.ico
        - Current page: home
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: Favicon.ico
        - Username: favicon.ico
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: favicon.ico
        - Is subdomain: false
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: favicon.ico
    - Is subdomain: false
    - HTML length: 3972
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Favicon.ico</title...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /favicon.ico/
    /favicon.ico/posts
    /favicon.ico/about
    /favicon.ico/post/welcome
    /favicon.ico/post/getting-started
    /favicon.ico/posts
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/favicon.ico/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/welcome"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/getting-started"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/favicon.ico/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /favicon.ico/themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4129 bytes
 GET /favicon.ico 200 in 61ms
[Firebase Admin] Starting initialization...
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
[Firebase Admin] Starting initialization...
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/about
    - Hostname: demouser.localhost:3000
    - Pathname: /about
    - Headers: {
  "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "connection": "keep-alive",
  "cookie": "__next_hmr_refresh_hash__=203",
  "host": "demouser.localhost:3000",
  "referer": "http://demouser.localhost:3000/posts",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "sec-ch-ua-platform": "\"macOS\"",
  "sec-fetch-dest": "document",
  "sec-fetch-mode": "navigate",
  "sec-fetch-site": "same-origin",
  "sec-fetch-user": "?1",
  "upgrade-insecure-requests": "1",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "demouser",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/about",
    "normalizedPath": "/about",
    "pathSegments": [
      "about"
    ],
    "pageType": "about"
  },
  "hostInfo": {
    "hostname": "demouser.localhost:3000",
    "domainParts": [
      "demouser",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: demouser.localhost:3000/about
[Middleware] Is subdomain check: demouser.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Subdomain request detected:
      - Username: demouser
      - Original pathname: /about
      - Is root path: false
[SUBDOMAIN-DEBUG] Rewriting URL:
      - From: http://localhost:3000/about
      - To pathname: /demouser/about
      - Full new URL: http://localhost:3000/demouser/about
 GET /about 404 in 74ms
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: favicon.ico
    - Host header: demouser.localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: not set
    - X-Minispace-Original-Host: not set
    - X-Minispace-Username: not set
    - All headers: {
  "host": "demouser.localhost:3000",
  "connection": "keep-alive",
  "sec-ch-ua-platform": "\"macOS\"",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "accept": "image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8",
  "sec-fetch-site": "same-origin",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-dest": "image",
  "referer": "http://demouser.localhost:3000/about",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cookie": "__next_hmr_refresh_hash__=203",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::1"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: favicon.ico
    - Host: demouser.localhost:3000
    - Is subdomain detected: false
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: favicon.ico
    - Current page: home
    - Is subdomain: false
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: favicon.ico
    - Is subdomain: false
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for favicon.ico
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: favicon.ico
        - Current page: home
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: Favicon.ico
        - Username: favicon.ico
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: favicon.ico
        - Is subdomain: false
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: favicon.ico
    - Is subdomain: false
    - HTML length: 3972
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Favicon.ico</title...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /favicon.ico/
    /favicon.ico/posts
    /favicon.ico/about
    /favicon.ico/post/welcome
    /favicon.ico/post/getting-started
    /favicon.ico/posts
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/favicon.ico/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/welcome"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/getting-started"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/favicon.ico/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /favicon.ico/themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4129 bytes
 GET /favicon.ico 200 in 97ms
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: favicon.ico
    - Host header: demouser.localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: not set
    - X-Minispace-Original-Host: not set
    - X-Minispace-Username: not set
    - All headers: {
  "host": "demouser.localhost:3000",
  "connection": "keep-alive",
  "sec-ch-ua-platform": "\"macOS\"",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "accept": "image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8",
  "sec-fetch-site": "same-origin",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-dest": "image",
  "referer": "http://demouser.localhost:3000/about",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cookie": "__next_hmr_refresh_hash__=203",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::1"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: favicon.ico
    - Host: demouser.localhost:3000
    - Is subdomain detected: false
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: favicon.ico
    - Current page: home
    - Is subdomain: false
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: favicon.ico
    - Is subdomain: false
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for favicon.ico
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: favicon.ico
        - Current page: home
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: Favicon.ico
        - Username: favicon.ico
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: favicon.ico
        - Is subdomain: false
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: favicon.ico
    - Is subdomain: false
    - HTML length: 3972
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Favicon.ico</title...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /favicon.ico/
    /favicon.ico/posts
    /favicon.ico/about
    /favicon.ico/post/welcome
    /favicon.ico/post/getting-started
    /favicon.ico/posts
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/favicon.ico/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/welcome"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/getting-started"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/favicon.ico/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /favicon.ico/themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4129 bytes
 GET /favicon.ico 200 in 62ms
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: favicon.ico
    - Host header: demouser.localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: not set
    - X-Minispace-Original-Host: not set
    - X-Minispace-Username: not set
    - All headers: {
  "host": "demouser.localhost:3000",
  "connection": "keep-alive",
  "sec-ch-ua-platform": "\"macOS\"",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "accept": "image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8",
  "sec-fetch-site": "same-origin",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-dest": "image",
  "referer": "http://demouser.localhost:3000/about",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cookie": "__next_hmr_refresh_hash__=203",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::1"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: favicon.ico
    - Host: demouser.localhost:3000
    - Is subdomain detected: false
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: favicon.ico
    - Current page: home
    - Is subdomain: false
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: favicon.ico
    - Is subdomain: false
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for favicon.ico
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: favicon.ico
        - Current page: home
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: Favicon.ico
        - Username: favicon.ico
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: favicon.ico
        - Is subdomain: false
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: favicon.ico
    - Is subdomain: false
    - HTML length: 3972
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Favicon.ico</title...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /favicon.ico/
    /favicon.ico/posts
    /favicon.ico/about
    /favicon.ico/post/welcome
    /favicon.ico/post/getting-started
    /favicon.ico/posts
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/favicon.ico/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/welcome"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/getting-started"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/favicon.ico/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /favicon.ico/themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4129 bytes
 GET /favicon.ico 200 in 49ms
[Firebase Admin] Starting initialization...
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/posts
    - Hostname: demouser.localhost:3000
    - Pathname: /posts
    - Headers: {
  "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "connection": "keep-alive",
  "cookie": "__next_hmr_refresh_hash__=203",
  "host": "demouser.localhost:3000",
  "referer": "http://demouser.localhost:3000/",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "sec-ch-ua-platform": "\"macOS\"",
  "sec-fetch-dest": "document",
  "sec-fetch-mode": "navigate",
  "sec-fetch-site": "same-origin",
  "sec-fetch-user": "?1",
  "upgrade-insecure-requests": "1",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "demouser",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/posts",
    "normalizedPath": "/posts",
    "pathSegments": [
      "posts"
    ],
    "pageType": "posts"
  },
  "hostInfo": {
    "hostname": "demouser.localhost:3000",
    "domainParts": [
      "demouser",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: demouser.localhost:3000/posts
[Middleware] Is subdomain check: demouser.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Subdomain request detected:
      - Username: demouser
      - Original pathname: /posts
      - Is root path: false
[SUBDOMAIN-DEBUG] Rewriting URL:
      - From: http://localhost:3000/posts
      - To pathname: /demouser/posts
      - Full new URL: http://localhost:3000/demouser/posts
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: demouser
    - Host: demouser.localhost:3000
    - Is subdomain detected: true
    - Original pathname: /posts
[SUBDOMAIN-DEBUG] Path processing:
        - Clean path: posts
        - Path without username: posts
        - Username check: demouser
        - Starts with username?: false
[SUBDOMAIN-DEBUG] Page detection:
          - Path segments: [posts]
          - Selected page: posts
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: demouser
    - Current page: posts
    - Is subdomain: true
[Posts Page] Request details:
    - Username: demouser
    - Host: demouser.localhost:3000
    - Is subdomain (detected): true
    - Path: /posts
    - NODE_ENV: development
  
[Firebase Admin] isAdminAvailable() called:
    - adminInitialized: development
    - adminAuth available: false
    - adminDb available: false
    - real admin available: false
    - NODE_ENV: development
    - Project ID: mini-app-00
  
Error: Route "/[username]/posts" used `headers().get('host')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at isAdminAvailable (src/lib/firebase/admin.ts:139:25)
    at UserPostsPage (src/app/[username]/posts/page.tsx:32:40)
  137 |       const { headers } = require('next/headers');
  138 |       const headersList = headers();
> 139 |       host = headersList.get('host') || '';
      |                         ^
  140 |     } else {
  141 |       host = window.location.host;
  142 |     }
[Firebase Admin] Detected subdomain request on host: demouser.localhost:3000
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[Firebase Admin] Admin not available but in development mode - allowing demo content
[Posts Page] Admin availability check result: true
[Posts Page] Firebase Admin DB not available but in development mode.
        - Username: demouser
        - Host: demouser.localhost:3000
        - Is subdomain: true
        - NODE_ENV: development
      
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: posts
[THEME-DEBUG] Navigation context:
        - Username: demouser
        - Current page: posts
        - Is subdomain: true
      
[THEME-DEBUG] Site context:
        - Title: demouser's Blog
        - Username: demouser
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/dev-mode
  7. /post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-render)
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: posts
        - Username: demouser
        - Is subdomain: true
        - Current page: posts
        - Template context keys: site, posts, navigationContext, content, navigation, userCSS, currentYear
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: demouser
    - Is subdomain: true
    - HTML length: 3432
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>demouser&#39;s Blo...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /
    /posts
    /about
    /post/dev-mode
    /post/firebase-admin-nextjs
[SUBDOMAIN-DEBUG] Subdomain mode - transforming username-prefixed links to relative links
    - Username pattern: /href="\/demouser(\/[^"]*|\/?)?"/g
[SUBDOMAIN-DEBUG] Links after subdomain transformation:
      []
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/dev-mode
  7. /post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3574 bytes
 GET /posts 200 in 129ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/themes/altay/theme.css
    - Hostname: demouser.localhost:3000
    - Pathname: /themes/altay/theme.css
    - Headers: {
  "accept": "text/css,*/*;q=0.1",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "connection": "keep-alive",
  "cookie": "__next_hmr_refresh_hash__=203",
  "host": "demouser.localhost:3000",
  "if-modified-since": "Fri, 23 May 2025 14:19:28 GMT",
  "if-none-match": "W/\"2551-196fd8364d2\"",
  "referer": "http://demouser.localhost:3000/posts",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "sec-ch-ua-platform": "\"macOS\"",
  "sec-fetch-dest": "style",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-site": "same-origin",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "demouser",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/themes/altay/theme.css",
    "normalizedPath": "/themes/altay/theme.css",
    "pathSegments": [
      "themes",
      "altay",
      "theme.css"
    ],
    "pageType": "themes"
  },
  "hostInfo": {
    "hostname": "demouser.localhost:3000",
    "domainParts": [
      "demouser",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: favicon.ico
    - Host header: demouser.localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: not set
    - X-Minispace-Original-Host: not set
    - X-Minispace-Username: not set
    - All headers: {
  "host": "demouser.localhost:3000",
  "connection": "keep-alive",
  "sec-ch-ua-platform": "\"macOS\"",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "accept": "image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8",
  "sec-fetch-site": "same-origin",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-dest": "image",
  "referer": "http://demouser.localhost:3000/posts",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cookie": "__next_hmr_refresh_hash__=203",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::1"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: favicon.ico
    - Host: demouser.localhost:3000
    - Is subdomain detected: false
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: favicon.ico
    - Current page: home
    - Is subdomain: false
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: favicon.ico
    - Is subdomain: false
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for favicon.ico
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: favicon.ico
        - Current page: home
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: Favicon.ico
        - Username: favicon.ico
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: favicon.ico
        - Is subdomain: false
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: favicon.ico
    - Is subdomain: false
    - HTML length: 3972
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Favicon.ico</title...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /favicon.ico/
    /favicon.ico/posts
    /favicon.ico/about
    /favicon.ico/post/welcome
    /favicon.ico/post/getting-started
    /favicon.ico/posts
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/favicon.ico/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/welcome"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/getting-started"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/favicon.ico/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /favicon.ico/themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4129 bytes
 GET /favicon.ico 200 in 139ms
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: favicon.ico
    - Host header: demouser.localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: not set
    - X-Minispace-Original-Host: not set
    - X-Minispace-Username: not set
    - All headers: {
  "host": "demouser.localhost:3000",
  "connection": "keep-alive",
  "sec-ch-ua-platform": "\"macOS\"",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "accept": "image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8",
  "sec-fetch-site": "same-origin",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-dest": "image",
  "referer": "http://demouser.localhost:3000/posts",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cookie": "__next_hmr_refresh_hash__=203",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::1"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: favicon.ico
    - Host: demouser.localhost:3000
    - Is subdomain detected: false
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: favicon.ico
    - Current page: home
    - Is subdomain: false
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: favicon.ico
    - Is subdomain: false
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for favicon.ico
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: favicon.ico
        - Current page: home
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: Favicon.ico
        - Username: favicon.ico
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: favicon.ico
        - Is subdomain: false
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: favicon.ico
    - Is subdomain: false
    - HTML length: 3972
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Favicon.ico</title...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /favicon.ico/
    /favicon.ico/posts
    /favicon.ico/about
    /favicon.ico/post/welcome
    /favicon.ico/post/getting-started
    /favicon.ico/posts
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/favicon.ico/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/welcome"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/getting-started"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/favicon.ico/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /favicon.ico/themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4129 bytes
 GET /favicon.ico 200 in 121ms
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: favicon.ico
    - Host header: demouser.localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: not set
    - X-Minispace-Original-Host: not set
    - X-Minispace-Username: not set
    - All headers: {
  "host": "demouser.localhost:3000",
  "connection": "keep-alive",
  "sec-ch-ua-platform": "\"macOS\"",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "accept": "image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8",
  "sec-fetch-site": "same-origin",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-dest": "image",
  "referer": "http://demouser.localhost:3000/posts",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cookie": "__next_hmr_refresh_hash__=203",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::1"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: favicon.ico
    - Host: demouser.localhost:3000
    - Is subdomain detected: false
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: favicon.ico
    - Current page: home
    - Is subdomain: false
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: favicon.ico
    - Is subdomain: false
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for favicon.ico
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: favicon.ico
        - Current page: home
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: Favicon.ico
        - Username: favicon.ico
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: favicon.ico
        - Is subdomain: false
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: favicon.ico
    - Is subdomain: false
    - HTML length: 3972
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Favicon.ico</title...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /favicon.ico/
    /favicon.ico/posts
    /favicon.ico/about
    /favicon.ico/post/welcome
    /favicon.ico/post/getting-started
    /favicon.ico/posts
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/favicon.ico/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/welcome"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/getting-started"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/favicon.ico/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /favicon.ico/themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4129 bytes
 GET /favicon.ico 200 in 78ms
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: favicon.ico
    - Host header: demouser.localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: not set
    - X-Minispace-Original-Host: not set
    - X-Minispace-Username: not set
    - All headers: {
  "host": "demouser.localhost:3000",
  "connection": "keep-alive",
  "sec-ch-ua-platform": "\"macOS\"",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "accept": "image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8",
  "sec-fetch-site": "same-origin",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-dest": "image",
  "referer": "http://demouser.localhost:3000/posts",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cookie": "__next_hmr_refresh_hash__=203",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::1"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: favicon.ico
    - Host: demouser.localhost:3000
    - Is subdomain detected: false
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: favicon.ico
    - Current page: home
    - Is subdomain: false
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: favicon.ico
    - Is subdomain: false
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for favicon.ico
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: favicon.ico
        - Current page: home
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: Favicon.ico
        - Username: favicon.ico
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: favicon.ico
        - Is subdomain: false
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: favicon.ico
    - Is subdomain: false
    - HTML length: 3972
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Favicon.ico</title...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /favicon.ico/
    /favicon.ico/posts
    /favicon.ico/about
    /favicon.ico/post/welcome
    /favicon.ico/post/getting-started
    /favicon.ico/posts
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/favicon.ico/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/welcome"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/getting-started"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/favicon.ico/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /favicon.ico/themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4129 bytes
 GET /favicon.ico 200 in 71ms
[Firebase Admin] Starting initialization...
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
[Firebase Admin] Starting initialization...
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/
    - Hostname: demouser.localhost:3000
    - Pathname: /
    - Headers: {
  "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "connection": "keep-alive",
  "cookie": "__next_hmr_refresh_hash__=203",
  "host": "demouser.localhost:3000",
  "referer": "http://demouser.localhost:3000/posts",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "sec-ch-ua-platform": "\"macOS\"",
  "sec-fetch-dest": "document",
  "sec-fetch-mode": "navigate",
  "sec-fetch-site": "same-origin",
  "sec-fetch-user": "?1",
  "upgrade-insecure-requests": "1",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "demouser",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/",
    "normalizedPath": "/",
    "pathSegments": [],
    "pageType": "home"
  },
  "hostInfo": {
    "hostname": "demouser.localhost:3000",
    "domainParts": [
      "demouser",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: demouser.localhost:3000/
[Middleware] Is subdomain check: demouser.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Subdomain request detected:
      - Username: demouser
      - Original pathname: /
      - Is root path: true
[SUBDOMAIN-DEBUG] Rewriting URL:
      - From: http://localhost:3000/
      - To pathname: /demouser
      - Full new URL: http://localhost:3000/demouser
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: demouser
    - Host header: demouser.localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: true
    - X-Minispace-Original-Host: demouser.localhost:3000
    - X-Minispace-Username: demouser
    - All headers: {
  "host": "demouser.localhost:3000",
  "connection": "keep-alive",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "sec-ch-ua-platform": "\"macOS\"",
  "upgrade-insecure-requests": "1",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7",
  "sec-fetch-site": "same-origin",
  "sec-fetch-mode": "navigate",
  "sec-fetch-user": "?1",
  "sec-fetch-dest": "document",
  "referer": "http://demouser.localhost:3000/posts",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cookie": "__next_hmr_refresh_hash__=203",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::1",
  "x-minispace-original-host": "demouser.localhost:3000",
  "x-minispace-path-analysis": "{\"originalPath\":\"/\",\"normalizedPath\":\"/\",\"pageType\":\"home\"}",
  "x-minispace-rewritten-from-subdomain": "true",
  "x-minispace-username": "demouser"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: demouser
    - Host: demouser.localhost:3000
    - Is subdomain detected: true
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: demouser
    - Current page: home
    - Is subdomain: true
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: demouser
    - Is subdomain: true
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for demouser
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: demouser
        - Current page: home
        - Is subdomain: true
      
[THEME-DEBUG] Site context:
        - Title: Demouser
        - Username: demouser
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/welcome
  7. /post/getting-started
  8. /posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-render)
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: demouser
        - Is subdomain: true
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: demouser
    - Is subdomain: true
    - HTML length: 3882
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Demouser</title>
 ...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /
    /posts
    /about
    /post/welcome
    /post/getting-started
    /posts
[SUBDOMAIN-DEBUG] Subdomain mode - transforming username-prefixed links to relative links
    - Username pattern: /href="\/demouser(\/[^"]*|\/?)?"/g
[SUBDOMAIN-DEBUG] Links after subdomain transformation:
      []
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/welcome
  7. /post/getting-started
  8. /posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4023 bytes
 GET / 200 in 78ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/themes/altay/theme.css
    - Hostname: demouser.localhost:3000
    - Pathname: /themes/altay/theme.css
    - Headers: {
  "accept": "text/css,*/*;q=0.1",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "connection": "keep-alive",
  "cookie": "__next_hmr_refresh_hash__=203",
  "host": "demouser.localhost:3000",
  "if-modified-since": "Fri, 23 May 2025 14:19:28 GMT",
  "if-none-match": "W/\"2551-196fd8364d2\"",
  "referer": "http://demouser.localhost:3000/",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "sec-ch-ua-platform": "\"macOS\"",
  "sec-fetch-dest": "style",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-site": "same-origin",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "demouser",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/themes/altay/theme.css",
    "normalizedPath": "/themes/altay/theme.css",
    "pathSegments": [
      "themes",
      "altay",
      "theme.css"
    ],
    "pageType": "themes"
  },
  "hostInfo": {
    "hostname": "demouser.localhost:3000",
    "domainParts": [
      "demouser",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: favicon.ico
    - Host header: demouser.localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: not set
    - X-Minispace-Original-Host: not set
    - X-Minispace-Username: not set
    - All headers: {
  "host": "demouser.localhost:3000",
  "connection": "keep-alive",
  "sec-ch-ua-platform": "\"macOS\"",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "accept": "image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8",
  "sec-fetch-site": "same-origin",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-dest": "image",
  "referer": "http://demouser.localhost:3000/",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cookie": "__next_hmr_refresh_hash__=203",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::1"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: favicon.ico
    - Host: demouser.localhost:3000
    - Is subdomain detected: false
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: favicon.ico
    - Current page: home
    - Is subdomain: false
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: favicon.ico
    - Is subdomain: false
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for favicon.ico
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: favicon.ico
        - Current page: home
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: Favicon.ico
        - Username: favicon.ico
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: favicon.ico
        - Is subdomain: false
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: favicon.ico
    - Is subdomain: false
    - HTML length: 3972
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Favicon.ico</title...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /favicon.ico/
    /favicon.ico/posts
    /favicon.ico/about
    /favicon.ico/post/welcome
    /favicon.ico/post/getting-started
    /favicon.ico/posts
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/favicon.ico/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/welcome"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/getting-started"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/favicon.ico/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /favicon.ico/themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4129 bytes
 GET /favicon.ico 200 in 83ms
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: favicon.ico
    - Host header: demouser.localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: not set
    - X-Minispace-Original-Host: not set
    - X-Minispace-Username: not set
    - All headers: {
  "host": "demouser.localhost:3000",
  "connection": "keep-alive",
  "sec-ch-ua-platform": "\"macOS\"",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "accept": "image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8",
  "sec-fetch-site": "same-origin",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-dest": "image",
  "referer": "http://demouser.localhost:3000/",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cookie": "__next_hmr_refresh_hash__=203",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::1"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: favicon.ico
    - Host: demouser.localhost:3000
    - Is subdomain detected: false
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: favicon.ico
    - Current page: home
    - Is subdomain: false
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: favicon.ico
    - Is subdomain: false
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for favicon.ico
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: favicon.ico
        - Current page: home
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: Favicon.ico
        - Username: favicon.ico
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: favicon.ico
        - Is subdomain: false
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: favicon.ico
    - Is subdomain: false
    - HTML length: 3972
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Favicon.ico</title...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /favicon.ico/
    /favicon.ico/posts
    /favicon.ico/about
    /favicon.ico/post/welcome
    /favicon.ico/post/getting-started
    /favicon.ico/posts
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/favicon.ico/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/welcome"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/getting-started"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/favicon.ico/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /favicon.ico/themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4129 bytes
 GET /favicon.ico 200 in 107ms
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: favicon.ico
    - Host header: demouser.localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: not set
    - X-Minispace-Original-Host: not set
    - X-Minispace-Username: not set
    - All headers: {
  "host": "demouser.localhost:3000",
  "connection": "keep-alive",
  "sec-ch-ua-platform": "\"macOS\"",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "accept": "image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8",
  "sec-fetch-site": "same-origin",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-dest": "image",
  "referer": "http://demouser.localhost:3000/",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cookie": "__next_hmr_refresh_hash__=203",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::1"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: favicon.ico
    - Host: demouser.localhost:3000
    - Is subdomain detected: false
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: favicon.ico
    - Current page: home
    - Is subdomain: false
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: favicon.ico
    - Is subdomain: false
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for favicon.ico
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: favicon.ico
        - Current page: home
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: Favicon.ico
        - Username: favicon.ico
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: favicon.ico
        - Is subdomain: false
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: favicon.ico
    - Is subdomain: false
    - HTML length: 3972
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Favicon.ico</title...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /favicon.ico/
    /favicon.ico/posts
    /favicon.ico/about
    /favicon.ico/post/welcome
    /favicon.ico/post/getting-started
    /favicon.ico/posts
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/favicon.ico/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/welcome"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/getting-started"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/favicon.ico/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /favicon.ico/themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4129 bytes
 GET /favicon.ico 200 in 89ms
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: favicon.ico
    - Host header: demouser.localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: not set
    - X-Minispace-Original-Host: not set
    - X-Minispace-Username: not set
    - All headers: {
  "host": "demouser.localhost:3000",
  "connection": "keep-alive",
  "sec-ch-ua-platform": "\"macOS\"",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "accept": "image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8",
  "sec-fetch-site": "same-origin",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-dest": "image",
  "referer": "http://demouser.localhost:3000/",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cookie": "__next_hmr_refresh_hash__=203",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::1"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: favicon.ico
    - Host: demouser.localhost:3000
    - Is subdomain detected: false
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: favicon.ico
    - Current page: home
    - Is subdomain: false
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: favicon.ico
    - Is subdomain: false
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for favicon.ico
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: favicon.ico
        - Current page: home
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: Favicon.ico
        - Username: favicon.ico
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: favicon.ico
        - Is subdomain: false
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: favicon.ico
    - Is subdomain: false
    - HTML length: 3972
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Favicon.ico</title...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /favicon.ico/
    /favicon.ico/posts
    /favicon.ico/about
    /favicon.ico/post/welcome
    /favicon.ico/post/getting-started
    /favicon.ico/posts
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/favicon.ico/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/welcome"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/getting-started"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/favicon.ico/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /favicon.ico/themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4129 bytes
 GET /favicon.ico 200 in 99ms
[Firebase Admin] Starting initialization...
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/posts
    - Hostname: demouser.localhost:3000
    - Pathname: /posts
    - Headers: {
  "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "connection": "keep-alive",
  "cookie": "__next_hmr_refresh_hash__=203",
  "host": "demouser.localhost:3000",
  "referer": "http://demouser.localhost:3000/",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "sec-ch-ua-platform": "\"macOS\"",
  "sec-fetch-dest": "document",
  "sec-fetch-mode": "navigate",
  "sec-fetch-site": "same-origin",
  "sec-fetch-user": "?1",
  "upgrade-insecure-requests": "1",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "demouser",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/posts",
    "normalizedPath": "/posts",
    "pathSegments": [
      "posts"
    ],
    "pageType": "posts"
  },
  "hostInfo": {
    "hostname": "demouser.localhost:3000",
    "domainParts": [
      "demouser",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
Middleware processing: demouser.localhost:3000/posts
[Middleware] Is subdomain check: demouser.localhost:3000, result: true
[SUBDOMAIN-DEBUG] Subdomain request detected:
      - Username: demouser
      - Original pathname: /posts
      - Is root path: false
[SUBDOMAIN-DEBUG] Rewriting URL:
      - From: http://localhost:3000/posts
      - To pathname: /demouser/posts
      - Full new URL: http://localhost:3000/demouser/posts
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: demouser
    - Host: demouser.localhost:3000
    - Is subdomain detected: true
    - Original pathname: /posts
[SUBDOMAIN-DEBUG] Path processing:
        - Clean path: posts
        - Path without username: posts
        - Username check: demouser
        - Starts with username?: false
[SUBDOMAIN-DEBUG] Page detection:
          - Path segments: [posts]
          - Selected page: posts
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: demouser
    - Current page: posts
    - Is subdomain: true
[Posts Page] Request details:
    - Username: demouser
    - Host: demouser.localhost:3000
    - Is subdomain (detected): true
    - Path: /posts
    - NODE_ENV: development
  
[Firebase Admin] isAdminAvailable() called:
    - adminInitialized: development
    - adminAuth available: false
    - adminDb available: false
    - real admin available: false
    - NODE_ENV: development
    - Project ID: mini-app-00
  
Error: Route "/[username]/posts" used `headers().get('host')`. `headers()` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at isAdminAvailable (src/lib/firebase/admin.ts:139:25)
    at UserPostsPage (src/app/[username]/posts/page.tsx:32:40)
  137 |       const { headers } = require('next/headers');
  138 |       const headersList = headers();
> 139 |       host = headersList.get('host') || '';
      |                         ^
  140 |     } else {
  141 |       host = window.location.host;
  142 |     }
[Firebase Admin] Detected subdomain request on host: demouser.localhost:3000
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[Firebase Admin] Admin not available but in development mode - allowing demo content
[Posts Page] Admin availability check result: true
[Posts Page] Firebase Admin DB not available but in development mode.
        - Username: demouser
        - Host: demouser.localhost:3000
        - Is subdomain: true
        - NODE_ENV: development
      
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: posts
[THEME-DEBUG] Navigation context:
        - Username: demouser
        - Current page: posts
        - Is subdomain: true
      
[THEME-DEBUG] Site context:
        - Title: demouser's Blog
        - Username: demouser
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/dev-mode
  7. /post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-render)
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: posts
        - Username: demouser
        - Is subdomain: true
        - Current page: posts
        - Template context keys: site, posts, navigationContext, content, navigation, userCSS, currentYear
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: demouser
    - Is subdomain: true
    - HTML length: 3432
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>demouser&#39;s Blo...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /
    /posts
    /about
    /post/dev-mode
    /post/firebase-admin-nextjs
[SUBDOMAIN-DEBUG] Subdomain mode - transforming username-prefixed links to relative links
    - Username pattern: /href="\/demouser(\/[^"]*|\/?)?"/g
[SUBDOMAIN-DEBUG] Links after subdomain transformation:
      []
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 7):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /
  4. /posts
  5. /about
  6. /post/dev-mode
  7. /post/firebase-admin-nextjs
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 3574 bytes
 GET /posts 200 in 237ms
[SUBDOMAIN-DEBUG] *** Middleware processing request ***
    - Full URL: http://localhost:3000/themes/altay/theme.css
    - Hostname: demouser.localhost:3000
    - Pathname: /themes/altay/theme.css
    - Headers: {
  "accept": "text/css,*/*;q=0.1",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "connection": "keep-alive",
  "cookie": "__next_hmr_refresh_hash__=203",
  "host": "demouser.localhost:3000",
  "if-modified-since": "Fri, 23 May 2025 14:19:28 GMT",
  "if-none-match": "W/\"2551-196fd8364d2\"",
  "referer": "http://demouser.localhost:3000/posts",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "sec-ch-ua-platform": "\"macOS\"",
  "sec-fetch-dest": "style",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-site": "same-origin",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[SUBDOMAIN-DEBUG] Path analysis: {
  "detectedUsername": "demouser",
  "isSubdomain": true,
  "pathInfo": {
    "originalPath": "/themes/altay/theme.css",
    "normalizedPath": "/themes/altay/theme.css",
    "pathSegments": [
      "themes",
      "altay",
      "theme.css"
    ],
    "pageType": "themes"
  },
  "hostInfo": {
    "hostname": "demouser.localhost:3000",
    "domainParts": [
      "demouser",
      "localhost:3000"
    ],
    "isProd": false
  }
}
[SUBDOMAIN-DEBUG] Environment:
    - isProd: false
    - prodDomain: minispace.dev
    - devDomains: localhost, 127.0.0.1
    - currentDomain: localhost
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: favicon.ico
    - Host header: demouser.localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: not set
    - X-Minispace-Original-Host: not set
    - X-Minispace-Username: not set
    - All headers: {
  "host": "demouser.localhost:3000",
  "connection": "keep-alive",
  "sec-ch-ua-platform": "\"macOS\"",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "accept": "image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8",
  "sec-fetch-site": "same-origin",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-dest": "image",
  "referer": "http://demouser.localhost:3000/posts",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cookie": "__next_hmr_refresh_hash__=203",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::1"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: favicon.ico
    - Host: demouser.localhost:3000
    - Is subdomain detected: false
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: favicon.ico
    - Current page: home
    - Is subdomain: false
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: favicon.ico
    - Is subdomain: false
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for favicon.ico
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: favicon.ico
        - Current page: home
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: Favicon.ico
        - Username: favicon.ico
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: favicon.ico
        - Is subdomain: false
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: favicon.ico
    - Is subdomain: false
    - HTML length: 3972
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Favicon.ico</title...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /favicon.ico/
    /favicon.ico/posts
    /favicon.ico/about
    /favicon.ico/post/welcome
    /favicon.ico/post/getting-started
    /favicon.ico/posts
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/favicon.ico/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/welcome"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/getting-started"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/favicon.ico/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /favicon.ico/themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4129 bytes
 GET /favicon.ico 200 in 162ms
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: favicon.ico
    - Host header: demouser.localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: not set
    - X-Minispace-Original-Host: not set
    - X-Minispace-Username: not set
    - All headers: {
  "host": "demouser.localhost:3000",
  "connection": "keep-alive",
  "sec-ch-ua-platform": "\"macOS\"",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "accept": "image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8",
  "sec-fetch-site": "same-origin",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-dest": "image",
  "referer": "http://demouser.localhost:3000/posts",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cookie": "__next_hmr_refresh_hash__=203",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::1"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: favicon.ico
    - Host: demouser.localhost:3000
    - Is subdomain detected: false
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: favicon.ico
    - Current page: home
    - Is subdomain: false
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: favicon.ico
    - Is subdomain: false
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for favicon.ico
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: favicon.ico
        - Current page: home
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: Favicon.ico
        - Username: favicon.ico
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: favicon.ico
        - Is subdomain: false
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: favicon.ico
    - Is subdomain: false
    - HTML length: 3972
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Favicon.ico</title...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /favicon.ico/
    /favicon.ico/posts
    /favicon.ico/about
    /favicon.ico/post/welcome
    /favicon.ico/post/getting-started
    /favicon.ico/posts
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/favicon.ico/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/welcome"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/getting-started"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/favicon.ico/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /favicon.ico/themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4129 bytes
 GET /favicon.ico 200 in 148ms
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: favicon.ico
    - Host header: demouser.localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: not set
    - X-Minispace-Original-Host: not set
    - X-Minispace-Username: not set
    - All headers: {
  "host": "demouser.localhost:3000",
  "connection": "keep-alive",
  "sec-ch-ua-platform": "\"macOS\"",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "accept": "image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8",
  "sec-fetch-site": "same-origin",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-dest": "image",
  "referer": "http://demouser.localhost:3000/posts",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cookie": "__next_hmr_refresh_hash__=203",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::1"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: favicon.ico
    - Host: demouser.localhost:3000
    - Is subdomain detected: false
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: favicon.ico
    - Current page: home
    - Is subdomain: false
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: favicon.ico
    - Is subdomain: false
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for favicon.ico
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: favicon.ico
        - Current page: home
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: Favicon.ico
        - Username: favicon.ico
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: favicon.ico
        - Is subdomain: false
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: favicon.ico
    - Is subdomain: false
    - HTML length: 3972
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Favicon.ico</title...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /favicon.ico/
    /favicon.ico/posts
    /favicon.ico/about
    /favicon.ico/post/welcome
    /favicon.ico/post/getting-started
    /favicon.ico/posts
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/favicon.ico/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/welcome"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/getting-started"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/favicon.ico/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /favicon.ico/themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4129 bytes
 GET /favicon.ico 200 in 87ms
🚨🚨🚨 USER PROFILE PAGE EXECUTING - THIS SHOULD ALWAYS SHOW 🚨🚨🚨
[SUBDOMAIN-DEBUG] User profile page executing:
    - Username param: favicon.ico
    - Host header: demouser.localhost:3000
    - X-Minispace-Rewritten-From-Subdomain: not set
    - X-Minispace-Original-Host: not set
    - X-Minispace-Username: not set
    - All headers: {
  "host": "demouser.localhost:3000",
  "connection": "keep-alive",
  "sec-ch-ua-platform": "\"macOS\"",
  "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36",
  "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
  "sec-ch-ua-mobile": "?0",
  "accept": "image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8",
  "sec-fetch-site": "same-origin",
  "sec-fetch-mode": "no-cors",
  "sec-fetch-dest": "image",
  "referer": "http://demouser.localhost:3000/posts",
  "accept-encoding": "gzip, deflate, br, zstd",
  "accept-language": "en-US,en;q=0.9",
  "cookie": "__next_hmr_refresh_hash__=203",
  "x-forwarded-host": "demouser.localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http",
  "x-forwarded-for": "::1"
}
[SUBDOMAIN-DEBUG] Creating navigation context:
    - Username: favicon.ico
    - Host: demouser.localhost:3000
    - Is subdomain detected: false
    - Original pathname: /
[SUBDOMAIN-DEBUG] Final navigation context: 
    - Username: favicon.ico
    - Current page: home
    - Is subdomain: false
[SUBDOMAIN-DEBUG] Navigation context created:
    - Username: favicon.ico
    - Is subdomain: false
    - Current page: home
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Admin DB available: false, Development mode: true
[Firebase Admin] isDevelopmentMode() called:
    - adminInitialized: development
    - NODE_ENV: development
    - result: true
  
[User Profile] Development mode - rendering demo profile for favicon.ico
[THEME-DEBUG] Phase: pre-render
[THEME-DEBUG] Rendering theme: altay
[THEME-DEBUG] Page type: home
[THEME-DEBUG] Navigation context:
        - Username: favicon.ico
        - Current page: home
        - Is subdomain: false
      
[THEME-DEBUG] Site context:
        - Title: Favicon.ico
        - Username: favicon.ico
      
[THEME-DEBUG] Phase: post-render
[SUBDOMAIN-DEBUG] Links in HTML (post-render) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ⚠️ Potential issues detected (post-render):
  1. Detected 1 root-relative links without username prefix in path-based mode: /themes/altay/theme.css
[SUBDOMAIN-DEBUG] Theme rendering details:
        - Theme ID: altay
        - Page type: home
        - Username: favicon.ico
        - Is subdomain: false
        - Current page: home
        - Template context keys: site, posts, pages, navigationContext, currentYear, content, navigation, userCSS
[SUBDOMAIN-DEBUG] Updating navigation links:
    - Username: favicon.ico
    - Is subdomain: false
    - HTML length: 3972
    - First 100 chars: <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Favicon.ico</title...
[SUBDOMAIN-DEBUG] Links found in HTML before transformation:
    https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
    /themes/altay/theme.css
    /favicon.ico/
    /favicon.ico/posts
    /favicon.ico/about
    /favicon.ico/post/welcome
    /favicon.ico/post/getting-started
    /favicon.ico/posts
[SUBDOMAIN-DEBUG] Path-based mode - transforming relative links to username-prefixed links
[SUBDOMAIN-DEBUG] Transforming section link "href="/themes/altay/theme.css"" to "href="/favicon.ico/themes/altay/theme.css""
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/about"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/welcome"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/post/getting-started"
[SUBDOMAIN-DEBUG] Skipping already username-prefixed or external link: href="/favicon.ico/posts"
[SUBDOMAIN-DEBUG] Links after path-based transformation:
    [
  {
    "original": "href=\"/themes/altay/theme.css\"",
    "transformed": "href=\"/favicon.ico/themes/altay/theme.css\""
  }
]
[THEME-DEBUG] Phase: post-navigation-update
[SUBDOMAIN-DEBUG] Links in HTML (post-navigation-update) (first 8):
  1. https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap
  2. /favicon.ico/themes/altay/theme.css
  3. /favicon.ico/
  4. /favicon.ico/posts
  5. /favicon.ico/about
  6. /favicon.ico/post/welcome
  7. /favicon.ico/post/getting-started
  8. /favicon.ico/posts
[THEME-DEBUG] ✓ No obvious rendering issues detected (post-navigation-update)
[SUBDOMAIN-DEBUG] Final rendered HTML size: 4129 bytes
 GET /favicon.ico 200 in 85ms
[Firebase Admin] Starting initialization...
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
[Firebase Admin] Starting initialization...
[Firebase Admin] Existing apps: 0
[Firebase Admin] Running in environment: development
[Firebase Admin] Request URL: unknown
[Firebase Admin] Project ID: mini-app-00
[Firebase Admin] 🧪 Running in development environment - enabling development mode
